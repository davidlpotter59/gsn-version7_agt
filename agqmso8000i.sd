%%
/*
Date Written: August 22, 2011

Name: aqqmso8000i.sd

Copyright (c) 2011, SCIPS.com Inc.

Modify
Date                   By                  Comment
--------------------------------------------------------------
08/22/2011           JLB          created common page for agents rating quote letter
===========================
*/

Program
  Name = "agqmso8000i";
  Type = "File";
  Domain = "flat";
  Padcharacter = Space;

 String L_FILE_NAME[14] = "agqmso8000i.cq";
 String L_PLEASED_WORDING[200];
 String L_TRANS_EFF;
 String L_AUDIT;
 String L_SIGNATURE_STRING[55];
 String L_COPY_NAME[20] ;
 String L_COPY_NAME_2[20] ;
 String I_REV_NAME2[50] ;
 String L_TYPE_STR[35];
 String L_PREV_STRING;
 String L_INSURED_CITY_STATE[50];
 String L_agqNAME_ZIP="";
 String L_SFSAGENT;
 String L_agqLOCATION_ZIP;
 String L_SFSMORT_ZIP[10];
 String L_agqSUPP_ZIP[10];
 String L_AGENT_ADDRESS;
 String L_FOB[75];
 String L_AGENT_TEL[13];
 String L_AGENT_ZIP[10];
 String L_MORGAGE_ID[10];
 String L_COMPANY_ID[10];
 String L_MORTGAGE_TYPE_1[1];
 String L_BILL_PLAN[2];
 String L_LOB_CODE[10];
 String L_STATE;
 String L_COMPANY_ZIP[10];
 String L_TERROR_FORM[7];
 String L_LOB_END_CODE[1],
        I_CODE[7];

 array [120] of string l_no_duplicate_printing[7];

 Number L_TRANS_CODE;
 Number L_MM_1;
 Number L_DD_1;
 Number L_YY_1;
 Number L_RENEWAL[9];

 unsigned ascii number l_irpm[8]=0/dec=4 ;
 Unsigned Ascii Number L_DECIPOINT;
 Unsigned Ascii Number I_STATE[2];
 Unsigned Ascii Number L_STATE2[2];
 Unsigned Ascii Number L_CHARACTER_PER_INCH;
 Unsigned Ascii Number L_PAGE_MIDDLE;
 Unsigned Ascii Number L_HALF_MULTIPLIER;
 Unsigned Ascii Number L_CHAR_MULTIPLIER[10]/decimals=4;
 Unsigned Ascii Number L_PAGE_NUMBER = 1;
 Unsigned Ascii Number L_ITEM_COUNTER;
 Unsigned Ascii Number L_LINE_COUNTER/decimals=2;

 Unsigned Ascii Number L_MED_LIMIT;
 Unsigned Ascii Number L_S_LINE_FOR_AGENT = 0; --start line for agent
 Unsigned Ascii Number L_S_LINE_FOR_LOCATION = 0; --start line for location
 Unsigned Ascii Number L_BIGGER_LINE =0;
 Unsigned Ascii Number L_SCREEN_COR= 0;
 Unsigned Ascii Number L_E_LINE_FOR_INSURED = 0;
 Unsigned Ascii Number L_PAGENUMBER;
 Unsigned Ascii Number L_MAX_LINES;
 Unsigned Ascii Number L_LOCATION_COUNTER;
 Unsigned Ascii Number L_SIZE_COUNTER;
 Unsigned Ascii Number L_LIABILITY;
 Unsigned Ascii Number L_LINE_OF_BUSINESS[4];
 unsigned ascii number l_lob[4];
 Unsigned Ascii Number L_INSURED_COUNTER;
 Unsigned Ascii Number L_AGENT_COUNTER;
 Unsigned Ascii Number L_TWO_PLACER;
 Unsigned Ascii Number L_SFSFORM[2];
 Unsigned Ascii Number L_SFSEND_FORM[2];
 Unsigned Ascii Number L_agqMASTER_FORM[1];
 Unsigned Ascii Number L_LOOP;
 Unsigned Ascii Number L_DO_ONCE[1];
 Unsigned Ascii Number L_COUNTY[3],
                       l_state1[2];
 Unsigned ascii number l_app_no[8];
 String L_STATE_STR[2];
 String L_CHARACTER_STRING[1000]           = "";
 String L_FONT[35]                         = "";
 String L_V_POSITION                       = "";
 String L_H_POSITION                       = "";
 String L_NEWPAGE_WORDING[20];
 Unsigned Ascii Number L_START_PRINT[4]    = 0;   --point to start printing.
 Unsigned Ascii Number L_END_PRINT[4]      = 0;
 Unsigned Ascii Number L_LEN_STRING[4]     = 0;
 Unsigned Ascii Number L_CHARACTER_BREAK   = 0;
 Unsigned Ascii Number L_CHARACTER_COUNTER = 0;
 Unsigned Ascii Number L_MAX_CHAR          = 0;

Unsigned Ascii Number l_total_1[8],
                      l_total_2[8],
                      l_total_3[8],
                      l_total_4[8],
                      l_total_5[8],
                      l_total_6[8],
                      l_total_15[8],
                      l_total_18[8],
                      l_other_totals_4[8],
                      l_terrorism_premium[8],
                      l_surcharge[8];

 number FUNCTION add_and_check_print_array(string);

  Wdate L_MESSAGE_EFF_DATE;
  Wdate L_MESSAGE_EXP_DATE;
  Wdate l_eff_date;

 signed ascii number l_irpm_total[9]=0/dec=2 ;
 signed ascii number l_irpm_left[9]=0/dec=2 ;
 signed ascii number l_total[9]=0/dec=2 ;

 String L_PRINTER[4];
 String L_USER_ID[15];
 String L_TEST;
 Unsigned Ascii Number L_PRINTER_NO[4];

 Include "csfonts.inc"
 Include "sfsrevname7.var"
 Include "header.var"

Initialization
Deletefile (L_FILE_NAME);
L_app_no = val(COMMANDLINE[1,8])

Update

Access agqNAME,
   Set agqNAME:app_NO    = l_app_no, generic

access agqamt,
   set agqamt:app_no = l_app_no, generic

L_LINE_OF_BUSINESS = sfsline:RATING_LINE_OF_BUSINESS
l_lob = agqname:line_of_business

Access agqend ,
   Set agqend:app_NO    = l_app_no, Generic

Access agqGENERAL ,
   Set agqGENERAL:app_NO    = l_app_no, Generic

--Access agqLIABILITY,
--   Set agqLIABILITY:app_NO    = l_app_no, Generic

--Access agqinland,
--   Set agqinland:app_NO    = l_app_no, Generic

Access agqMASTER,
   Set agqMASTER:app_NO    = l_app_no, Generic

L_SFSFORM = agqMASTER:FORM
L_COMPANY_ID = agqNAME:COMPANY_ID
L_STATE2 = agqMASTER:STATE
I_STATE    = agqMASTER:STATE
L_COUNTY = agqgeneral:COUNTY

Access agqLOCATION,
   Set agqLOCATION:app_NO    = l_app_no, Generic

Access agqEND,
   Set agqEND:app_NO    = l_app_no, Generic

Access agqPRINT,
   Set agqPRINT:app_NO    = l_app_no,Generic

Access SFSCOMPANY,
   Set SFSCOMPANY:COMPANY_ID = agqNAME:COMPANY_ID, Exact

Access SFSLINE,
   Set SFSLINE:COMPANY_ID       = agqNAME:COMPANY_ID,
       SFSLINE:LINE_OF_BUSINESS = agqNAME:LINE_OF_BUSINESS,
       sfsline:lob_subline      = "00", exact

Access agqSUPP,
   Set agqSUPP:app_NO    = l_app_no,Generic

Access SFSAGENT,
   Set SFSAGENT:COMPANY_ID = agqNAME:COMPANY_ID,
       SFSAGENT:AGENT_NO   =  agqNAME:AGENT_NO, Exact

Access SFSSTATE,
   Set SFSSTATE:COMPANY_ID = agqGENERAL:COMPANY_ID,
       SFSSTATE:STATE      = agqGENERAL:STATE,
       SFSSTATE:COUNTY     = agqGENERAL:COUNTY, Exact

L_LOB_CODE = SFSLINE:LOB_CODE

Access SCIPSCONTROL,
   Set SCIPSCONTROL:COMPANY_ID          = agqNAME:COMPANY_ID,
       SCIPSCONTROL:STATE               = L_STATE2,
       SCIPSCONTROL:LOB_CODE            = L_LOB_CODE, Generic

Access SFSMESSAGE,
   Set SFSMESSAGE:COMPANY_ID       = L_COMPANY_ID,
       SFSMESSAGE:STATE            = L_STATE2,
       SFSMESSAGE:LINE_OF_BUSINESS = agqNAME:LINE_OF_BUSINESS, generic

while SFSMESSAGE:COMPANY_ID       = agqNAME:COMPANY_ID and
      SFSMESSAGE:STATE            = L_STATE2 and
      SFSMESSAGE:LINE_OF_BUSINESS = agqNAME:LINE_OF_BUSINESS and
      SFSMESSAGE:EFF_DATE         <= agqNAME:EFF_DATE
 {
   if agqNAME:eff_date <= sfsmessage:exp_date and
      agqNAME:eff_date >= sfsmessage:eff_date then
     begin
       L_message_eff_date = sfsmessage:eff_date
       L_message_exp_date = sfsmessage:exp_date
     end
   else
     begin
       l_message_eff_date = 0
       l_message_exp_date = 0
     end

   L_message_eff_date = sfsmessage:eff_date
   L_message_exp_date = sfsmessage:exp_date
   Next SFSMESSAGE
 }

Access SFSMESSAGE,
   Set SFSMESSAGE:COMPANY_ID       = L_COMPANY_ID,
       SFSMESSAGE:STATE            = L_STATE2,
       SFSMESSAGE:LINE_OF_BUSINESS = agqNAME:LINE_OF_BUSINESS,
       SFSMESSAGE:EFF_DATE         = L_MESSAGE_EFF_DATE,
       SFSMESSAGE:EXP_DATE         = L_MESSAGE_EXP_DATE, generic

L_AGENT_TEL = SFSAGENT:TELEPHONE[1];

L_SFSAGENT = If (Val(SFSAGENT:ZIPCODE_1_4) = 0) Then
                      SFSAGENT:ZIPCODE_5_9
                    Else
                      SFSAGENT:ZIPCODE_5_9 + "-" + SFSAGENT:ZIPCODE_1_4

L_agqNAME_ZIP = If (Val(agqNAME:STR_ZIPCODE[6,9]) = 0) Then
                        agqNAME:STR_ZIPCODE[1,5]
                        Else
                        agqNAME:STR_ZIPCODE[1,5] + "-" +
                        agqNAME:STR_ZIPCODE[6,9]

L_INSURED_CITY_STATE = Trun(agqNAME:CITY) + ", " + agqNAME:STR_STATE + "  " + L_agqNAME_ZIP

L_AGENT_ZIP =  If (Val(SFSAGENT:STR_ZIPCODE[6,9]) = 0) Then
                  SFSAGENT:STR_ZIPCODE[1,5]
                  Else
                  SFSAGENT:STR_ZIPCODE[1,5] + "-" +
                  SFSAGENT:STR_ZIPCODE[6,9]

L_COMPANY_ZIP =  If (Val(SFSCOMPANY:STR_ZIPCODE[6,9]) = 0) Then
                       SFSCOMPANY:STR_ZIPCODE[1,5]
                     Else
                       SFSCOMPANY:STR_ZIPCODE[1,5] + "-" +
                       SFSCOMPANY:STR_ZIPCODE[6,9]

L_COMPANY_ID = agqNAME:COMPANY_ID

L_AGENT_ADDRESS = SFSAGENT:CITY + ", " + SFSAGENT:STR_STATE

L_MED_LIMIT = agqMASTER:MEDICAL_LIMIT

Switch(agqMASTER:FORM_OF_BUSINESS)
  Case 'C' : L_FOB = "Corporation"
  Case 'I' : L_FOB = "Individual"
  Case 'J' : L_FOB = "Joint Venture"
  Case 'O' : L_FOB = "Organization"
  Case 'P' : L_FOB = "Partnership"
  case 'L' : l_fob = "LLC"
  Case 'T' : L_FOB = agqMASTER:FOB_DESCRIPTION
End

L_TRANS_CODE = agqMASTER:TRANS_CODE

Switch(agqMASTER:LIABILITY_CODE)
                 Case 1 : L_LIABILITY = 300000
                 Case 2 : L_LIABILITY = 500000
                 Case 3 : L_LIABILITY = 1000000
End

L_MAX_LINES = 55
L_SIZE_COUNTER = 0
L_LINE_COUNTER = 1
L_PAGENUMBER = 1
L_LOCATION_COUNTER = 1
L_INSURED_COUNTER = 0
L_AGENT_COUNTER = 0
L_STATE_STR = SFSCOMPANY:STR_STATE

Writefile(L_FILE_NAME,"%s%s",l_reset,"<NL>")
Writefile(L_FILE_NAME,"%s","<033>&l7H")
Writefile(L_FILE_NAME,"%s",L_LEDUP)

If SCIPSCONTROL:PRINT_BORDERS_ON_DEC_PAGE = 1 Then
  {
    Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c10a3045b0P")
    Writefile(L_FILE_NAME,"%s","<033>&a5585h0V<033>*c10a3045b0P")
    Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c5467h20v0P") --
    Writefile(L_FILE_NAME,"%s","<033>&a140h7300V<033>*c5467h20v0P")
  }

Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD))
Writefile(L_FILE_NAME,"%s","<033>&a2400h7250V")
Writefile(L_FILE_NAME,"%s",L_COPY_NAME)
do check_payor_flags  --this will put payor codes on the bottom of the dec
Writefile(L_FILE_NAME,"%s","<033>&a5000h+0V")
Writefile(L_FILE_NAME,"%s","Page ")
Writefile(L_FILE_NAME,"%n",L_PAGE_NUMBER)

Writefile(L_FILE_NAME,"%s","<033>&a0h0V")

L_STRING = trun(sfscompany:name[1])
L_FONT = L_ARIAL_BOLD_14
L_PITCH_HALF = 8
L_PITCH_FULL = 16
L_VERTICAL_POS = "+240"
Include "center2.pro"

if scipscontrol:quotation_lob_wording_change = 1 then
  begin
    L_PLEASED_WORDING = trun(sfsline:description)
    Writefile(L_FILE_NAME,"%s",l_arial_bold_14)
    L_STRING = L_PLEASED_WORDING
    L_FONT = L_ARIAL_BOLD_12
    L_PITCH_HALF = 6
    L_PITCH_FULL = 12
    L_VERTICAL_POS = "+160"
    Include "center2.pro"

    L_PLEASED_WORDING = "We are pleased to submit the following quotation to you."
    Writefile(L_FILE_NAME,"%s",l_arial_bold_14)
    L_STRING = L_PLEASED_WORDING
    L_FONT = L_ARIAL_BOLD_12
    L_PITCH_HALF = 6
    L_PITCH_FULL = 12
    L_VERTICAL_POS = "+160"
    Include "center2.pro"
  end
else
  begin
    L_PLEASED_WORDING = "We are pleased to submit the following " +
                        trun(sfsline:description) + " " + "quotation to you."

    Writefile(L_FILE_NAME,"%s",l_arial_bold_14)
    L_STRING = L_PLEASED_WORDING
    L_FONT = L_ARIAL_BOLD_12
    L_PITCH_HALF = 6
    L_PITCH_FULL = 12
    L_VERTICAL_POS = "+160"
    Include "center2.pro"
  end


Writefile(L_FILE_NAME,"%s%s","<NL>","<033>&f0S") --pushed memory location on stack
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s%s%s%s%s","<033>&f1S",trun(L_ARIAL_12),"<033>&a300h+30V",
                      "app Number","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s%s%s%s",trun(L_ARIAL_BOLD_14),
                      "<033>&a300h+20V",Trun(SFSLINE:ALPHA),
                      trun(str(l_app_no)))

if scipscontrol:payor_code_bottom_of_page not one of 1 then   --put it on the top of dec by app number
  {
    if scipscontrol:payor_code_bottom_of_page not one of 1 then   --put it on the top of dec by app number
      {
        If SCIPSCONTROL:DONT_PRINT_PAYOR_CODE_ALL_COPY = 1 then
          {
            do print_payor_codes
          }
      }
    Else
      If SCIPSCONTROL:PAYOR_CODES = 1 Then
        {
          do print_payor_codes
        }
  }
if scipscontrol:agent_print_copy_name = "" then
    begin
    Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s%n%s","<NL>","<NL>",trun(L_ARIAL_BOLD),
                          "<033>&a200h+0V","",
                          "<033>&a350h+0V","Named Insured and Mailing Address",
                          "<033>&a3000h+0V","Agent -","<033>&a3400h+0V",
                          SFSAGENT:AGENT_NO,"<NL>")
    end
else
    begin
    Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s%n%s","<NL>","<NL>",trun(L_ARIAL_BOLD),
                          "<033>&a200h+0V","",
                          "<033>&a350h+0V","Named Insured and Mailing Address",
                          "<033>&a3000h+0V",trun(scipscontrol:agent_print_copy_name)," - ",SFSAGENT:AGENT_NO,"<NL>")
    end

L_LINE_COUNTER = L_LINE_COUNTER + 3

Writefile(L_FILE_NAME,"%s%s","<033>&f0S",trun(L_ARIAL))

I_NAME=agqNAME:NAME[1,1,40]
Include "sfsrevname7.pro"
If agqNAME:NAME[1] <> "" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a350h+0V",I_REV_NAME,"<NL>")
    L_INSURED_COUNTER = L_INSURED_COUNTER +1
  }

I_NAME=agqNAME:NAME[2,1,40]
Include "sfsrevname7.pro"
If agqNAME:NAME[2] <> "" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a350h+0V",I_REV_NAME,"<NL>")
    L_INSURED_COUNTER = L_INSURED_COUNTER +1
  }

I_NAME=agqNAME:NAME[3,1,40]
Include "sfsrevname7.pro"
If agqNAME:NAME[3] <> "" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a350h+0V",I_REV_NAME,"<NL>")
    L_INSURED_COUNTER = L_INSURED_COUNTER +1
  }

If (agqNAME:ADDRESS[1,1,40] <> "") Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a350h+0V",agqNAME:ADDRESS[1],"<NL>")
    L_INSURED_COUNTER = L_INSURED_COUNTER +1
  }
If (agqNAME:ADDRESS[2,1,40] <> "") Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a350h+0V",agqNAME:ADDRESS[2],"<NL>")
    L_INSURED_COUNTER = L_INSURED_COUNTER +1
  }
If (agqNAME:ADDRESS[3,1,40] <> "") Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a350h+0V",agqNAME:ADDRESS[3],"<NL>")
    L_INSURED_COUNTER = L_INSURED_COUNTER +1
  }
Writefile(L_FILE_NAME,"%s%s%s","<033>&a350h+0V",L_INSURED_CITY_STATE,"<NL>")
L_INSURED_COUNTER = L_INSURED_COUNTER +1

Writefile(L_FILE_NAME,"%s%s","<033>&f1S",trun(L_ARIAL))
Writefile(L_FILE_NAME,"%s","<033>&f0S") --Push

Writefile(L_FILE_NAME,"%s%s%s","<033>&a3000h+0V",
                        SFSAGENT:NAME[1],"<NL>")
L_AGENT_COUNTER = L_AGENT_COUNTER +1

If SFSAGENT:NAME[2] <> "" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a3000h+0V",SFSAGENT:NAME[2],"<NL>")
    L_AGENT_COUNTER = L_AGENT_COUNTER + 1
  }
If SFSAGENT:NAME[3] <> "" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a3000h+0V",SFSAGENT:NAME[3],"<NL>")
    L_AGENT_COUNTER = L_AGENT_COUNTER +1
  }
If SFSAGENT:ADDRESS[1] <> "" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a3000h+0V",SFSAGENT:ADDRESS[1],"<NL>")
    L_AGENT_COUNTER = L_AGENT_COUNTER +1
  }
If SFSAGENT:ADDRESS[2] <> "" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a3000h+0V",SFSAGENT:ADDRESS[2],"<NL>")
    L_AGENT_COUNTER = L_AGENT_COUNTER +1
  }
If SFSAGENT:ADDRESS[3] <> "" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a3000h+0V",SFSAGENT:ADDRESS[3],
                          "<NL>")
    L_AGENT_COUNTER = L_AGENT_COUNTER +1
  }
Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s","<033>&a3000h+0V",Trun(SFSAGENT:CITY),", ",
                      SFSAGENT:STR_STATE," ",L_AGENT_ZIP,"<NL>")
L_AGENT_COUNTER = L_AGENT_COUNTER +1

If SFSAGENT:TELEPHONE[1] <> "" Then
  {
    Writefile(L_FILE_NAME,"%s%s%s%s %s-%s%s","<033>&a3000h+0V",
                      "(",L_AGENT_TEL[1,3],")",L_AGENT_TEL[4,6],
                      L_AGENT_TEL[7,10],"<NL>")
    L_AGENT_COUNTER = L_AGENT_COUNTER +1
  }

If L_INSURED_COUNTER < L_AGENT_COUNTER Then
  {
    L_TWO_PLACER = L_AGENT_COUNTER * 100 + 40
    L_LINE_COUNTER = L_LINE_COUNTER + L_AGENT_COUNTER
  }
Else
  {
    L_TWO_PLACER = L_INSURED_COUNTER * 100 + 40
    L_LINE_COUNTER = L_LINE_COUNTER + L_INSURED_COUNTER
  }

Writefile(L_FILE_NAME,"%s","<033>&f1S") --POP

Writefile(L_FILE_NAME,"%s%n%s","<033>&a140h+",L_TWO_PLACER,"V")
Writefile(L_FILE_NAME,"%s%s","<033>*c5455h20v0P","<NL>") --under name horizontal line to
L_LINE_COUNTER = L_LINE_COUNTER + 0.5

Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD))
Writefile(L_FILE_NAME,"%s","<033>&a200h+0V")
Writefile(L_FILE_NAME,"%s","app Term: ")
Writefile(L_FILE_NAME,"%s",trun(L_ARIAL))
Writefile(L_FILE_NAME,"%s","<033>&a850h+0V")
Writefile(L_FILE_NAME,"%s","From ")
Writefile(L_FILE_NAME,"%s",Str(agqNAME:EFF_DATE,"mm/dd/yyyy"))
Writefile(L_FILE_NAME,"%s"," to ")
Writefile(L_FILE_NAME,"%s",Str(agqNAME:EXP_DATE,"mm/dd/yyyy"))
Writefile(L_FILE_NAME,"%s"," 12:01 A.M. Standard Time at your mailing address shown above.")
Writefile(L_FILE_NAME,"%s","<NL>")
Writefile(L_FILE_NAME,"%s","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1

Switch(agqMASTER:FORM_OF_BUSINESS)
  Case 'C' : L_FOB = "Corporation"
  Case 'I' : L_FOB = "Individual"
  Case 'J' : L_FOB = "Joint Venture"
  Case 'O' : L_FOB = "Organization"
  Case 'P' : L_FOB = "Partnership"
  case 'L' : l_fob = "LLC"
  Case 'T' : L_FOB = agqMASTER:FOB_DESCRIPTION
End

Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD))
Writefile(L_FILE_NAME,"%s","<033>&a200h+0V")
Writefile(L_FILE_NAME,"%s","You are a: ")
Writefile(L_FILE_NAME,"%s",trun(L_ARIAL))
Writefile(L_FILE_NAME,"%s",Uppercase(L_FOB))

Writefile(L_FILE_NAME,"%s","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD))
Writefile(L_FILE_NAME,"%s","<033>&a200h+0V")
Writefile(L_FILE_NAME,"%s","Your Business/Operation: ")
Writefile(L_FILE_NAME,"%s",trun(L_ARIAL))

    If agqGENERAL:BUSINESS_DESC[1] <> "" Then
        {
        Writefile(L_FILE_NAME,"%s",TRUN(agqgeneral:business_Desc[1]) + " " + trun(agqgeneral:BUSINESS_DESC[2]))
        }

Writefile(L_FILE_NAME,"%s","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s","<033>&a220h+120V")
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s","IN RETURN FOR PAYMENT OF THE PREMIUM, AND SUBJECT TO ALL THE TERMS OF THIS app, ")
Writefile(L_FILE_NAME,"%s","<033>&a220h+120V")
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s","WE AGREE WITH YOU TO PROVIDE THE INSURANCE AS STATED IN THIS app.  THERE ARE EXCLUSIONS,")
Writefile(L_FILE_NAME,"%s","<033>&a220h+120V")
Writefile(L_FILE_NAME,"%s","CONDITIONS AND LIMITATIONS CONTAINED IN THE app FORMS AND ENDORSEMENTS.")
Writefile(L_FILE_NAME,"%s","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s%s","<033>&a140h-80V<033>*c5455h5v0P","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 0.3

If L_LINE_COUNTER >= L_MAX_LINES - 5 Then
  {
    Do INSERT_NEWPAGE
  }
If L_LINE_COUNTER >= L_MAX_LINES - 22 Then
  {
    Do INSERT_NEWPAGE
  }

Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
Writefile(L_FILE_NAME,"%s","<033>&a220h+0V")
Writefile(L_FILE_NAME,"%s","THIS app CONSISTS OF THE FOLLOWING COVERAGE PARTS FOR WHICH A PREMIUM IS INDICATED. THIS PREMIUM")
Writefile(L_FILE_NAME,"%s","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s","<033>&a220h+0V")
Writefile(L_FILE_NAME,"%s","MAY BE SUBJECT TO ADJUSTMENT.")
Writefile(L_FILE_NAME,"%s","<033>&a4060h+0V")
Writefile(L_FILE_NAME,"%s","(N/A MEANS NO COVERAGE)")
Writefile(L_FILE_NAME,"%s","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s","<033>&a4250h+0V")
Writefile(L_FILE_NAME,"%s","ADVANCE PREMIUM")
Writefile(L_FILE_NAME,"%s","<NL>")
Writefile(L_FILE_NAME,"%s","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 2

Writefile(L_FILE_NAME,"%s","<033>&a600h+0V")
Writefile(L_FILE_NAME,"%s","Commercial Property Coverage Part")
Writefile(L_FILE_NAME,"%s","<033>&a4400h+0V")
Writefile(L_FILE_NAME,"%s","$")

Access SFSLINE,
   Set SFSLINE:COMPANY_ID       = agqNAME:COMPANY_ID,
       SFSLINE:LINE_OF_BUSINESS = agqNAME:LINE_OF_BUSINESS, generic

If agqMASTER:TOTAL[1] <> 0 Or
   agqMASTER:TOTAL[2] <> 0 or
   agqmaster:total[7] <> 0 Then
    begin
    Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
    if agqname:eff_date >= scipscontrol:show_account_mod_date then
        begin
        if agqmaster:irpm <> 0 then
            Writefile(L_FILE_NAME,"%s",Str(agqmaster:total[1] +
                                           agqmaster:total[2] +
                                           agqmaster:total[7] +
                                           agqmaster:total[9] +
                                           agqmaster:other_totals[17],"(ZZZ,ZZZ,ZZZ)"))
        else
            Writefile(L_FILE_NAME,"%s",Str(agqmaster:total[1] +
                                           agqmaster:total[2] +
                                           agqmaster:total[7] +
                                           agqmaster:other_totals[17],"(ZZZ,ZZZ,ZZZ)"))
        end
    else
        Writefile(L_FILE_NAME,"%s",Str(agqmaster:total[1] +
                                       agqmaster:total[2] +
                                       agqmaster:total[7] +
                                       agqmaster:other_totals[17],"(ZZZ,ZZZ,ZZZ)"))
    end
Else
    begin
    Writefile(L_FILE_NAME,"%s","<033>&a4850h+0V")
    Writefile(L_FILE_NAME,"%s",SCIPSCONTROL:BLANK_WORDING)
    end

Writefile(L_FILE_NAME,"%s","<NL>")
Writefile(L_FILE_NAME,"%s","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 2

Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
Writefile(L_FILE_NAME,"%s","<033>&a600h+0V")
Writefile(L_FILE_NAME,"%s","Commercial General Liability Coverage Part")
Writefile(L_FILE_NAME,"%s","<033>&a4400h+0V")
Writefile(L_FILE_NAME,"%s","$")

If agqMASTER:TOTAL[5] <> 0 or
   agqmaster:total[10] <> 0 Then
    begin
    Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
    if agqname:eff_date >= scipscontrol:show_account_mod_date then
        begin
        if agqmaster:irpm <> 0 then
            Writefile(L_FILE_NAME,"%s",Str(agqmaster:total[5] +
                                           agqmaster:total[10] +
                                           agqmaster:total[11] +
                                           agqmaster:other_totals[18],"(ZZZ,ZZZ,ZZZ)"))
        else
            Writefile(L_FILE_NAME,"%s",Str(agqmaster:total[5] +
                                           agqmaster:total[10] +
                                           agqmaster:other_totals[18],"(ZZZ,ZZZ,ZZZ)"))
        If agqMASTER:MINIMUM_PREMIUM[5] = "Y" Then
            begin
            Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
            Writefile(L_FILE_NAME,"%s"," MP")
            end
        end
    else
        begin
        l_total = agqmaster:total[5] +
                  agqmaster:total[10] +
                  agqmaster:other_totals[18]
        Writefile(L_FILE_NAME,"%s",Str(l_total,"(ZZZ,ZZZ,ZZZ)"))

        If agqMASTER:MINIMUM_PREMIUM[5] = "Y" Then
            begin
            Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
            Writefile(L_FILE_NAME,"%s"," MP")
            end
        end

    end
Else
    begin
    Writefile(L_FILE_NAME,"%s","<033>&a4850h+0V")
    Writefile(L_FILE_NAME,"%s",SCIPSCONTROL:BLANK_WORDING)
    end

Writefile(L_FILE_NAME,"%s","<NL>")
Writefile(L_FILE_NAME,"%s","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 2

Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
Writefile(L_FILE_NAME,"%s","<033>&a600h+0V")
Writefile(L_FILE_NAME,"%s","Commercial Inland Marine Coverage Part")
Writefile(L_FILE_NAME,"%s","<033>&a4400h+0V")
Writefile(L_FILE_NAME,"%s","$")

If agqMASTER:TOTAL[6] <> 0 Then
    begin
    Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
    if agqname:eff_date >= scipscontrol:show_account_mod_date then
        begin
        if agqmaster:irpm <> 0 then
            Writefile(L_FILE_NAME,"%s",Str(agqmaster:total[6] +
                                           agqmaster:total[12] +
                                           agqmaster:other_totals[19],"(ZZZ,ZZZ,ZZZ)"))
        else
            Writefile(L_FILE_NAME,"%s",Str(agqmaster:total[6] +
                                           agqmaster:other_totals[19],"(ZZZ,ZZZ,ZZZ)"))
        end
    else
        begin
        Writefile(L_FILE_NAME,"%s",Str(agqmaster:total[6] +
                                       agqmaster:other_totals[19],"(ZZZ,ZZZ,ZZZ)"))
        end
    end
Else
    begin
    Writefile(L_FILE_NAME,"%s","<033>&a4850h+0V")
    Writefile(L_FILE_NAME,"%s",SCIPSCONTROL:BLANK_WORDING)
    end

Writefile(L_FILE_NAME,"%s","<NL>")
Writefile(L_FILE_NAME,"%s","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 2

Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
Writefile(L_FILE_NAME,"%s","<033>&a600h+0V")
Writefile(L_FILE_NAME,"%s","Commercial Crime Coverage Part")
Writefile(L_FILE_NAME,"%s","<033>&a4400h+0V")
Writefile(L_FILE_NAME,"%s","$")

If agqMASTER:TOTAL[4] <> 0 Then
    begin
    Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
    if agqname:eff_date >= scipscontrol:show_account_mod_date then
        begin
        if agqmaster:irpm <> 0 then
            Writefile(L_FILE_NAME,"%s",Str(agqmaster:total[4] +
                                           agqmaster:total[13],"(ZZZ,ZZZ,ZZZ)"))
        else
            Writefile(L_FILE_NAME,"%s",Str(agqmaster:total[4],"(ZZZ,ZZZ,ZZZ)"))
        end
    else
        begin
        Writefile(L_FILE_NAME,"%s",Str(agqmaster:total[4],"(ZZZ,ZZZ,ZZZ)"))
        end
    end
Else
    begin
    Writefile(L_FILE_NAME,"%s","<033>&a4850h+0V")
    Writefile(L_FILE_NAME,"%s",SCIPSCONTROL:BLANK_WORDING)
    end

Writefile(L_FILE_NAME,"%s","<NL>")
Writefile(L_FILE_NAME,"%s","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 2

Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
Writefile(L_FILE_NAME,"%s","<033>&a600h+0V")
Writefile(L_FILE_NAME,"%s","Commercial Glass Coverage Part")
Writefile(L_FILE_NAME,"%s","<033>&a4400h+0V")
Writefile(L_FILE_NAME,"%s","$")

If agqMASTER:TOTAL[3] <> 0 Then
    begin
    Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
    if agqname:eff_date >= scipscontrol:show_account_mod_date then
        begin
        if agqmaster:irpm <> 0 then
            Writefile(L_FILE_NAME,"%s",Str(agqmaster:total[3] +
                                           agqmaster:total[14],"(ZZZ,ZZZ,ZZZ)"))
        else
            Writefile(L_FILE_NAME,"%s",Str(agqmaster:total[3],"(ZZZ,ZZZ,ZZZ)"))
        end
    else
        begin
        Writefile(L_FILE_NAME,"%s",Str(agqmaster:total[3],"(ZZZ,ZZZ,ZZZ)"))
        end
    end
Else
    begin
    Writefile(L_FILE_NAME,"%s","<033>&a4850h+0V")
    Writefile(L_FILE_NAME,"%s",SCIPSCONTROL:BLANK_WORDING)
    end

Writefile(L_FILE_NAME,"%s","<NL>")
Writefile(L_FILE_NAME,"%s","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 2

Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
Writefile(L_FILE_NAME,"%s","<033>&a600h+0V")
Writefile(L_FILE_NAME,"%s","Certified Terrorism Coverage")
Writefile(L_FILE_NAME,"%s","<033>&a4400h+0V")
Writefile(L_FILE_NAME,"%s","$")

If agqMASTER:terrorism_premium <> 0 Then
    begin
    Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
    Writefile(L_FILE_NAME,"%s",Str(agqMASTER:terrorism_premium,"(ZZZ,ZZZ,ZZZ)"))
    end
Else
    begin
    Writefile(L_FILE_NAME,"%s","<033>&a4850h+0V")
    Writefile(L_FILE_NAME,"%s",SCIPSCONTROL:BLANK_WORDING)
    end

Writefile(L_FILE_NAME,"%s","<NL>")
Writefile(L_FILE_NAME,"%s","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 2

If (SCIPSCONTROL:SHOW_ACCOUNT_MOD_IN_TOTALS = 0 or
   (scipscontrol:show_account_mod_in_totals = 1 and
   agqname:eff_date < scipscontrol:show_account_mod_date)) Then
    begin
    Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
    Writefile(L_FILE_NAME,"%s","<033>&a600h+0V")
    Writefile(L_FILE_NAME,"%s","Account Modification")
    Writefile(L_FILE_NAME,"%s","<033>&a4400h+0V")
    Writefile(L_FILE_NAME,"%s","$")

    If agqMASTER:TOTAL[8] <> 0 Then
        begin
        Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
        Writefile(L_FILE_NAME,"%s",Str(agqMASTER:TOTAL[8],"(ZZZ,ZZZ,ZZZ)"))
        end
    Else
        begin
        Writefile(L_FILE_NAME,"%s","<033>&a4850h+0V")
        Writefile(L_FILE_NAME,"%s",SCIPSCONTROL:BLANK_WORDING)
        end
    end

Writefile(L_FILE_NAME,"%s","<NL>")
Writefile(L_FILE_NAME,"%s","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 2

Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
Writefile(L_FILE_NAME,"%s","<033>&a1200h+120V")
Writefile(L_FILE_NAME,"%s","Total Advance Premium")
Writefile(L_FILE_NAME,"%s","<033>&a4400h+0V")
Writefile(L_FILE_NAME,"%s","$")
Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
Writefile(L_FILE_NAME,"%s",Str(agqMASTER:TOTAL[1] +
                               agqMASTER:TOTAL[2] +
                               agqmaster:total[3] +
                               agqmaster:total[4] +
                               agqmaster:total[5] +
                               agqmaster:total[6] +
                               agqmaster:total[7] +
                               agqmaster:total[8] +
                               agqmaster:total[10] +
                               agqmaster:other_totals[17] +
                               agqmaster:other_totals[18] +
                               agqmaster:other_totals[19] +
                               agqmaster:terrorism_premium,"(ZZZ,ZZZ,ZZZ)"))

Writefile(L_FILE_NAME,"%s","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1

If SCIPSCONTROL:SURCHARGE_WORDING <> "" Then
    {
    Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
    Writefile(L_FILE_NAME,"%s","<033>&a1200h+0V")
    Writefile(L_FILE_NAME,"%s",SCIPSCONTROL:SURCHARGE_WORDING)
    Writefile(L_FILE_NAME,"%s","<033>&a4400h+0V")
    Writefile(L_FILE_NAME,"%s","$")
    Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
    Writefile(L_FILE_NAME,"%s",Str(agqmaster:surcharge,"ZZZ,ZZZ,ZZZ"))
    Writefile(L_FILE_NAME,"%s","<NL>")
    L_LINE_COUNTER = L_LINE_COUNTER + 1
  }

if scipscontrol:breakout_pliga = 1 then
    begin
    If L_TRANS_CODE One Of 11, 16 Then  --these are endorsements transcodes
        begin
        Writefile(L_FILE_NAME,"%s","<NL>")
        L_LINE_COUNTER = L_LINE_COUNTER + 1

        Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
        Writefile(L_FILE_NAME,"%s","<033>&a1200h+0V")
        Writefile(L_FILE_NAME,"%s",SCIPSCONTROL:CANCELLATION_DEFINITION)
        Writefile(L_FILE_NAME,"%s","<033>&a4400h+0V")
        Writefile(L_FILE_NAME,"%s","$")
        Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
        Writefile(L_FILE_NAME,"%s",Str(agqMASTER:amt_due_TOTAL[1],"(ZZZ,ZZZ,ZZ9)"))

        Writefile(L_FILE_NAME,"%s","<NL>")
        L_LINE_COUNTER = L_LINE_COUNTER + 1

        Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
        Writefile(L_FILE_NAME,"%s","<033>&a1200h+0V")
        Writefile(L_FILE_NAME,"%s",SCIPSCONTROL:CANCELLATION_DEFINITION_1)
        Writefile(L_FILE_NAME,"%s","<033>&a4400h+0V")
        Writefile(L_FILE_NAME,"%s","$")
        Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
        Writefile(L_FILE_NAME,"%s",Str(agqMASTER:amt_due_TOTAL[3],"(ZZZ,ZZZ,ZZ9)"))

        Writefile(L_FILE_NAME,"%s","<NL>")
        L_LINE_COUNTER = L_LINE_COUNTER + 1
        end
    else
    If L_TRANS_CODE One Of 12, 13, 15 Then  --these are endorsements transcodes
        begin
        Writefile(L_FILE_NAME,"%s","<NL>")
        L_LINE_COUNTER = L_LINE_COUNTER + 1

        Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
        Writefile(L_FILE_NAME,"%s","<033>&a1200h+0V")
        Writefile(L_FILE_NAME,"%s",SCIPSCONTROL:endorsement_DEFINITION)
        Writefile(L_FILE_NAME,"%s","<033>&a4400h+0V")
        Writefile(L_FILE_NAME,"%s","$")
        Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
        Writefile(L_FILE_NAME,"%s",Str(agqMASTER:amt_due_TOTAL[1],"(ZZZ,ZZZ,ZZ9)"))

        Writefile(L_FILE_NAME,"%s","<NL>")
        L_LINE_COUNTER = L_LINE_COUNTER + 1

        Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
        Writefile(L_FILE_NAME,"%s","<033>&a1200h+0V")
        Writefile(L_FILE_NAME,"%s",SCIPSCONTROL:endorsement_DEFINITION_1)
        Writefile(L_FILE_NAME,"%s","<033>&a4400h+0V")
        Writefile(L_FILE_NAME,"%s","$")
        Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
        Writefile(L_FILE_NAME,"%s",Str(agqMASTER:amt_due_TOTAL[3],"(ZZZ,ZZZ,ZZ9)"))

        Writefile(L_FILE_NAME,"%s","<NL>")
        L_LINE_COUNTER = L_LINE_COUNTER + 1
        end
    end
else
    begin
    If L_TRANS_CODE One Of 11, 12, 13, 15, 16 Then
        begin
        Writefile(L_FILE_NAME,"%s","<NL>")
        L_LINE_COUNTER = L_LINE_COUNTER + 1

        Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
        Writefile(L_FILE_NAME,"%s","<033>&a1200h+0V")
        Writefile(L_FILE_NAME,"%s",SCIPSCONTROL:CANCELLATION_DEFINITION)
        Writefile(L_FILE_NAME,"%s","<033>&a4400h+0V")
        Writefile(L_FILE_NAME,"%s","$")
        Writefile(L_FILE_NAME,"%s",trun(L_LETTER_GOTHIC_BOLD_10))
        Writefile(L_FILE_NAME,"%s",Str(agqMASTER:amt_due_TOTAL[20],"(ZZZ,ZZZ,ZZ9)"))

        Writefile(L_FILE_NAME,"%s","<NL>")
        L_LINE_COUNTER = L_LINE_COUNTER + 1
        end
    end

Writefile(L_FILE_NAME,"%s%s","<033>&a140h-80V<033>*c5455h10v0P","<NL>")

  If L_PAGE_NUMBER = 1 or
     l_line_counter >= L_MAX_LINES - 6 Then
    {
      Do INSERT_NEWPAGE
    }

Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_9))
Writefile(L_FILE_NAME,"%s","<033>&a220h+120V")
Writefile(L_FILE_NAME,"%s","These Declarations together with the Forms and Endorsements, if any, issued to form a part thereof,")
Writefile(L_FILE_NAME,"%s","<033>&a220h+100V")
Writefile(L_FILE_NAME,"%s","completes the above numbered app.")
Writefile(L_FILE_NAME,"%s","<NL>")
Writefile(L_FILE_NAME,"%s","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 2

    --the next line of code will be used to a signature
--    Writefile(L_FILE_NAME,"%s%s%s%s%s","<033>&a2800h-20V",
--
--                          "<033>(0U<033>(s1p30.0v0s0b133T",
--                          "ABC",trun(L_ARIAL),"<033>&a2800h+20V")

Writefile(L_FILE_NAME,"%s%s%s%s%s%s",trun(L_ARIAL),"<033>&a200h+0V<033>*c2000h5v0P",
                      "<033>&a2575h+0V","By:","<033>&a2750h-0V<033>*c2800h5v0P",
                      "<NL>")

Writefile(L_FILE_NAME,"%s%s%s%s","<033>&a800h+0V","Countersignature Date",
                      "<033>&a3200h+0V","Representative")


Writefile(L_FILE_NAME,"%s%s%s%s",trun(L_ARIAL_BOLD),"<033>&a200h7250V","Issue Date ",
                      Str(agqNAME:TRANS_DATE,"mm/dd/yyyy"))



Screen Exit
Writefile(L_FILE_NAME,"%s%s",L_FORMFEED ,L_RESET )
Closefile(L_FILE_NAME)

Procedure Definition

number FUNCTION add_and_check_print_array(string p_code)

BEGIN
 local unsigned ascii number l_loop[3];
 local unsigned ascii number l_return_value[1];
  l_loop = 1
  while l_no_duplicate_printing[l_loop] <> p_code and
        l_no_duplicate_printing[l_loop] <> "" and
        l_loop < 120   --prevents out of array out of bounds
    {
      L_loop = l_loop + 1
    }
  --found position of where to put the next form in the loop
  if l_no_duplicate_printing[l_loop] <> p_code then
    {
      l_no_duplicate_printing[l_loop] = p_code
      l_return_value = 1
    }
  else
    {
      l_return_value = 0
    }
  return l_return_value
END

procedure check_payor_flags

{
  if scipscontrol:payor_code_bottom_of_page one of 1 and
     agqname:eff_date >= scipscontrol:payor_code_bottom_page_date then
    {
      Writefile(L_FILE_NAME,"%s","<033>&a4000h+0V")
      If SCIPSCONTROL:DONT_PRINT_PAYOR_CODE_ALL_COPY = 1 then
        {
          If SCIPSCONTROL:payor_code_bottom_of_page one of 1 and
             trun(uppercase(SCIPSCONTROL:PAY_CODE_COPY_NAME)) = trun(uppercase(L_COPY_NAME)) Then
            {
              do print_payor_codes
            }
        }
      else
        {
          If SCIPSCONTROL:payor_code_bottom_of_page one of 1 then
            {
              do print_payor_codes
            }
        }
    }
}

Procedure print_payor_codes

{
  L_BILL_PLAN = agqNAME:BILL_PLAN
  If agqSUPP:MORTGAGE_TYPE_1 = "" Then
    {
      L_MORTGAGE_TYPE_1 = " "
    }
  Else
    {
      L_MORTGAGE_TYPE_1 = agqSUPP:MORTGAGE_TYPE_1
    }
  Access SFSPAYCODE,
     Set SFSPAYCODE:COMPANY_ID      = L_COMPANY_ID,
         SFSPAYCODE:BILL_PLAN       = L_BILL_PLAN,
         SFSPAYCODE:MORTGAGE_TYPE_1 = L_MORTGAGE_TYPE_1, Generic
  Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD))
  Writefile(L_FILE_NAME,"%s","<033>&a+0h+0V")
  Writefile(L_FILE_NAME,"%s"," - ")
  Writefile(L_FILE_NAME,"%s",agqNAME:BILL_PLAN)
  Writefile(L_FILE_NAME,"%s"," - ")
  Writefile(L_FILE_NAME,"%s",SFSPAYCODE:PAY_CODE)
}

Procedure INSERT_NEWPAGE

{
  Writefile(L_FILE_NAME,"%s","<FF>")
  L_LINE_COUNTER = 0
  If SCIPSCONTROL:PRINT_BORDERS_ON_DEC_PAGE = 1 Then
    {
      Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c10a3045b0P")   --left vertical li
      Writefile(L_FILE_NAME,"%s","<033>&a5585h0V<033>*c10a3045b0P")   --right vertical
      Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c5460h20v0P") --top horizontal line to
      Writefile(L_FILE_NAME,"%s","<033>&a140h7300V<033>*c5460h20v0P") --bottom horizontal line
    }
  L_PAGE_NUMBER = L_PAGE_NUMBER + 1

  Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD))
  Writefile(L_FILE_NAME,"%s","<033>&a2400h7250V")
  Writefile(L_FILE_NAME,"%s",L_COPY_NAME)
  Writefile(L_FILE_NAME,"%s","<033>&a5000h+0V")
  Writefile(L_FILE_NAME,"%s","Page ")
  Writefile(L_FILE_NAME,"%n",L_PAGE_NUMBER)
  Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
  Writefile(L_FILE_NAME,"%s","<033>&a200h120V")
  Writefile(L_FILE_NAME,"%s","COMMERCIAL MULTI PERIL app LETTER")
  Writefile(L_FILE_NAME,"%s","<033>&a4200h+0V")
  Writefile(L_FILE_NAME,"%s","app No. ")
  Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_9))
  Writefile(L_FILE_NAME,"%s",Trun(SFSLINE:ALPHA))
  Writefile(L_FILE_NAME,"%n",l_app_no)

  Writefile(L_FILE_NAME,"%s%s%s","<033>&a150h+40V<033>*c5460h5v0P","<NL>","<NL>")  --HORZ LINE deductible section I coverage PG. 1
  L_LINE_COUNTER = L_LINE_COUNTER + 2
--  Writefile(L_FILE_NAME,"%s","<033>&a150h+0V<033>*c5a120b0P")   --left vertical line
}

Procedure HEADDINGS
{

  If agqend:ok_print = 1  and
     L_LOB_END_CODE = "L" And
       L_DO_ONCE = 0 Then
    {
      L_DO_ONCE = 1

      Writefile(L_FILE_NAME,"%s","<033>&a150h+0V<033>*c5455h5v0P")

      Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_9))
      Writefile(L_FILE_NAME,"%s","<033>&a220h+120V")
      Writefile(L_FILE_NAME,"%s","The following forms and endorsements are applicable to the Commercial General Liability Coverage Part")

      Writefile(L_FILE_NAME,"%s","<033>&a220h+240V")

      l_line_counter = l_line_counter + 3
    }

  If agqend:ok_print = 1 And
     L_LOB_END_CODE = "P" And
     L_DO_ONCE = 0 Then
    {
      L_DO_ONCE = 1

      Writefile(L_FILE_NAME,"%s","<033>&a150h+0V<033>*c5455h5v0P")

      Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_9))
      Writefile(L_FILE_NAME,"%s","<033>&a220h+120V")
      Writefile(L_FILE_NAME,"%s","The following forms and endorsements are applicable to the Commercial Property Coverage Part")

      Writefile(L_FILE_NAME,"%s","<033>&a220h+240V")

      l_line_counter = l_line_counter + 3
    }

  If agqend:ok_print = 1 And
     L_LOB_END_CODE = "C" And
     L_DO_ONCE = 0 Then
    {
      L_DO_ONCE = 1

      Writefile(L_FILE_NAME,"%s","<033>&a150h+0V<033>*c5455h5v0P")

      Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_9))
      Writefile(L_FILE_NAME,"%s","<033>&a220h+120V")
      Writefile(L_FILE_NAME,"%s","The following forms and endorsements are applicable to the Commercial Crime Coverage Part")

      Writefile(L_FILE_NAME,"%s","<033>&a220h+240V")

      l_line_counter = l_line_counter + 3
    }

  If agqend:ok_print = 1 And
     L_LOB_END_CODE = "I" And
     L_DO_ONCE = 0 Then
    {
      L_DO_ONCE = 1

      Writefile(L_FILE_NAME,"%s","<033>&a150h+0V<033>*c5455h5v0P")

      Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_9))
      Writefile(L_FILE_NAME,"%s","<033>&a220h+120V")
      Writefile(L_FILE_NAME,"%s","The following forms and endorsements are applicable to the Commercial Inland Marine Coverage Part")

      Writefile(L_FILE_NAME,"%s","<033>&a220h+240V")

      l_line_counter = l_line_counter + 3
    }

  If agqend:ok_print = 1 And
     L_LOB_END_CODE = "G" And
     L_DO_ONCE = 0 Then
    {
      L_DO_ONCE = 1

      Writefile(L_FILE_NAME,"%s","<033>&a150h+0V<033>*c5455h5v0P")

      Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_9))
      Writefile(L_FILE_NAME,"%s","<033>&a220h+120V")
      Writefile(L_FILE_NAME,"%s","The following forms and endorsements are applicable to the Commercial Glass Coverage Part")

      Writefile(L_FILE_NAME,"%s","<033>&a220h+240V")

      l_line_counter = l_line_counter + 3
    }

  If agqend:ok_print = 1 And
     L_LOB_END_CODE = "B" And
     L_DO_ONCE = 0 Then
    {
      L_DO_ONCE = 1

      Writefile(L_FILE_NAME,"%s","<033>&a150h+0V<033>*c5455h5v0P")

      Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_9))
      Writefile(L_FILE_NAME,"%s","<033>&a220h+120V")
      Writefile(L_FILE_NAME,"%s","The following forms and endorsements are applicable to the Commercial Business Income Coverage Part")

      Writefile(L_FILE_NAME,"%s","<033>&a220h+240V")

      l_line_counter = l_line_counter + 3
    }

  If agqend:ok_PRINT = 1 And
     L_LOB_END_CODE = "F" And
     L_DO_ONCE = 0 Then
    {
      L_DO_ONCE = 1

      Writefile(L_FILE_NAME,"%s","<033>&a150h+0V<033>*c5455h5v0P")

      Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_9))
      Writefile(L_FILE_NAME,"%s","<033>&a220h+120V")
      Writefile(L_FILE_NAME,"%s","The following forms and endorsements are applicable to the Commercial Farm Coverage Part")

      Writefile(L_FILE_NAME,"%s","<033>&a220h+240V")

      l_line_counter = l_line_counter + 3
    }

}
End

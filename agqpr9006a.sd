%%
program
        name = "agqpr9006a" ;
        type = "file" ;
        padcharacter = space ;
        domain="flat" ;

        local string l_macro[15],
                     l_enter,
                     l_macroa[15],
                     l_dec[12],
                     l_dec_pdf[15] ,
                     l_first[1]="Y",
                     l_print_first[1]="Y",
                     l_csexec_application[25] ,
                     l_lob_code[10] ,
                     l_code[7],
                     l_bill_plan[15],
                     l_townhouse[1],
                     l_pool[1],
                     l_fenced[1],
                     l_trampoline[1],
                     l_oil[1],
                     l_wood_stove[1],
                     l_fire_resistive[1],
                     l_user_id[15],
                     l_original_owner[1],
                     l_leed[1],
                     l_tenure[1],
                     l_loyalty[1],
                     l_no_units[2],
                     l_rented_condo[1],
                     l_company_id[10];

        local unsigned ascii number l_csexec_number[12] ,
                                    l_max_lines[2]=60,
                                    l_line_counter[2],
                                    l_state[2] ,
                                    l_construction[1],
                                    l_county[3],
                                    l_base_rate[8]=0/dec=4,
                                    l_line_of_business[4] ,
                                    l_roof_type[2],
                                    l_app_no[11],
                                    l_credit[4]=0/dec=2,
                                    l_total_credit[4]=0/dec=2,
                                    l_counter ;

        include "sfscsexec.var"

        include "csfonts.inc"

        include "sfsrevname7.var"

initialisation
l_app_no = val(commandline[1,11])

l_line_counter = 1
access agqname, set agqname:app_no = l_app_no, generic

access agqmaster, set agqmaster:app_no = l_app_no, generic

access agqlocation, set agqlocation:app_no = l_app_no, generic

access sfscompany, set sfscompany:company_id = agqname:company_id, generic

access sfsagent, set sfsagent:company_id = agqname:company_id,
                     sfsagent:agent_no   = agqname:agent_no, generic

l_user_id = username
access sfsemail, set sfsemail:company_id = agqname:company_id,
                     sfsemail:user_id    = l_user_id, generic

access sfsline, set sfsline:company_id       = agqname:company_id,
                    sfsline:line_of_business = agqname:line_of_business,
                    sfsline:lob_subline      = "00", generic

access arspayplan, set arspayplan:company_id       = agqname:company_id,
                       arspayplan:line_of_business = agqname:line_of_business,
                       arspayplan:payment_plan     = agqname:payment_plan, generic

access agqpersonal, set agqpersonal:app_no = l_app_no, generic

access agqpersonal1, set agqpersonal1:app_no = l_app_no, generic

access agqpersonal2, set agqpersonal2:app_no = l_app_no, generic

access agqcreditscore, set agqcreditscore:app_no = l_app_no, generic

l_state        = agqpersonal:state
l_county       = agqpersonal:county
l_lob_code     = sfsline:lob_code
l_roof_type    = agqpersonal2:roof_type
l_construction = agqpersonal:construction
access scipscontrol, set scipscontrol:company_id = agqname:company_id,
                         scipscontrol:state      = l_state,
                         scipscontrol:lob_code   = l_lob_code, generic

access sfsconstruction, set sfsconstruction:company_id       = agqname:company_id,
                            sfsconstruction:state            = l_state,
                            sfsconstruction:line_of_business = agqname:line_of_business,
                            sfsconstruction:construction     = l_construction, generic

access sfsstate, set sfsstate:company_id = agqname:company_id,
                     sfsstate:state      = l_state,
                     sfsstate:county     = "000", generic

access sfsstate_alias, set sfsstate_alias:company_id = agqname:company_id,
                           sfsstate_alias:state      = l_state,
                           sfsstate_alias:county     = l_county, generic

access hrarooftype, set hrarooftype:company_id       = agqname:company_id,
                        hrarooftype:state            = l_state,
                        hrarooftype:line_of_business = agqname:line_of_business,
                        hrarooftype:roof_type        = l_roof_type, generic

L_CSEXEC_APPLICATION = "PRINT"/raw

Access SFSCSEXEC, Set SFSCSEXEC:APPLICATION = L_CSEXEC_APPLICATION, Exact

If SFSCSEXEC:APPLICATION_NUMBER = 0 Then
    Begin
    L_CSEXEC_NUMBER = 99999
    End
Else
    Begin
    L_CSEXEC_NUMBER = SFSCSEXEC:APPLICATION_NUMBER + 1

    Change SFSCSEXEC
        Begin
        SFSCSEXEC:APPLICATION_NUMBER = L_CSEXEC_NUMBER
        End
    End

l_dec = "agqpr9006.cq"
deletefile(l_dec)

do create_header
do worksheet

access agqend, set agqend:app_no = l_app_no, generic

if agqend:app_no = l_app_no then
    begin
    writefile(l_dec,"%s",l_arial)
--    writefile(l_dec,"%s","<NL>")
--    l_line_counter = l_line_counter + 1
    writefile(l_dec,"%s","<033>&a300h+0V")
    writefile(l_dec,"%s","OPTIONAL ENDORSEMENTS")
    writefile(l_dec,"%s","<NL>")
    writefile(l_dec,"%s","<NL>")
    l_line_counter = l_line_counter + 2
    writefile(l_dec,"%s","<033>&a300h+0V")
    writefile(l_dec,"%s","FORM EDITION")
    writefile(l_dec,"%s","<033>&a1500h+0V")
    writefile(l_dec,"%s","DESCRIPTION")
    writefile(l_dec,"%s","<033>&a4000h+0V")
    writefile(l_dec,"%s","PREMIUM")
    writefile(l_dec,"%s","<NL>")
    l_line_counter = l_line_counter + 1
    end

while agqend:app_no = l_app_no
    begin
    writefile(l_dec,"%s","<033>&a300h+0V")
    writefile(l_dec,"%s",l_arial)
    writefile(l_dec,"%s",agqend:form_edition)
    writefile(l_dec,"%s","<033>&a1500h+0V")
    writefile(l_dec,"%s",trun(agqend:description))
/*    if agqend:code = "MPL70" then
        begin
        L_COUNTER = 1
        While L_COUNTER < 9
            begin
            If agqPERSONAL:ALARM_OPTION[L_COUNTER] = 1 Then
                begin
                L_CREDIT = 1.0 - agqPERSONAL:ALARM_FACTOR[L_COUNTER]
                L_TOTAL_CREDIT = L_TOTAL_CREDIT + L_CREDIT
                end

            L_COUNTER = L_COUNTER + 1
            end

        l_total_credit = l_total_credit * 100
        writefile(l_dec,"%s",str(l_total_credit,"ZZ%"))
        end*/

    writefile(l_dec,"%s",l_letter_gothic_bold_10)
    if agqend:premium <> 0 then
        begin
        writefile(l_dec,"%s","<033>&a4000h+0V")
        writefile(l_dec,"%s",str(agqend:premium,"ZZZ,ZZZ.99-"))
        end
    else
    if agqend:manual_premium <> 0 then
        begin
        writefile(l_dec,"%s","<033>&a4000h+0V")
        writefile(l_dec,"%s",str(agqend:manual_premium,"ZZZ,ZZZ.99-"))
        end
    writefile(l_dec,"%s","<NL>")
    l_line_counter = l_line_counter + 1

    next agqend
    end

writefile(l_dec,"%s","<NL>")
l_line_counter = l_line_counter + 1
writefile(l_dec,"%s","<033>&a300h+0V")
Writefile(L_dec,"%s%s%d",L_ARIAL,"Printed Date: ",Todaysdate)
writefile(l_dec,"%s","<033>&a1500h+0V")
Writefile(L_dec,"%s%s%s%s",L_ARIAL,"Printed By: ",username,"<NL>")
l_line_counter = l_line_counter + 1

do get_rating_factors

closefile(l_macro)

update

procedure definition

procedure worksheet
begin
Writefile(l_dec,"%s",l_arial)

writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Location: ")
writefile(l_dec,"%s%s",trun(agqlocation:address)," ")
writefile(l_dec,"%s%s",trun(agqlocation:city),", ")
writefile(l_dec,"%s%s",agqlocation:str_state," ")
writefile(l_dec,"%s",str(agqlocation:zipcode,"99999-9999"))
writefile(l_dec,"%s","<NL>")
writefile(l_dec,"%s","<NL>")
l_line_counter = l_line_counter + 2

writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s%s%s%s","State:         ",str(agqpersonal:state)," ",trun(sfsstate:description))
writefile(l_dec,"%s","<033>&a1650h+0V")
writefile(l_dec,"%s","County:")
writefile(l_dec,"%s","<033>&a2800h+0V")
writefile(l_dec,"%s%s%s",str(agqpersonal:county)," ",trun(sfsstate_alias:description))
writefile(l_dec,"%s","<NL>")
writefile(l_dec,"%s","<NL>")
l_line_counter = l_line_counter + 2

writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Form:")
writefile(l_dec,"%s","<033>&a1150h+0V")
writefile(l_dec,"%s",str(agqpersonal:form))
writefile(l_dec,"%s","<033>&a1650h+0V")
writefile(l_dec,"%s","Construction:")
writefile(l_dec,"%s","<033>&a2800h+0V")
writefile(l_dec,"%s",str(agqpersonal:construction))
writefile(l_dec,"%s","<033>&a2900h+0V")
writefile(l_dec,"%s",sfsconstruction:description)
writefile(l_dec,"%s","<NL>")
l_line_counter = l_line_counter + 1

writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Deductible:")
writefile(l_dec,"%s","<033>&a1150h+0V")
writefile(l_dec,"%s",str(agqpersonal:deductible))
writefile(l_dec,"%s","<033>&a1650h+0V")
writefile(l_dec,"%s","Wind Deductible:")
writefile(l_dec,"%s","<033>&a2800h+0V")
writefile(l_dec,"%s",str(agqpersonal:wind_deductible))
writefile(l_dec,"%s","<033>&a3300h+0V")
writefile(l_dec,"%s","Hurricane Deductible: ")
writefile(l_dec,"%s","<033>&a4300h+0V")
writefile(l_dec,"%s",str(agqpersonal:hurricane_deductible))
writefile(l_dec,"%s","<NL>")
l_line_counter = l_line_counter + 1

writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","No Of Families:")
writefile(l_dec,"%s","<033>&a1150h+0V")
writefile(l_dec,"%s",str(agqpersonal:no_families))
writefile(l_dec,"%s","<033>&a1650h+0V")
writefile(l_dec,"%s","Owner Occupied:")
writefile(l_dec,"%s","<033>&a2800h+0V")
writefile(l_dec,"%s",agqpersonal:owner_occupied)
writefile(l_dec,"%s","<033>&a3300h+0V")
writefile(l_dec,"%s","Seasonal:")
writefile(l_dec,"%s","<033>&a4300h+0V")
writefile(l_dec,"%s",agqpersonal:seasonal)
writefile(l_dec,"%s","<NL>")
l_line_counter = l_line_counter + 1

writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Construction Year: ")
writefile(l_dec,"%s","<033>&a1150h+0V")
writefile(l_dec,"%s",str(agqpersonal:year_construction))
writefile(l_dec,"%s","<033>&a1650h+0V")
writefile(l_dec,"%s","Coastal Rating Tier:")
writefile(l_dec,"%s","<033>&a2800h+0V")
writefile(l_dec,"%s",str(agqpersonal:tier))
writefile(l_dec,"%s","<NL>")
writefile(l_dec,"%s","<NL>")
l_line_counter = l_line_counter + 2

writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Swimming Pool:")
writefile(l_dec,"%s","<033>&a1150h+0V")
switch(agqpersonal2:swimming_pool)
  case 1  : l_pool = "Y"
  default : l_pool = "N"
  end
writefile(l_dec,"%s",l_pool)
writefile(l_dec,"%s","<033>&a1650h+0V")
writefile(l_dec,"%s","Swimming Pool Fenced:")
writefile(l_dec,"%s","<033>&a2800h+0V")
switch(agqpersonal2:swimming_pool_fenced)
  case 1  : l_fenced = "Y"
  default : l_fenced = "N"
  end
writefile(l_dec,"%s",l_fenced)
writefile(l_dec,"%s","<033>&a3300h+0V")
writefile(l_dec,"%s","Trampoline:")
writefile(l_dec,"%s","<033>&a4300h+0V")
switch(agqpersonal2:trampoline)
  case 1  : l_trampoline = "Y"
  default : l_trampoline = "N"
  end
writefile(l_dec,"%s",l_trampoline)
writefile(l_dec,"%s","<NL>")
l_line_counter = l_line_counter + 1

writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Oil Heat:")
writefile(l_dec,"%s","<033>&a1150h+0V")
switch(agqpersonal2:oil_heat)
  case 1  : l_oil = "Y"
  default : l_oil = "N"
  end
writefile(l_dec,"%s",l_oil)
writefile(l_dec,"%s","<033>&a1650h+0V")
writefile(l_dec,"%s","Wood Burning Stove:")
writefile(l_dec,"%s","<033>&a2800h+0V")
switch(agqpersonal2:wood_stove)
  case 1  : l_wood_stove = "Y"
  default : l_wood_stove = "N"
  end
writefile(l_dec,"%s",l_wood_stove)
writefile(l_dec,"%s","<033>&a3300h+0V")
writefile(l_dec,"%s","Roof Type:")
writefile(l_dec,"%s","<033>&a4300h+0V")
writefile(l_dec,"%s%s%s",str(agqpersonal2:roof_type)," ",trun(hrarooftype:description))
writefile(l_dec,"%s","<NL>")
l_line_counter = l_line_counter + 1

writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","No of Bathrooms:")
writefile(l_dec,"%s","<033>&a1150h+0V")
writefile(l_dec,"%s",str(agqpersonal2:no_bathrooms))
writefile(l_dec,"%s","<033>&a1650h+0V")
writefile(l_dec,"%s","No of Stories:")
writefile(l_dec,"%s","<033>&a2800h+0V")
writefile(l_dec,"%s",str(agqpersonal2:no_stories))
writefile(l_dec,"%s","<NL>")
l_line_counter = l_line_counter + 1

writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Original Owner:")
writefile(l_dec,"%s","<033>&a1150h+0V")
switch(agqpersonal2:original_owner)
  case 1  : l_original_owner = "Y"
  default : l_original_owner = "N"
  end
writefile(l_dec,"%s",l_original_owner)
writefile(l_dec,"%s","<033>&a1650h+0V")
writefile(l_dec,"%s","Tenure:")
writefile(l_dec,"%s","<033>&a2800h+0V")
if agqpersonal2:tenure_factor not one of 0, 1.00 then
    l_tenure = "Y"
else
    l_tenure = "N"
writefile(l_dec,"%s",l_tenure)
writefile(l_dec,"%s","<033>&a3300h+0V")
writefile(l_dec,"%s","Years with Farmers:")
writefile(l_dec,"%s","<033>&a4300h+0V")
writefile(l_dec,"%s",str(agqpersonal2:years_with_co))
writefile(l_dec,"%s","<NL>")
l_line_counter = l_line_counter + 1

writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","No Minor Losses:")
writefile(l_dec,"%s","<033>&a1150h+0V")
writefile(l_dec,"%s",str(agqpersonal2:minor_loss))
writefile(l_dec,"%s%s","/",str(agqpersonal2:minor_loss_found))
writefile(l_dec,"%s","<033>&a1650h+0V")
writefile(l_dec,"%s","No Major Losses:")
writefile(l_dec,"%s","<033>&a2800h+0V")
writefile(l_dec,"%s",str(agqpersonal2:major_loss))
writefile(l_dec,"%s%s","/",str(agqpersonal2:major_loss_found))
writefile(l_dec,"%s","<033>&a3300h+0V")
writefile(l_dec,"%s","<033>&a3300h+0V")
writefile(l_dec,"%s","LEED:")
writefile(l_dec,"%s","<033>&a4300h+0V")
switch(agqpersonal2:leed_certified)
  case 1  : l_leed = "Y"
  default : l_leed = "N"
  end
writefile(l_dec,"%s",l_leed)
writefile(l_dec,"%s","<NL>")
l_line_counter = l_line_counter + 1

writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Fire Safe Tier:")
writefile(l_dec,"%s","<033>&a1150h+0V")
writefile(l_dec,"%s",str(agqpersonal2:fire_safe_score))
writefile(l_dec,"%s","<033>&a1650h+0V")
writefile(l_dec,"%s","Initial Tier:")
writefile(l_dec,"%s","<033>&a2800h+0V")
writefile(l_dec,"%s",str(agqpersonal2:credit_score_tier_initial))
writefile(l_dec,"%s","<033>&a3300h+0V")
writefile(l_dec,"%s","Loyalty Discount:")
writefile(l_dec,"%s","<033>&a4300h+0V")
switch(agqpersonal2:loyalty)
  case 1  : l_loyalty = "Y"
  default : l_loyalty = "N"
  end
writefile(l_dec,"%s",l_loyalty)
writefile(l_dec,"%s","<NL>")
l_line_counter = l_line_counter + 1

if agqpersonal:form one of 4, 6 then
    begin
    writefile(l_dec,"%s","<033>&a300h+0V")
    writefile(l_dec,"%s","No Units:")
    writefile(l_dec,"%s","<033>&a1150h+0V")
    writefile(l_dec,"%s",str(agqpersonal2:no_units,"ZZ"))
    writefile(l_dec,"%s","<033>&a1650h+0V")
    writefile(l_dec,"%s","Final Tier:")
    writefile(l_dec,"%s","<033>&a2800h+0V")
    writefile(l_dec,"%s",str(agqpersonal2:credit_score_tier))
    writefile(l_dec,"%s","<033>&a3300h+0V")
    writefile(l_dec,"%s","")
    writefile(l_dec,"%s","<033>&a4300h+0V")
    writefile(l_dec,"%s",str(agqcreditscore:credit_score))
    if agqpersonal:form one of 6 then
        begin
        writefile(l_dec,"%s","<NL>")
        l_line_counter = l_line_counter + 1
        writefile(l_dec,"%s","<033>&a300h+0V")
        writefile(l_dec,"%s","Rented Condo:")
        writefile(l_dec,"%s","<033>&a1150h+0V")
        switch(agqpersonal2:rented_condo)
          case 1  : l_rented_condo = "Y"
          default : l_rented_condo = "N"
          end
        writefile(l_dec,"%s",str(l_rented_condo))
        end
    writefile(l_dec,"%s","<NL>")
    l_line_counter = l_line_counter + 1
    end
else
    begin
    writefile(l_dec,"%s","<033>&a1650h+0V")
    writefile(l_dec,"%s","Final Tier:")
    writefile(l_dec,"%s","<033>&a2800h+0V")
    writefile(l_dec,"%s",str(agqpersonal2:credit_score_tier))
    writefile(l_dec,"%s","<033>&a3300h+0V")
    writefile(l_dec,"%s","")
    writefile(l_dec,"%s","<033>&a4300h+0V")
    writefile(l_dec,"%s",str(agqcreditscore:credit_score))
    end


writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Rating Group:")
writefile(l_dec,"%s","<033>&a1150h+0V")
writefile(l_dec,"%s",agqpersonal2:rating_group)
writefile(l_dec,"%s","<NL>")
l_line_counter = l_line_counter + 1
if agqpersonal2:new_cust_dis_factor not one of 0, 1.00 then
    begin
    writefile(l_dec,"%s","<033>&a300h+0V")
    writefile(l_dec,"%s","New Customer Discount")
    end
writefile(l_dec,"%s","<NL>")
writefile(l_dec,"%s","<NL>")
l_line_counter = l_line_counter + 2

writefile(l_dec,"%s","<NL>")
writefile(l_dec,"%s","<NL>")
l_line_counter = l_line_counter + 2

writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Companion Auto Co Name:")
writefile(l_dec,"%s","<033>&a1600h+0V")
writefile(l_dec,"%s",trun(agqpersonal:other_companion_co_name))
writefile(l_dec,"%s","<NL>")
l_line_counter = l_line_counter + 1

writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Policy No:")
writefile(l_dec,"%s","<033>&a800h+0V")
writefile(l_dec,"%s",agqpersonal:other_companion_policy_no)
writefile(l_dec,"%s","<033>&a1750h+0V")
writefile(l_dec,"%s","Effective Date:")
writefile(l_dec,"%s","<033>&a2500h+0V")
writefile(l_dec,"%d",agqpersonal:other_companion_eff_date)
/*writefile(l_dec,"%s","<033>&a3200h+0V")
writefile(l_dec,"%s","Credit Amount:")
writefile(l_dec,"%s","<033>&a4000h+0V")
writefile(l_dec,"%s",str(agqpersonal:palisades_credit,"$$,$$$,$$$-"))*/
writefile(l_dec,"%s","<NL>")
writefile(l_dec,"%s","<NL>")
l_line_counter = l_line_counter + 2

Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Dwelling:")
writefile(l_dec,"%s","<033>&a1200h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
writefile(l_dec,"%s",str(agqpersonal:dwelling_limit,"ZZ,ZZZ,ZZZ"))
writefile(l_dec,"%s","<033>&a1900h+0V")
writefile(l_dec,"%s",str(agqpersonal:dwelling_premium[1],"$$,$$$,$$$"))
writefile(l_dec,"%s","<NL>")
l_line_counter = l_line_counter + 1
Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Other Structures:")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
writefile(l_dec,"%s","<033>&a1200h+0V")
writefile(l_dec,"%s",str(agqpersonal:structures_limit[1],"ZZ,ZZZ,ZZZ"))
writefile(l_dec,"%s","<033>&a1900h+0V")
writefile(l_dec,"%s",str(agqpersonal:structures_premium_1[1],"$$,$$$,$$$"))
writefile(l_dec,"%s","<NL>")
l_line_counter = l_line_counter + 1
Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Personal Property:")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
writefile(l_dec,"%s","<033>&a1200h+0V")
writefile(l_dec,"%s",str(agqpersonal:contents_limit,"ZZ,ZZZ,ZZZ"))
writefile(l_dec,"%s","<033>&a1900h+0V")
writefile(l_dec,"%s",str(agqpersonal:contents_premium[1],"$$,$$$,$$$"))
writefile(l_dec,"%s","<NL>")
l_line_counter = l_line_counter + 1
Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Loss Of Use:")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
writefile(l_dec,"%s","<033>&a1200h+0V")
writefile(l_dec,"%s",str(agqpersonal:loss_rents_limit,"ZZ,ZZZ,ZZZ"))
writefile(l_dec,"%s","<033>&a1900h+0V")
writefile(l_dec,"%s",str(agqpersonal:loss_rents_premium[1],"$$,$$$,$$$"))
writefile(l_dec,"%s","<NL>")
l_line_counter = l_line_counter + 1
Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Personal Liability:")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
writefile(l_dec,"%s","<033>&a1200h+0V")
writefile(l_dec,"%s",str(agqpersonal:liability_limit,"ZZ,ZZZ,ZZZ"))
writefile(l_dec,"%s","<033>&a1900h+0V")
writefile(l_dec,"%s",str(agqpersonal:liab_medical_premium,"$$,$$$,$$$"))
writefile(l_dec,"%s","<NL>")
l_line_counter = l_line_counter + 1
Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Medical Payments:")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
writefile(l_dec,"%s","<033>&a1200h+0V")
writefile(l_dec,"%s",str(agqpersonal:medical_limit,"ZZ,ZZZ,ZZZ"))
Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<NL>")
writefile(l_dec,"%s","<NL>")
l_line_counter = l_line_counter + 2

end

procedure create_header
begin
Writefile(l_dec,"%s",l_arial)
Writefile(l_dec,"%s","<033>&a1500h+0V")
Writefile(l_dec,"%s",Trun(SFSCOMPANY:NAME[1]))
writefile(l_dec,"%s","<NL>")
writefile(l_dec,"%s","<NL>")
l_line_counter = l_line_counter + 2

writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s%s","App No:  ",str(agqname:app_no))
writefile(l_dec,"%s","<033>&a2500h+0V")
writefile(l_dec,"%s%s%s%s","Agent:  ",trun(sfsagent:name[1])," - ",str(agqname:agent_no))
writefile(l_dec,"%s","<NL>")
writefile(l_dec,"%s","<NL>")
l_line_counter = l_line_counter + 2

i_name = agqname:name[1]
include "sfsrevname7.pro"
writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s",i_rev_name)
writefile(l_dec,"%s","<NL>")
l_line_counter = l_line_counter + 1
i_name = agqname:name[2]
include "sfsrevname7.pro"
if i_rev_name <> "" then
    begin
    writefile(l_dec,"%s","<033>&a300h+0V")
    writefile(l_dec,"%s",i_rev_name)
    writefile(l_dec,"%s","<NL>")
    l_line_counter = l_line_counter + 1
    end
i_name = agqname:name[3]
include "sfsrevname7.pro"
if i_rev_name <> "" then
    begin
    writefile(l_dec,"%s","<033>&a300h+0V")
    writefile(l_dec,"%s",i_rev_name)
    writefile(l_dec,"%s","<NL>")
    l_line_counter = l_line_counter + 1
    end
if agqname:address[1] <> "" then
    begin
    writefile(l_dec,"%s","<033>&a300h+0V")
    writefile(l_dec,"%s",agqname:address[1])
    writefile(l_dec,"%s","<NL>")
    l_line_counter = l_line_counter + 1
    end
if agqname:address[2] <> "" then
    begin
    writefile(l_dec,"%s","<033>&a300h+0V")
    writefile(l_dec,"%s",agqname:address[2])
    writefile(l_dec,"%s","<NL>")
    l_line_counter = l_line_counter + 1
    end
if agqname:address[3] <> "" then
    begin
    writefile(l_dec,"%s","<033>&a300h+0V")
    writefile(l_dec,"%s",agqname:address[3])
    writefile(l_dec,"%s","<NL>")
    l_line_counter = l_line_counter + 1
    end
writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s%s%s%s%s",trun(agqname:city),", ",agqname:str_state," ",str(agqname:zipcode,"99999-9999"))
writefile(l_dec,"%s","<NL>")
writefile(l_dec,"%s","<NL>")
l_line_counter = l_line_counter + 2

writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s%d","Effective Date:  ",agqname:eff_date)
writefile(l_dec,"%s","<033>&a1650h+0V")
writefile(l_dec,"%s%d","Expiration Date:  ",agqname:exp_date)
writefile(l_dec,"%s","<033>&a3000h+0V")
writefile(l_dec,"%s%d","Transaction Date:  ",agqname:trans_date)
writefile(l_dec,"%s","<NL>")
l_line_counter = l_line_counter + 1
writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s%d","Original Eff:       ",agqname:original_eff_date)
writefile(l_dec,"%s","<NL>")
writefile(l_dec,"%s","<NL>")
l_line_counter = l_line_counter + 2

writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s%s%s%s","LOB:  ",str(agqname:line_of_business)," ",trun(sfsline:description))
writefile(l_dec,"%s","<033>&a2500h+0V")
switch(agqname:bill_plan)
  case "DB" : l_bill_plan = "Direct Bill"
  default   : l_bill_plan = "Account Current"
  end
writefile(l_dec,"%s%s","Bill Plan:  ",str(l_bill_plan))
writefile(l_dec,"%s","<NL>")
l_line_counter = l_line_counter + 1
writefile(l_dec,"%s","<033>&a300h+0V")
--writefile(l_dec,"%s%s","Payment Plan:  ",trun(arspayplan:description))
--writefile(l_dec,"%s","<033>&a2500h+0V")
writefile(l_dec,"%s%s","Previous Policy:  ",str(agqname:previous_policy_no,"ZZZZZZZZZ"))
writefile(l_dec,"%s","<NL>")
writefile(l_dec,"%s","<NL>")
l_line_counter = l_line_counter + 2

Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<033>&a750h+0V")
writefile(l_dec,"%s","Total")
writefile(l_dec,"%s","<033>&a2500h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
writefile(l_dec,"%s",str(agqmaster:total[18] - agqmaster:total[2],"ZZZ,ZZZ,ZZZ.99"))
writefile(l_dec,"%s","<NL>")
l_line_counter = l_line_counter + 1
if agqpersonal:form not one of 4 then
    begin
    Writefile(l_dec,"%s",l_arial)
    writefile(l_dec,"%s","<033>&a750h+0V")
    writefile(l_dec,"%s","Equipment Breakdown")
    writefile(l_dec,"%s","<033>&a2500h+0V")
    Writefile(l_dec,"%s",l_letter_gothic_bold_10)
    writefile(l_dec,"%s",str(agqmaster:total[2],"ZZZ,ZZZ,ZZZ.99"))
    writefile(l_dec,"%s","<NL>")
    l_line_counter = l_line_counter + 1
    end
Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<033>&a750h+0V")
writefile(l_dec,"%s","Surcharge Premium")
writefile(l_dec,"%s","<033>&a2500h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
if agqmaster:surcharge <> 0 then
    {
    writefile(l_dec,"%s",str(agqmaster:surcharge,"ZZZ,ZZZ,ZZZ.99"))
    }
writefile(l_dec,"%s","<NL>")
l_line_counter = l_line_counter + 1
Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<033>&a750h+0V")
writefile(l_dec,"%s","Final Premium")
writefile(l_dec,"%s","<033>&a2500h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
writefile(l_dec,"%s",str(agqmaster:total[18] +
                         agqmaster:surcharge,"ZZZ,ZZZ,ZZZ.99"))
writefile(l_dec,"%s","<NL>")
writefile(l_dec,"%s","<NL>")
l_line_counter = l_line_counter + 2
end

procedure get_rating_factors
begin
if l_line_counter < 62 or
   l_line_counter > 62 then
    writefile(l_dec,"%s","<FF>")

Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","State Base Rate:")
writefile(l_dec,"%s","<033>&a1850h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
writefile(l_dec,"%s",str(agqpersonal2:base_rate,"ZZZZ.ZZ"))
writefile(l_dec,"%s","<NL>")

Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Amount of Insurance Factor:")
writefile(l_dec,"%s","<033>&a1800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
writefile(l_dec,"%s",str(agqpersonal2:key_factor,"ZZZ.ZZZ"))
writefile(l_dec,"%s","<033>&a2800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
l_base_rate = agqpersonal2:base_rate * agqpersonal2:key_factor
writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
writefile(l_dec,"%s","<NL>")

if agqpersonal:form not one of 4 then
    begin
    Writefile(l_dec,"%s",l_arial)
    writefile(l_dec,"%s","<033>&a300h+0V")
    writefile(l_dec,"%s","Seasonal Factor:")
    writefile(l_dec,"%s","<033>&a1800h+0V")
    Writefile(l_dec,"%s",l_letter_gothic_bold_10)
    writefile(l_dec,"%s",str(agqpersonal2:seasonal_factor,"ZZZ.ZZZ"))
    writefile(l_dec,"%s","<033>&a2800h+0V")
    Writefile(l_dec,"%s",l_letter_gothic_bold_10)
    l_base_rate = l_base_rate * agqpersonal2:seasonal_factor
    writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
    writefile(l_dec,"%s","<NL>")
    end

if agqpersonal:form one of 3 then
    begin
    Writefile(l_dec,"%s",l_arial)
    writefile(l_dec,"%s","<033>&a300h+0V")
    writefile(l_dec,"%s","Form Factor:")
    writefile(l_dec,"%s","<033>&a1800h+0V")
    Writefile(l_dec,"%s",l_letter_gothic_bold_10)
    writefile(l_dec,"%s",str(agqpersonal2:form_factor,"ZZZ.ZZZ"))
    writefile(l_dec,"%s","<033>&a2800h+0V")
    Writefile(l_dec,"%s",l_letter_gothic_bold_10)
    l_base_rate = l_base_rate * agqpersonal2:form_factor
    writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
    writefile(l_dec,"%s","<NL>")
    end

Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Territory Factor:")
writefile(l_dec,"%s","<033>&a1800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
writefile(l_dec,"%s",str(agqpersonal2:territory_factor,"ZZZ.ZZZ"))
writefile(l_dec,"%s","<033>&a2800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
l_base_rate = l_base_rate * agqpersonal2:territory_factor
writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
writefile(l_dec,"%s","<NL>")

Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Tier Rating Factor:")
writefile(l_dec,"%s","<033>&a1800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
writefile(l_dec,"%s",str(agqpersonal2:credit_score_factor,"ZZZ.ZZZ"))
writefile(l_dec,"%s","<033>&a2800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
l_base_rate = l_base_rate * agqpersonal2:credit_score_factor
writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
writefile(l_dec,"%s","<NL>")

Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Deductible Factor:")
writefile(l_dec,"%s","<033>&a1800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
writefile(l_dec,"%s",str(agqpersonal2:deductible_factor,"ZZZ.ZZZ"))
writefile(l_dec,"%s","<033>&a2800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
l_base_rate = l_base_rate * agqpersonal2:deductible_factor
writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
writefile(l_dec,"%s","<NL>")

Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Wind Deductible Factor:")
writefile(l_dec,"%s","<033>&a1800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
writefile(l_dec,"%s",str(agqpersonal2:wind_deductible_factor,"ZZZ.ZZZ"))
writefile(l_dec,"%s","<033>&a2800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
l_base_rate = l_base_rate * agqpersonal2:wind_deductible_factor
writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
writefile(l_dec,"%s","<NL>")

Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Hurricane Factor:")
writefile(l_dec,"%s","<033>&a1800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
writefile(l_dec,"%s",str(agqpersonal2:Hurricane_factor,"ZZZ.ZZZ"))
writefile(l_dec,"%s","<033>&a2800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
l_base_rate = l_base_rate * agqpersonal2:hurricane_factor
writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
writefile(l_dec,"%s","<NL>")

if agqpersonal:form one of 6 then
    begin
    Writefile(l_dec,"%s",l_arial)
    writefile(l_dec,"%s","<033>&a300h+0V")
    writefile(l_dec,"%s","Rented Condo Factor:")
    writefile(l_dec,"%s","<033>&a1800h+0V")
    Writefile(l_dec,"%s",l_letter_gothic_bold_10)
    writefile(l_dec,"%s",str(agqpersonal2:rented_condo_factor,"ZZZ.ZZZ"))
    writefile(l_dec,"%s","<033>&a2800h+0V")
    Writefile(l_dec,"%s",l_letter_gothic_bold_10)
    l_base_rate = l_base_rate * agqpersonal2:rented_condo_factor
    writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
    writefile(l_dec,"%s","<NL>")
    end

Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Coastal Tier Factor:")
writefile(l_dec,"%s","<033>&a1800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
writefile(l_dec,"%s",str(agqpersonal2:tier_factor,"ZZZ.ZZZ"))
writefile(l_dec,"%s","<033>&a2800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
l_base_rate = l_base_rate * agqpersonal2:tier_factor
writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
writefile(l_dec,"%s","<NL>")

Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Construction Factor:")
writefile(l_dec,"%s","<033>&a1800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
writefile(l_dec,"%s",str(agqpersonal2:construction_factor,"ZZZ.ZZZ"))
writefile(l_dec,"%s","<033>&a2800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
l_base_rate = l_base_rate * agqpersonal2:construction_factor
writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
writefile(l_dec,"%s","<NL>")

Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Fire Safe Factor:")
writefile(l_dec,"%s","<033>&a1800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
writefile(l_dec,"%s",str(agqpersonal2:fire_safe_factor,"ZZZ.ZZZ"))
writefile(l_dec,"%s","<033>&a2800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
l_base_rate = l_base_rate * agqpersonal2:fire_safe_factor
writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
writefile(l_dec,"%s","<NL>")

Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Fire Alarm Central Station:")
writefile(l_dec,"%s","<033>&a1800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
if agqpersonal2:alarm_factor[1] <> 0 then
    begin
    writefile(l_dec,"%s",str(agqpersonal2:alarm_factor[1],"ZZZ.ZZZ"))
    l_base_rate = l_base_rate * agqpersonal2:alarm_factor[1]
    end
else
    begin
    writefile(l_dec,"%s","  1.000")
    l_base_rate = l_base_rate * 1.000
    end
writefile(l_dec,"%s","<033>&a2800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
writefile(l_dec,"%s","<NL>")

Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Fire Reporting to Fire Station:")
writefile(l_dec,"%s","<033>&a1800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
if agqpersonal:alarm_factor[3] <> 0 then
    begin
    writefile(l_dec,"%s",str(agqpersonal2:alarm_factor[3],"ZZZ.ZZZ"))
    l_base_rate = l_base_rate * agqpersonal2:alarm_factor[3]
    end
else
    begin
    writefile(l_dec,"%s","  1.000")
    l_base_rate = l_base_rate * 1.000
    end
writefile(l_dec,"%s","<033>&a2800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
writefile(l_dec,"%s","<NL>")

Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Fire Local Alarm:")
writefile(l_dec,"%s","<033>&a1800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
if agqpersonal2:alarm_factor[5] <> 0 then
    begin
    writefile(l_dec,"%s",str(agqpersonal2:alarm_factor[5],"ZZZ.ZZZ"))
    l_base_rate = l_base_rate * agqpersonal2:alarm_factor[5]
    end
else
    begin
    writefile(l_dec,"%s","  1.000")
    l_base_rate = l_base_rate * 1.000
    end
writefile(l_dec,"%s","<033>&a2800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
writefile(l_dec,"%s","<NL>")

Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Automatic Sprinkler System:")
writefile(l_dec,"%s","<033>&a1800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
if agqpersonal2:alarm_factor[6] <> 0 then
    begin
    writefile(l_dec,"%s",str(agqpersonal2:alarm_factor[6],"ZZZ.ZZZ"))
    l_base_rate = l_base_rate * agqpersonal2:alarm_factor[6]
    end
else
    begin
    writefile(l_dec,"%s","  1.000")
    l_base_rate = l_base_rate * 1.000
    end
writefile(l_dec,"%s","<033>&a2800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
writefile(l_dec,"%s","<NL>")

Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Theft Reporting to Central Station:")
writefile(l_dec,"%s","<033>&a1800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
if agqpersonal2:alarm_factor[2] <> 0 then
    begin
    writefile(l_dec,"%s",str(agqpersonal2:alarm_factor[2],"ZZZ.ZZZ"))
    l_base_rate = l_base_rate * agqpersonal2:alarm_factor[2]
    end
else
    begin
    writefile(l_dec,"%s","  1.000")
    l_base_rate = l_base_rate * 1.000
    end
writefile(l_dec,"%s","<033>&a2800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
writefile(l_dec,"%s","<NL>")

Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Theft Reporting to Police Station:")
writefile(l_dec,"%s","<033>&a1800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
if agqpersonal2:alarm_factor[4] <> 0 then
    begin
    writefile(l_dec,"%s",str(agqpersonal2:alarm_factor[4],"ZZZ.ZZZ"))
    l_base_rate = l_base_rate * agqpersonal2:alarm_factor[4]
    end
else
    begin
    writefile(l_dec,"%s","  1.000")
    l_base_rate = l_base_rate * 1.000
    end
writefile(l_dec,"%s","<033>&a2800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
writefile(l_dec,"%s","<NL>")

Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Local Theft Alarm:")
writefile(l_dec,"%s","<033>&a1800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
if agqpersonal2:alarm_factor[7] <> 0 then
    begin
    writefile(l_dec,"%s",str(agqpersonal2:alarm_factor[7],"ZZZ.ZZZ"))
    l_base_rate = l_base_rate * agqpersonal2:alarm_factor[7]
    end
else
    begin
    writefile(l_dec,"%s","  1.000")
    l_base_rate = l_base_rate * 1.000
    end
writefile(l_dec,"%s","<033>&a2800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
writefile(l_dec,"%s","<NL>")

Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Dead Bolts:")
writefile(l_dec,"%s","<033>&a1800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
if agqpersonal2:alarm_factor[8] <> 0 then
    begin
    writefile(l_dec,"%s",str(agqpersonal2:alarm_factor[8],"ZZZ.ZZZ"))
    l_base_rate = l_base_rate * agqpersonal2:alarm_factor[8]
    end
else
    begin
    writefile(l_dec,"%s","  1.000")
    l_base_rate = l_base_rate * 1.000
    end
writefile(l_dec,"%s","<033>&a2800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
writefile(l_dec,"%s","<NL>")

if agqpersonal:form not one of 4 then
    begin
    Writefile(l_dec,"%s",l_arial)
    writefile(l_dec,"%s","<033>&a300h+0V")
    writefile(l_dec,"%s","Age Factor:")
    writefile(l_dec,"%s","<033>&a1800h+0V")
    Writefile(l_dec,"%s",l_letter_gothic_bold_10)
    writefile(l_dec,"%s",str(agqpersonal2:age_factor,"ZZZ.ZZZ"))
    writefile(l_dec,"%s","<033>&a2800h+0V")
    Writefile(l_dec,"%s",l_letter_gothic_bold_10)
    l_base_rate = l_base_rate * agqpersonal2:age_factor
    writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
    writefile(l_dec,"%s","<NL>")
    end

if agqpersonal:form one of 4, 6 then
    begin
    Writefile(l_dec,"%s",l_arial)
    writefile(l_dec,"%s","<033>&a300h+0V")
    writefile(l_dec,"%s","No Units Factor:")
    writefile(l_dec,"%s","<033>&a1800h+0V")
    Writefile(l_dec,"%s",l_letter_gothic_bold_10)
    writefile(l_dec,"%s",str(agqpersonal2:no_units_factor,"ZZZ.ZZZ"))
    writefile(l_dec,"%s","<033>&a2800h+0V")
    Writefile(l_dec,"%s",l_letter_gothic_bold_10)
    l_base_rate = l_base_rate * agqpersonal2:no_units_factor
    writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
    writefile(l_dec,"%s","<NL>")
    end

if agqpersonal:form one of 3 then
    begin
    Writefile(l_dec,"%s",l_arial)
    writefile(l_dec,"%s","<033>&a300h+0V")
    writefile(l_dec,"%s","No Bathrooms Factor:")
    writefile(l_dec,"%s","<033>&a1800h+0V")
    Writefile(l_dec,"%s",l_letter_gothic_bold_10)
    writefile(l_dec,"%s",str(agqpersonal2:bathroom_factor,"ZZZ.ZZZ"))
    writefile(l_dec,"%s","<033>&a2800h+0V")
    Writefile(l_dec,"%s",l_letter_gothic_bold_10)
    l_base_rate = l_base_rate * agqpersonal2:bathroom_factor
    writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
    writefile(l_dec,"%s","<NL>")

    Writefile(l_dec,"%s",l_arial)
    writefile(l_dec,"%s","<033>&a300h+0V")
    writefile(l_dec,"%s","No Stories Factor:")
    writefile(l_dec,"%s","<033>&a1800h+0V")
    Writefile(l_dec,"%s",l_letter_gothic_bold_10)
    writefile(l_dec,"%s",str(agqpersonal2:stories_factor,"ZZZ.ZZZ"))
    writefile(l_dec,"%s","<033>&a2800h+0V")
    Writefile(l_dec,"%s",l_letter_gothic_bold_10)
    l_base_rate = l_base_rate * agqpersonal2:stories_factor
    writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
    writefile(l_dec,"%s","<NL>")

    Writefile(l_dec,"%s",l_arial)
    writefile(l_dec,"%s","<033>&a300h+0V")
    writefile(l_dec,"%s","Wood Stove Factor:")
    writefile(l_dec,"%s","<033>&a1800h+0V")
    Writefile(l_dec,"%s",l_letter_gothic_bold_10)
    writefile(l_dec,"%s",str(agqpersonal2:wood_stove_factor,"ZZZ.ZZZ"))
    writefile(l_dec,"%s","<033>&a2800h+0V")
    Writefile(l_dec,"%s",l_letter_gothic_bold_10)
    l_base_rate = l_base_rate * agqpersonal2:wood_stove_factor
    writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
    writefile(l_dec,"%s","<NL>")

    Writefile(l_dec,"%s",l_arial)
    writefile(l_dec,"%s","<033>&a300h+0V")
    writefile(l_dec,"%s","Roof Type Factor:")
    writefile(l_dec,"%s","<033>&a1800h+0V")
    Writefile(l_dec,"%s",l_letter_gothic_bold_10)
    writefile(l_dec,"%s",str(agqpersonal2:roof_type_factor,"ZZZ.ZZZ"))
    writefile(l_dec,"%s","<033>&a2800h+0V")
    Writefile(l_dec,"%s",l_letter_gothic_bold_10)
    l_base_rate = l_base_rate * agqpersonal2:roof_type_factor
    writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
    writefile(l_dec,"%s","<NL>")

    Writefile(l_dec,"%s",l_arial)
    writefile(l_dec,"%s","<033>&a300h+0V")
    writefile(l_dec,"%s","LEED Certified Factor:")
    writefile(l_dec,"%s","<033>&a1800h+0V")
    Writefile(l_dec,"%s",l_letter_gothic_bold_10)
    writefile(l_dec,"%s",str(agqpersonal2:leed_certified_factor,"ZZZ.ZZZ"))
    writefile(l_dec,"%s","<033>&a2800h+0V")
    Writefile(l_dec,"%s",l_letter_gothic_bold_10)
    l_base_rate = l_base_rate * agqpersonal2:leed_certified_factor
    writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
    writefile(l_dec,"%s","<NL>")
    end

Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Companion Discount Factor:")
writefile(l_dec,"%s","<033>&a1800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
writefile(l_dec,"%s",str(agqpersonal2:companion_discount_factor,"ZZZ.ZZZ"))
writefile(l_dec,"%s","<033>&a2800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
l_base_rate = l_base_rate * agqpersonal2:companion_discount_factor
writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
writefile(l_dec,"%s","<NL>")

Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Loss Exp Factor:")
writefile(l_dec,"%s","<033>&a1800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
writefile(l_dec,"%s",str(agqpersonal2:loss_exp_factor,"ZZZ.ZZZ"))
writefile(l_dec,"%s","<033>&a2800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
l_base_rate = l_base_rate * agqpersonal2:loss_exp_factor
writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
writefile(l_dec,"%s","<NL>")

Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Each Addl Minor Factor:")
writefile(l_dec,"%s","<033>&a1800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
if agqpersonal2:minor_loss > 4 then
    begin
    writefile(l_dec,"%s",str(agqpersonal2:loss_each_addl_minor_factor,"ZZZ.ZZZ"))
    l_base_rate = l_base_rate * agqpersonal2:loss_each_addl_minor_factor
    end
else
    begin
    writefile(l_dec,"%s","  1.000")
    l_base_rate = l_base_rate * 1.000
    end
writefile(l_dec,"%s","<033>&a2800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
writefile(l_dec,"%s","<NL>")

Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Each Addl Major Factor:")
writefile(l_dec,"%s","<033>&a1800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
if agqpersonal2:major_loss > 4 then
    begin
    writefile(l_dec,"%s",str(agqpersonal2:loss_each_addl_major_factor,"ZZZ.ZZZ"))
    l_base_rate = l_base_rate * agqpersonal2:loss_each_addl_major_factor
    end
else
    begin
    writefile(l_dec,"%s","  1.000")
    l_base_rate = l_base_rate * 1.000
    end
writefile(l_dec,"%s","<033>&a2800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
writefile(l_dec,"%s","<NL>")

Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Tenure Discount Factor:")
writefile(l_dec,"%s","<033>&a1800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
writefile(l_dec,"%s",str(agqpersonal2:tenure_factor,"ZZZ.ZZZ"))
writefile(l_dec,"%s","<033>&a2800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
l_base_rate = l_base_rate * agqpersonal2:tenure_factor
writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
writefile(l_dec,"%s","<NL>")

if agqpersonal:form not one of 4 then
    begin
    Writefile(l_dec,"%s",l_arial)
    writefile(l_dec,"%s","<033>&a300h+0V")
    writefile(l_dec,"%s","Original Owner Factor:")
    writefile(l_dec,"%s","<033>&a1800h+0V")
    Writefile(l_dec,"%s",l_letter_gothic_bold_10)
    writefile(l_dec,"%s",str(agqpersonal2:original_owner_factor,"ZZZ.ZZZ"))
    writefile(l_dec,"%s","<033>&a2800h+0V")
    Writefile(l_dec,"%s",l_letter_gothic_bold_10)
    l_base_rate = l_base_rate * agqpersonal2:original_owner_factor
    writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
    writefile(l_dec,"%s","<NL>")
    end

Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Loyalty Factor:")
writefile(l_dec,"%s","<033>&a1800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
writefile(l_dec,"%s",str(agqpersonal2:loyalty_factor,"ZZZ.ZZZ"))
writefile(l_dec,"%s","<033>&a2800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
l_base_rate = l_base_rate * agqpersonal2:loyalty_factor
writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
writefile(l_dec,"%s","<NL>")

Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","New Customer Discount Factor:")
writefile(l_dec,"%s","<033>&a1800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
writefile(l_dec,"%s",str(agqpersonal2:new_cust_dis_factor,"ZZZ.ZZZ"))
writefile(l_dec,"%s","<033>&a2800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
l_base_rate = l_base_rate * agqpersonal2:new_cust_dis_factor
writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
writefile(l_dec,"%s","<NL>")

Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Replacement Cost MPL47/MPL49:")
writefile(l_dec,"%s","<033>&a1800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
writefile(l_dec,"%s",str(agqpersonal2:replacement_code_factor,"ZZZ.ZZZ"))
writefile(l_dec,"%s","<033>&a2800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
l_base_rate = l_base_rate * agqpersonal2:replacement_code_factor
writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
writefile(l_dec,"%s","<NL>")

if agqpersonal:form one of 3 then
    begin
    Writefile(l_dec,"%s",l_arial)
    writefile(l_dec,"%s","<033>&a300h+0V")
    writefile(l_dec,"%s","Extended Cause of Loss (MPL18):")
    writefile(l_dec,"%s","<033>&a1800h+0V")
    Writefile(l_dec,"%s",l_letter_gothic_bold_10)
    writefile(l_dec,"%s",str(agqpersonal2:mpl18_factor,"ZZZ.ZZZ"))
    writefile(l_dec,"%s","<033>&a2800h+0V")
    Writefile(l_dec,"%s",l_letter_gothic_bold_10)
    l_base_rate = l_base_rate * agqpersonal2:mpl18_factor
    writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
    writefile(l_dec,"%s","<NL>")
    end

if agqpersonal:form one of 3 then
    begin
    Writefile(l_dec,"%s",l_arial)
    writefile(l_dec,"%s","<033>&a300h+0V")
    writefile(l_dec,"%s","Special Replacement (MPL79):")
    writefile(l_dec,"%s","<033>&a1800h+0V")
    Writefile(l_dec,"%s",l_letter_gothic_bold_10)
    writefile(l_dec,"%s",str(agqpersonal2:mpl79_factor,"ZZZ.ZZZ"))
    writefile(l_dec,"%s","<033>&a2800h+0V")
    Writefile(l_dec,"%s",l_letter_gothic_bold_10)
    l_base_rate = l_base_rate * agqpersonal2:mpl79_factor
    writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
    writefile(l_dec,"%s","<NL>")
    end

if agqpersonal:form not one of 4 then
    begin
    Writefile(l_dec,"%s",l_arial)
    writefile(l_dec,"%s","<033>&a300h+0V")
    writefile(l_dec,"%s","Building Code Factor (MPL44):")
    writefile(l_dec,"%s","<033>&a1800h+0V")
    Writefile(l_dec,"%s",l_letter_gothic_bold_10)
    writefile(l_dec,"%s",str(agqpersonal2:mpl44_building_code_factor,"ZZZ.ZZZ"))
    writefile(l_dec,"%s","<033>&a2800h+0V")
    Writefile(l_dec,"%s",l_letter_gothic_bold_10)
    l_base_rate = l_base_rate * agqpersonal2:mpl44_building_code_factor
    writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
    writefile(l_dec,"%s","<NL>")
    end

Writefile(l_dec,"%s",l_arial)
writefile(l_dec,"%s","<033>&a300h+0V")
writefile(l_dec,"%s","Expense Fee:")
writefile(l_dec,"%s","<033>&a1800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
writefile(l_dec,"%s",str(agqpersonal2:expense_fee,"ZZZ.ZZZ"))
writefile(l_dec,"%s","<033>&a2800h+0V")
Writefile(l_dec,"%s",l_letter_gothic_bold_10)
l_base_rate = l_base_rate + agqpersonal2:expense_fee
writefile(l_dec,"%s",str(l_base_rate,"ZZZZ.ZZZ"))
writefile(l_dec,"%s","<NL>")
end

end

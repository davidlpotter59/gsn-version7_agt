%% 
/*
Date Written: May, 25, 2005

Name: agqmso9104.sd

Copyright (c) 2000, SCIPS.com Inc.

Modify
Date                   By                  Comment
--------------------------------------------------------------
05/25/2005            REL/DWR     Initial setup - Quote Letter
09/01/2005            DWR         Flemington Qoute #187 changes made
--------------------------------------------------------------
*/
  Program
  Name = "agqmso9104" ;
  Type = "File" ;
  Domain = "flat";
  Padcharacter = Space ;

  String L_FILE_NAME[13] = "agqmso9104.cq" ;
  String L_quote_DECLARATION[100],
         l_app_no_str[11];
  wdate l_eff_hurricanezip ;
  unsigned ascii number l_app_no[11];
  unsigned ascii number l_agent_no[4] ;
 -- String L_STRING[150];
  String L_STATE;
  signed ascii number l_windstorm_surcharge[4] ;
  string l_font[35] ;
  String L_ALPHA_POLICY_NO = "";
  String L_PRINT_STRING[40];  --used for prtection device phrases
  String L_LOB_CODE[10];
  String L_PREV_STRING[50];
  String L_COMPANY_ZIP[10];
  String L_STATE_STR[2];
  String L_TYPE_STR[50];
  String L_TRANS_EFF; --= StR(L_MM_1) + "/" + STR(L_DD_1) + "/" + STR(L_YY_1)
  String L_AUDIT="";
  String L_SYMBOL_STRING[5] ="";
  String L_AGENT_TEL;
  String L_COMPANY_ID[10]="";
  String L_COMPANY[10]="";
  String L_COPY_NAME[20];
  string l_mpl01[1]="Y" ;
  String L_agqLOCATION_ZIP;
  String L_SFSMORT_ZIP;
  String L_agqSUPP_ZIP;
  String L_MORTGAGE_ID[10];
  String L_agqNAME_ZIP = "";
  String L_FOB[75];
  String L_ENTER;
  String L_AGENT_ZIP;
  String L_BILL_PLAN[2];
  String L_MORTGAGE_TYPE_1[1];
  String L_INSURED_CITY_STATE[50];
  String L_SFSLINE_DESCRIPTION[90];
  String L_MORTGAGE_TYPE_2[1];
  String L_USER_ID[15];
  String L_VERT_POS_1[5];
  String L_VERT_POS_2[5];
  Number L_TRANS_CODE;
  Number L_PAGE_NUMBER = 0;
  Number L_RENEWAL[9];
  Number L_MM_1;
  Number L_DD_1;
  Number L_YY_1;
  Number L_LOOP =0;   -- used to loop though the copies.
  Number L_SWITCH_COL_COUNTER = 1;

  signed ascii number l_palisades_credit[4];
    signed ascii number l_ifa_credit[4] ;
  unsigned ascii number l_prem_no_1[4];
  unsigned ascii number l_build_no_1[4];
  unsigned ascii number l_policy_surcharge[3]=0/dec=2 ;
  unsigned ascii number l_policy_percent[2]=0 ;
  Unsigned Ascii Number L_FIRST_MANDATORY_ENDORSEMENT = 0;
  Unsigned ascii number l_print_on_back[1];
  unsigned ascii number l_print_on_front[1];
  Unsigned Ascii Number L_MAX_LINES=57;
  Unsigned Ascii Number L_COUNTER;  --counter for protection devices
  Unsigned Ascii Number L_TOTAL_CREDIT[4]/decimals=2;  --total credit for protection devices
  Unsigned Ascii Number L_CREDIT[4]/decimals=2;        -- current credit used to find decimal
  Unsigned Ascii Number L_DECIPOINT;
  Unsigned Ascii Number L_CHARACTER_PER_INCH;
--  Unsigned Ascii Number L_LEN_STRING;
  Unsigned Ascii Number L_PAGE_MIDDLE;
  Unsigned Ascii Number L_HALF_MULTIPLIER;
  Unsigned Ascii Number L_CHAR_MULTIPLIER[10]/decimals=4;
  Unsigned Ascii Number L_LINE_COUNTER = 1;  --line counter per page
  Unsigned Ascii Number L_LINE_TPCOUNTER = 58; --total line on a page
  Unsigned Ascii Number L_POLICY_NUM[9];
  Unsigned Ascii Number L_POL_YEAR[4];
  Unsigned Ascii Number L_ENDORSEMENT_SEQ[4];
  Unsigned Ascii Number L_S_LINE_FOR_AGENT = 0; --start line for agenT
  Unsigned Ascii Number L_E_LINE_FOR_INSURED = 0;
  Unsigned Ascii Number L_BIGGER_LINE =0;
  Unsigned Ascii Number L_SCREEN_COR= 0;
  Unsigned Ascii Number L_LINE_OF_BUSINESS[4];
  Unsigned Ascii Number L_LESSOR_Y_N = 0;
  Unsigned Ascii Number L_LENGTH;
  Unsigned Ascii Number L_WIDTH;
  Unsigned Ascii Number L_HORZ_LOC;
  Unsigned Ascii Number L_VERT_LOC;
  Unsigned Ascii Number L_PRINT_IT;
  Unsigned Ascii Number L_AGENT_COUNTER;
  Unsigned Ascii Number L_INSURED_COUNTER;
  Unsigned Ascii Number L_LOCATION_COUNTER;
  Unsigned Ascii Number L_PAGENUMBER;
  Unsigned Ascii Number L_SIZE_COUNTER;
  Unsigned Ascii Number L_PRINTER_NO[4];
  Unsigned Ascii Number L_LINE_HEIGHT;
  Unsigned Ascii Number L_MDL1[1];  --set to yes if chosen in option endorsements
  unsigned ascii number l_mpl03[1];
  Unsigned Ascii Number L_NUM_FORMS = 0;  -- nUmber of forms to print on dec
                                          -- done to make sure I can print them
                                      -- all on the same page as the signature.

  /* Added 11/13/2003 for CCMI chaging premium form */
  Unsigned ascii number l_prev_premium[9]=0,
                      l_current_premium[9]=0,
                      l_bullet_counter = 0,
                      l_prev_year[4] = 0;

  String L_WATER_DAMAGE_WORDING;
  String L_PLEASED_WORDING[200];
  String L_SIGNATURE_STRING[100];
  String L_AGENT_LABEL[25];
  String L_GENERAL_AGENT_NAME[50];
  String L_PRODUCER_LABEL;
  Unsigned Ascii Number L_MASTER_CODE[4];
  Wdate L_MESSAGE_EFF_DATE;
  Wdate L_MESSAGE_EXP_DATE;
  String L_FONT_1[25];
String L_FONT_2[25];
String L_FONT_3[25];
String L_FONT_4[25];
String L_FONT_5[25];
String L_FONT_6[25];
String L_CITY_STATE_ZIP[150];
String L_DEC_HEADER_FONT[25];
String L_FONT_TO_USE[25];

Unsigned Ascii Number L_HEADER_LOOP[1];
String L_STRING[150];
--String L_FONT[35];
String L_VERTICAL_POS;
String L_HORIZONTAL_POS;
--String L_NEWPAGE_WORDING[10];
Unsigned Ascii Number L_PITCH_HALF/decimals=1;
Unsigned Ascii Number L_PITCH_FULL;

  Include "CSFONTS.inc"
  Include "SFSREVNAME.var"
  Include "SWSUT100.var"
  Include "line_spacing.var"
--  Include "header.var"

Initialisation
  Deletefile(L_FILE_NAME);   --house cleaning making sure file is removed
                             --before each run
  L_app_no = val(COMMANDLINE[1,11])

  Access agqPERSONAL,
     Set agqPERSONAL:app_no = L_app_no,generic

  Access agqNAME,
     Set agqNAME:app_no = l_app_no,exact

  Access agqLOCATION,
     Set agqLOCATION:app_no = L_app_no,generic

  l_company_id = agqpersonal:company_id
  l_agent_no   = agqpersonal:agent_no
  Access SFSAGENT ,
     Set SFSAGENT:COMPANY_ID = l_company_id,
         SFSAGENT:AGENT_NO   = l_AGENT_NO, generic

  Access SFSCOMPANY,
     Set SFSCOMPANY:COMPANY_ID = agqpersonal:COMPANY_ID , generic

  access agqtotals, set agqtotals:app_no     = agqpersonal:app_no,
                        agqtotals:prem_no    = l_prem_no_1,
                        agqtotals:build_no   = l_build_no_1,
                        agqtotals:deductible = agqpersonal:deductible, generic

  Access SFSLINE,
     Set SFSLINE:COMPANY_ID       = agqpersonal:COMPANY_ID ,
         SFSLINE:LINE_OF_BUSINESS = agqpersonal:LINE_OF_BUSINESS,
         SFSLINE:LOB_SUBLINE      = "00", Exact

  Access agqMASTER,
     Set agqMASTER:app_no     = l_app_no, exact

  Access agqSUPP,
     Set agqSUPP:app_no     = L_app_no, generic

  Access SFSMORT,
     Set SFSMORT:COMPANY_ID   = agqpersonal:company_id,
         SFSMORT:MORTGAGE_ID  = L_MORTGAGE_ID,  Exact

  Access agqENDORSE1,
     Set agqENDORSE1:app_no  = L_app_no, generic

  Access agqEND,
     Set agqEND:app_no      = L_app_no ,generic

  Access SFSSTATE,
     Set SFSSTATE:COMPANY_ID  = agqPERSONAL:COMPANY_ID,
         SFSSTATE:STATE       = agqPERSONAL:STATE,
         SFSSTATE:COUNTY      = agqPERSONAL:COUNTY, Exact

--Update
  L_COMPANY = agqpersonal:company_id
  l_LINE_OF_BUSINESS = agqpersonal:line_of_business
  L_USER_ID = USERNAME  -- getting current user name
--  L_PRINTER_NO = agqprint1:user_printer   --converting l_printer to the number

  Access SFSPRINTER,
     Set SFSPRINTER:COMPANY_ID = L_COMPANY_ID,
         SFSPRINTER:USER_ID    = L_USER_ID,
         SFSPRINTER:PRINTER_NO = L_PRINTER_NO, Exact

  L_COMPANY_ZIP =  If (Val(SFSCOMPANY:STR_ZIPCODE[6,9]) = 0) Then
                     SFSCOMPANY:STR_ZIPCODE[1,5]
                   Else
                     SFSCOMPANY:STR_ZIPCODE[1,5] + "-" + SFSCOMPANY:STR_ZIPCODE[6,9]

  L_TRANS_CODE       = agqMASTER:TRANS_CODE
  L_AGENT_TEL        = SFSAGENT:TELEPHONE[1];
  L_PAGE_NUMBER      = 1
  L_PRINT_IT         = 0
  L_COMPANY_ID       = agqpersonal:company_id
  L_LINE_OF_BUSINESS = agqpersonal:line_of_business

  L_agqNAME_ZIP = If (Val(agqNAME:str_ZIPCODE[6,9]) = 0) Then
                    agqNAME:str_ZIPCODE[1,5]
                  Else
                    agqNAME:str_ZIPCODE[1,5] + "-" + agqNAME:str_ZIPCODE[6,9]

  L_AGENT_ZIP =  If (Val(SFSAGENT:STR_ZIPCODE[6,9]) = 0) Then
                    SFSAGENT:STR_ZIPCODE[1,5]
                  Else
                    SFSAGENT:STR_ZIPCODE[1,5] + "-" + SFSAGENT:STR_ZIPCODE[6,9]

  L_agqLOCATION_ZIP = If (Val(agqLOCATION:STR_ZIPCODE[6,9]) = 0) Then
                        agqLOCATION:STR_ZIPCODE[1,5]
                      Else
                        agqLOCATION:STR_ZIPCODE[1,5] + "-" +
                        agqLOCATION:STR_ZIPCODE[6,9]

  Switch(agqMASTER:FORM_OF_BUSINESS)
    Case 'C' : L_FOB = "Corporation"
    Case 'I' : L_FOB = "Individual"
    Case 'J' : L_FOB = "Joint Venture"
    Case 'O' : L_FOB = "Organization"
    Case 'P' : L_FOB = "Partnership"
    case 'L' : l_fob = "LLC"
    Case 'T' : L_FOB = agqMASTER:FOB_DESCRIPTION
  End

  if agqname:city <> "" then
      L_INSURED_CITY_STATE  = Trun(agqNAME:CITY) + ", " + agqNAME:STR_STATE + "  "
                                 + L_agqNAME_ZIP

  L_TRANS_CODE = agqMASTER:TRANS_CODE

  If (SFSLINE:LOB_CODE One Of "HOME") Then
    {
      L_SFSLINE_DESCRIPTION = "HOMEOWNERS"
    }
  Else
    {
      L_SFSLINE_DESCRIPTION = SFSLINE:DESCRIPTION
    }

L_LOB_CODE = SFSLINE:LOB_CODE
--I_STR_STATE = SFSCOMPANY:STR_STATE
----Include "swsut102.inc"
i_state = agqpersonal:state

Access SCIPSCONTROL,
   Set SCIPSCONTROL:COMPANY_ID          = L_COMPANY_ID,
       SCIPSCONTROL:STATE               = agqpersonal:state,
       SCIPSCONTROL:LOB_CODE            = L_LOB_CODE, Exact

access sfscontrol,
   set sfscontrol:company_id       = l_company_id,
       sfscontrol:state            = agqpersonal:state,
       sfscontrol:line_of_business = l_line_of_business, generic

while sfscontrol:company_id       = l_company_id and
      sfscontrol:state            = agqpersonal:state and
      sfscontrol:line_of_business = l_line_of_business
  begin
    if (agqpersonal:eff_date >= sfscontrol:eff_date and
       (agqpersonal:eff_date < sfscontrol:exp_date or
        sfscontrol:exp_date = 0)) then
      begin
        l_policy_surcharge = sfscontrol:policy_surcharge
      end
    next sfscontrol
  end

l_policy_percent = ((l_policy_surcharge * 100) - 100)


writefile(l_file_name,"%s",l_reset)
Writefile(L_FILE_NAME,"%s",L_LEDUP)
--border

Writefile(L_FILE_NAME,"%s",l_arial_bold_14)
L_STRING = trun(sfscompany:name[1])
L_FONT = L_ARIAL_BOLD_14
L_PITCH_HALF = 8
L_PITCH_FULL = 16
L_VERTICAL_POS = "+160"
Include "center2.pro"

If sfsprinter:tray[4] <> 0 or
   sfsprinter:tray[5] <> 0 then
  {
    If uppercase(L_COPY_NAME) = "ORIGINAL" then
      {
        Writefile(L_FILE_NAME,"%s%n%s","<033>&l",sfsprinter:tray[4],"H")
      }
    Else
      {
        Writefile(L_FILE_NAME,"%s%n%s","<033>&l",sfsprinter:tray[5],"H")
      }

  }-- Checks Scipscontrol to select paper tray for dec page.

if scipscontrol:quotation_lob_wording_change = 1 then
    begin
    L_PLEASED_WORDING = trun(sfsline:description)
    Writefile(L_FILE_NAME,"%s",l_arial_bold_14)
    L_STRING = L_PLEASED_WORDING
    L_FONT = L_ARIAL_BOLD_12
    L_PITCH_HALF = 6
    L_PITCH_FULL = 12
    L_VERTICAL_POS = "+160"
    Include "center2.pro"

    L_PLEASED_WORDING = "We are pleased to submit the following quotation to you."

    Writefile(L_FILE_NAME,"%s",l_arial_bold_14)
    L_STRING = L_PLEASED_WORDING
    L_FONT = L_ARIAL_BOLD_12
    L_PITCH_HALF = 6
    L_PITCH_FULL = 12
    L_VERTICAL_POS = "+160"
    Include "center2.pro"
    end
else
    begin
    L_PLEASED_WORDING = "We are pleased to submit the following " +
                        trun(sfsline:description) + " " + "quotation to you."

    Writefile(L_FILE_NAME,"%s",l_arial_bold_14)
    L_STRING = L_PLEASED_WORDING
    L_FONT = L_ARIAL_BOLD_12
    L_PITCH_HALF = 6
    L_PITCH_FULL = 12
    L_VERTICAL_POS = "+160"
    Include "center2.pro"
    end

L_LOB_CODE = SFSLINE:LOB_CODE
I_STR_STATE = SFSCOMPANY:STR_STATE
Include "swsut102.inc"

L_LINE_HEIGHT = 250
L_MAX_LINES = 60
L_SIZE_COUNTER = 0
L_LINE_COUNTER = 1
L_PAGENUMBER = 1
L_LOCATION_COUNTER = 1
L_INSURED_COUNTER = 0
L_AGENT_COUNTER = 0

L_LINE_HEIGHT = L_LINE_HEIGHT + 240

if agqpersonal:settlement_submission = 1 then
    Writefile(L_FILE_NAME,"%s%s%s",L_ARIAL_12,"<033>&a2000h+120V",
                          "SETTLEMENT SUBMISSION")
L_LINE_HEIGHT = L_LINE_HEIGHT + 120

Writefile(L_FILE_NAME,"%s%s%s%n",L_ARIAL_12,"<033>&a220h+240V",
                      "Application Number: ",L_app_no)

if agqsupp:mortgage_type_1 <> "" then
  {
    If SCIPSCONTROL:DONT_PRINT_PAYOR_CODE_ALL_COPY = 1 then
      {
        If SCIPSCONTROL:PAYOR_CODES = 1 and
           trun(uppercase(SCIPSCONTROL:PAY_CODE_COPY_NAME)) = trun(uppercase(L_COPY_NAME)) Then
          {
            do print_payor_codes
          }
      }
    Else
      If SCIPSCONTROL:PAYOR_CODES = 1 Then
        {
          do print_payor_codes
        }
  }



Writefile(L_FILE_NAME,"%s%s%s",L_ARIAL_12,"<033>&a220h+120V",
                      "Quote Number: ")   -- ",str(agqname:quote_no,"ZZZZZZZZ"))

If agqname:quote_no <> 0 then
  {
    Writefile(L_FILE_NAME,"%s%s%s",trun(L_ARIAL_BOLD_12),"Q",trun(str(agqname:quote_no)))
  }
Else
  {
    Writefile(L_FILE_NAME,"%s%s",trun(L_ARIAL_BOLD_9),"NOT CONVERTED")
  }


L_LINE_HEIGHT = L_LINE_HEIGHT + 120

If SCIPSCONTROL:AGENT_LABEL = "" Then
  {
    L_AGENT_LABEL = "Agent:"
  }
Else
  {
    L_AGENT_LABEL = SCIPSCONTROL:AGENT_LABEL
  }

Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%n%s","<NL>","<NL>",L_ARIAL_BOLD,
                      "<033>&a370h+0V","Applicant Name and Mailing Address",
                      "<033>&a3000h+0V",trun(L_AGENT_LABEL),"  ",
                      agqpersonal:AGENT_NO,"<NL>")

Writefile(L_FILE_NAME,"%s","<033>&f0S")   --push the cursor position on the stack
Writefile(L_FILE_NAME,"%s","<033>&f0S")   --used to see if agent or insured
                                          --name/address has more lines

L_LINE_HEIGHT = L_LINE_HEIGHT + 360
L_LINE_HEIGHT = L_LINE_HEIGHT + 360
L_LINE_COUNTER = (L_LINE_HEIGHT Div 120) + 2

Writefile(L_FILE_NAME,"%s",L_ARIAL)
For L_LOOP = 1 To 3
  {
    if agqname:name[l_loop] = "" then
        i_name = agqpersonal:business_name[l_loop]
    else
        I_NAME=agqname:name[l_loop]
    Include "sfsrevname7.pro"
    If i_name <> "" Then
      {
        Writefile(L_FILE_NAME,"%s%s%s","<033>&a370h+0V",I_REV_NAME,"<NL>")
        L_INSURED_COUNTER = L_INSURED_COUNTER +1
        L_LINE_COUNTER = L_LINE_COUNTER + 1
      }
  }
  For L_LOOP = 1 To 3
    {
      If (agqNAME:ADDRESS[L_LOOP] <> "") Then
        {
          Writefile(L_FILE_NAME,"%s%s%s","<033>&a370h+0V",agqNAME:ADDRESS[L_LOOP,1,40],"<NL>")
          L_INSURED_COUNTER = L_INSURED_COUNTER +1
          L_LINE_COUNTER = L_LINE_COUNTER + 1
        }
    }
Writefile(L_FILE_NAME,"%s%s%s","<033>&a370h+0V",L_INSURED_CITY_STATE,"<NL>")
L_INSURED_COUNTER = L_INSURED_COUNTER +1
L_LINE_COUNTER= L_LINE_COUNTER + 1

--START OF AGENT pRINTING
  Writefile(L_FILE_NAME,"%s","<033>&f1S")  --pop agent cursor postion off stack

  If SCIPSCONTROL:PRODUCER_LABEL One Of 1 Then
    {
      Access SFSAGENT, Set SFSAGENT:COMPANY_ID = agqpersonal:company_id,
                           SFSAGENT:AGENT_NO   = agqpersonal:AGENT_NO, Exact
      L_MASTER_CODE = SFSAGENT:AGENT_MASTER_CODE
      Access SFSAGENT, Set SFSAGENT:COMPANY_ID = agqpersonal:company_id,
                           SFSAGENT:AGENT_NO   = L_MASTER_CODE, Exact
      Writefile(L_FILE_NAME,"%s","<033>&a3000h+0V")
      Writefile(L_FILE_NAME,"%s",SFSAGENT:NAME[1])  --print outmaster agent code
      Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
      Writefile(L_FILE_NAME,"%s","<033>&a3000h+120V")
      Writefile(L_FILE_NAME,"%s",L_PRODUCER_LABEL)
      Writefile(L_FILE_NAME,"%s",L_ARIAL)
      Writefile(L_FILE_NAME,"%s","<NL>")
    }
--reaccessing producer agent

  Access SFSAGENT, Set SFSAGENT:COMPANY_ID = agqpersonal:company_id,
                       SFSAGENT:AGENT_NO   = agqpersonal:AGENT_NO, Exact
  For L_LOOP = 1 To 3
    {
      If SFSAGENT:NAME[L_LOOP] <> "" Then
        {
          Writefile(L_FILE_NAME,"%s%s%s","<033>&a3000h+0V",SFSAGENT:NAME[L_LOOP],"<NL>")
          L_LINE_COUNTER = L_LINE_COUNTER + 1
          l_agent_counter = l_agent_counter + 1
        }
    }
  For L_LOOP = 1 To 3
    {
      If SFSAGENT:ADDRESS[L_LOOP] <> "" Then
        {
          Writefile(L_FILE_NAME,"%s%s%s","<033>&a3000h+0V",SFSAGENT:ADDRESS[L_LOOP],"<NL>")
          L_LINE_COUNTER = L_LINE_COUNTER + 1
          l_agent_counter = l_agent_counter + 1
        }
    }
  Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s","<033>&a3000h+0V",Trun(SFSAGENT:CITY),", ",
                      SFSAGENT:STR_STATE," ",L_AGENT_ZIP,"<NL>")
  L_LINE_COUNTER= L_LINE_COUNTER + 1
  l_agent_counter = l_agent_counter + 1
  if l_agent_tel <> "" then
      Writefile(L_FILE_NAME,"%s%s%s%s %s-%s","<033>&a3000h+0V",
                           "(",L_AGENT_TEL[1,3],")",L_AGENT_TEL[4,6],
                            L_AGENT_TEL[7,10])
--  L_LINE_COUNTER= L_LINE_COUNTER
--  l_agent_counter = l_agent_counter + 2

Writefile(L_FILE_NAME,"%s","<033>&f1S")  --pop agent cursor postion off stack
  If l_agent_counter > l_insured_counter Then
    {
       For l_loop = 1 to l_agent_counter
         {
           Writefile(L_FILE_NAME,"%s","<NL>")
         }
    }
  Else
    {
       For l_loop = 1 to l_insured_counter
         {
           Writefile(L_FILE_NAME,"%s","<NL>")
         }

    }

--**********************************************************************
--putting in the QUOTE TERM LINE ON THE DEC PAGE

Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)

--Writefile(L_FILE_NAME,"%s","<033>&a300h+0V")
--Writefile(L_FILE_NAME,"%s","<033>&a200h+40V<033>*c5a217b0P")   --left vertical line
--Writefile(L_FILE_NAME,"%s","<033>&a5479h+0V<033>*c5a217b0P")   --right vertical line
--Writefile(L_FILE_NAME,"%s%s","<033>&a200h+0V<033>*c5289h5v0P","<NL>") --horizontal line for top of first box pg 1


Writefile(L_FILE_NAME,"%s","<033>&a220h+240V")
Writefile(L_FILE_NAME,"%s%s", "Quoted Term: ",trun(L_ARIAL))
Writefile(L_FILE_NAME,"%d%s%d",agqpersonal:EFF_DATE," to ",agqpersonal:EXP_DATE)


Writefile(L_FILE_NAME,"%s","<033>&a220h+120V")
Writefile(L_FILE_NAME,"%s%d","Quote Valid Until: ", todaysdate + 30)

Writefile(L_FILE_NAME,"%s%s","<NL>","<NL>")


--**********************************************************************

  L_LINE_COUNTER = L_LINE_COUNTER + 2

if agqpersonal:company_id = "FARMERS" and
   sfsline:lob_code one of "DWELLING" then
    begin
    If L_FOB one of "Corporation","Joint Venture","Partnership" then
        {
        Writefile(L_FILE_NAME,"%s%s%s%s%s%s",L_ARIAL_BOLD_9,"<033>&a200h+0V","You are a:",l_arial_9,
                              "<033>&a750h+0V",Uppercase(L_FOB))
        }
    Else
        {
        Writefile(L_FILE_NAME,"%s%s%s%s%s%s",L_ARIAL_BOLD_9,"<033>&a200h+0V","You are an:",l_arial_9,
                              "<033>&a730h+0V",Uppercase(L_FOB))
        }
    Writefile(L_FILE_NAME,"%s%s","<NL>","<NL>")
    end

Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
Writefile(L_FILE_NAME,"%s","<033>&a220h+0V")
Writefile(L_FILE_NAME,"%s","The")
If SFSLINE:LOB_CODE <> "DWELLING" Then
  {
    Writefile(L_FILE_NAME,"%s"," residence")
  }
Writefile(L_FILE_NAME,"%s"," premises covered by this quote is located at the")
Writefile(L_FILE_NAME,"%s%s"," above address unless otherwise stated:","<NL>")

L_LINE_COUNTER = L_LINE_COUNTER + 1
If (Uppercase(agqLOCATION:ADDRESS_SAME) <> "Y") Then
  {
    Writefile(L_FILE_NAME,"%s%s","<033>&a500h+0V",agqLOCATION:ADDRESS)
    For L_LOOP = 1 To 3
      {
        If (agqLOCATION:ADDRESS1[L_LOOP] <> "") Then
          {
            Writefile(L_FILE_NAME,"%s%s","<033>&a500h+120V",
                                  agqLOCATION:ADDRESS1[L_LOOP])
          }
      }
    Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s","<033>&a500h+120V",
                          Trun(agqLOCATION:CITY)," ",agqLOCATION:STR_STATE,
                          " ", L_agqLOCATION_ZIP,"<NL>")
  }

/*
L_LINE_COUNTER = L_LINE_COUNTER + 1
Writefile(L_FILE_NAME,"%s","<033>&a220h+0V")
Writefile(L_FILE_NAME,"%s","with all applicable quote provisions. The coverage ")
Writefile(L_FILE_NAME,"%s%s","afforded by this quote is subject","<nl>")
L_LINE_COUNTER = L_LINE_COUNTER + 1
Writefile(L_FILE_NAME,"%s","<033>&a220h+0V")
Writefile(L_FILE_NAME,"%s","to the conditions, limitations and exclusions of ")
Writefile(L_FILE_NAME,"%s%s","the following forms and endorsements.","<nl>")
L_LINE_COUNTER = L_LINE_COUNTER + 1
Writefile(L_FILE_NAME,"%s%s","<033>&a200h+40V<033>*c5289h5v0P","<NL>")
*/
                    --***Start of SECTION 1 COVERAGES***


--you are at +40 here > L_LINE_counter
L_LINE_COUNTER = L_LINE_COUNTER + 1
Writefile(L_FILE_NAME,"%s","<033>&a200h+0V<033>*c5a600b0P")   --left vertical line  second box on pg 1
Writefile(L_FILE_NAME,"%s","<033>&a5479h+0V<033>*c5a600b0P")   --right vertical line seond box on pg 1
Writefile(L_FILE_NAME,"%s%s","<033>&a200h+0V<033>*c5289h5v0P","<NL>") --horizontal line for top of second box pg 1
Writefile(L_FILE_NAME,"%s%s%s%s%s","<033>&a220h+0V",L_ARIAL_BOLD,
                      "SECTION I COVERAGES","<033>&a2600h+0V",
                      "LIMITS OF LIABILITY")
Writefile(L_FILE_NAME,"%s%s%s","<033>&a200h+40V<033>*c5289h5v0P","<NL>",
                      "<NL>") --horizontal line for bottom of second box pg 1

L_LINE_COUNTER = L_LINE_COUNTER + 1
If (agqPERSONAL:DWELLING_LIMIT = 0) Then
  {
    Writefile(L_FILE_NAME,"%s",L_ARIAL)
    Writefile(L_FILE_NAME,"%s","<033>&a220h+0V")
    Writefile(L_FILE_NAME,"%s","A. DWELLING")
    Writefile(L_FILE_NAME,"%s","<033>&a2600h+0V")
    Writefile(L_FILE_NAME,"%s","$")
    Writefile(L_FILE_NAME,"%s","<033>&a2900h+0V")
    Writefile(L_FILE_NAME,"%s",SCIPSCONTROL:BLANK_WORDING)
  }
Else
  {
    Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s",L_ARIAL,"<033>&a220h+0V",
                          "A. DWELLING","<033>&a2600h+0V","$",L_LETTER_GOTHIC_BOLD_12,
                          "<033>&a2650h+0V",
                          Str(agqPERSONAL:DWELLING_LIMIT,"ZZ,ZZZ,ZZZ"))
  }

if agqpersonal:replacement_acv = "A" and
   agqpersonal:company_id = "FARMERS" and
   sfsline:lob_code one of "DWELLING" and
   agqname:eff_date <= 11.31.2012 then
    {
    Writefile(L_FILE_NAME,"%s%s%s",L_ARIAL,"<033>&a3300h+0V",
                          "Actual Cash Value")
    }

writefile(l_file_name,"%s","<NL>")

L_LINE_COUNTER = L_LINE_COUNTER + 1
If (agqPERSONAL:FORM One Of 4,6) Or
   (agqPERSONAL:STRUCTURES_LIMIT[1] = 0) Then
  {
    Writefile(L_FILE_NAME,"%s%s%s",L_ARIAL,"<033>&a220h+0V",
                          "B. OTHER RELATED STRUCTURES")
    Writefile(L_FILE_NAME,"%s","<033>&a2600h+0V")
    Writefile(L_FILE_NAME,"%s","$")
    Writefile(L_FILE_NAME,"%s","<033>&a2900h+0V")
    Writefile(L_FILE_NAME,"%s%s",SCIPSCONTROL:BLANK_WORDING,"<NL>")
  }
Else
  {
    Writefile(L_FILE_NAME,"%s%s%s%S%s%s%s%s%s",L_ARIAL,"<033>&a220h+0V",
                          "B. OTHER RELATED STRUCTURES","<033>&a2600h+0V",
                          "$",L_LETTER_GOTHIC_BOLD_12,
                          "<033>&a2650h+0V",
                          Str(agqPERSONAL:STRUCTURES_LIMIT[1],"ZZ,ZZZ,ZZZ"),"<NL>")
  }

L_LINE_COUNTER = L_LINE_COUNTER + 1

If (agqPERSONAL:CONTENTS_LIMIT = 0) Then
  {
    Writefile(L_FILE_NAME,"%s",L_ARIAL)
    Writefile(L_FILE_NAME,"%s","<033>&a220h+0V")
    Writefile(L_FILE_NAME,"%s","C. ")
    Writefile(L_FILE_NAME,"%s",SCIPSCONTROL:SECTION1_COVERAGE_C)
    Writefile(L_FILE_NAME,"%s","<033>&a2600h+0V")
    Writefile(L_FILE_NAME,"%s","$")
    Writefile(L_FILE_NAME,"%s","<033>&a2900h+0V")
    Writefile(L_FILE_NAME,"%s%s",SCIPSCONTROL:BLANK_WORDING,"<NL>")
  }
Else
  {
    Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s",L_ARIAL,"<033>&a220h+0V",
                          "C. ",SCIPSCONTROL:SECTION1_COVERAGE_C,
                          "<033>&a2600h+0V",
                          "$",L_LETTER_GOTHIC_BOLD_12,"<033>&a2650h+0V",
                          Str(agqPERSONAL:CONTENTS_LIMIT,"ZZ,ZZZ,ZZZ"),"<NL>")
  }
L_LINE_COUNTER = L_LINE_COUNTER + 1
If (agqPERSONAL:LOSS_RENTS_LIMIT = 0) Then
  {
    Writefile(L_FILE_NAME,"%s",L_ARIAL)
    Writefile(L_FILE_NAME,"%s","<033>&a220h+0V")
    Writefile(L_FILE_NAME,"%s","D. LOSS OF USE")
    Writefile(L_FILE_NAME,"%s","<033>&a2600h+0V")
    Writefile(L_FILE_NAME,"%s","$")
    Writefile(L_FILE_NAME,"%s","<033>&a2900h+0V")
    Writefile(L_FILE_NAME,"%s%s",SCIPSCONTROL:BLANK_WORDING,"<NL>")
  }
Else
  {
    Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s",L_ARIAL,"<033>&a220h+0V",
                          "D. LOSS OF USE","<033>&a2600h+0V","$",L_LETTER_GOTHIC_BOLD_12,
                          "<33>&a2650h+0V",Str(agqPERSONAL:LOSS_RENTS_LIMIT,"ZZ,ZZZ,ZZZ"),"<NL>")
  }
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s%s","<033>&a200h+0V<033>*c5289h5v0P",
                      "<NL>")  --HORZ LINE section I coverage PG. 1
L_LINE_COUNTER = L_LINE_COUNTER + 1
Writefile(L_FILE_NAME,"%s%s%s%s",L_ARIAL_BOLD,"<033>&a220h-0V",
                      "DEDUCTIBLE(S) - SECTION I","<NL>")
Writefile(L_FILE_NAME,"%s%s","<033>&a200h-60V<033>*c5289h5v0P",
                      "<NL>")  --HORZ LINE section I coverage PG. 1
L_LINE_COUNTER = L_LINE_COUNTER + 1
Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s",L_ARIAL_9,"<033>&a220h-0V",
                      "Each claim for loss under Section I of this quote ",
                      "shall be adjusted separately and from each claim ","$",
                      trun(L_LETTER_GOTHIC_BOLD_12),trun(str(agqPERSONAL:DEDUCTIBLE)),trun(L_ARIAL_9))
Writefile(L_FILE_NAME,"%s%s"," shall be deducted.","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1

-----Beginning of Hurricane Deductible section----
l_company_id = agqpersonal:company_id
l_line_of_business = agqpersonal:line_of_business
Access sfshurricane,
   Set sfshurricane:COMPANY_ID           = l_company_id,
       sfshurricane:STATE                = agqpersonal:STATE,
       sfshurricane:LINE_OF_BUSINESS     = l_LINE_OF_BUSINESS,
       sfshurricane:tier                 = agqpersonal:tier,
       sfshurricane:hurricane_deductible = agqpersonal:hurricane_deductible, generic

If (agqpersonal:eff_date >= sfshurricane:eff_date and
   (agqpersonal:eff_date < sfshurricane:exp_date or
    sfshurricane:exp_date = 0)) then
  {
    L_eff_hurricanezip = sfshurricane:eff_date
  }

Access sfshurricane,
   Set sfshurricane:COMPANY_ID           = l_company_id,
       sfshurricane:STATE                = agqpersonal:STATE,
       sfshurricane:LINE_OF_BUSINESS     = L_LINE_OF_BUSINESS,
       sfshurricane:tier                 = agqpersonal:tier,
       sfshurricane:hurricane_deductible = agqpersonal:hurricane_deductible,
       sfshurricane:eff_date             = l_eff_hurricanezip, generic

Access SCIPSCONTROL1,
   Set SCIPSCONTROL1:COMPANY_ID = L_COMPANY_ID,
       SCIPSCONTROL1:STATE      = agqpersonal:state,
       SCIPSCONTROL1:LOB_CODE   = L_LOB_CODE, Exact

if agqpersonal:eff_date >= SCIPSControl1:hurricane_eff_date and
   agqpersonal:company_id = "FARMERS" then
  {
    if sfshurricane:hurricane_deductible > 0 then
      {
        Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
        Writefile(L_FILE_NAME,"%s","<033>&a220h+120V")
        Writefile(L_FILE_NAME,"%s",trun(scipscontrol1:hurricane_wording[1]))
        Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
        Writefile(L_FILE_NAME,"%s",trun(str(sfshurricane:hurricane_deductible,"ZZ%")))
        Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_BOLD_9))
        Writefile(L_FILE_NAME,"%s","<033>&a+0h+0V")
        Writefile(L_FILE_NAME,"%s",trun(scipscontrol1:hurricane_wording[2]))
      }
    else
      {
        Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
        Writefile(L_FILE_NAME,"%s","<033>&a220h+120V")
        Writefile(L_FILE_NAME,"%s",trun(scipscontrol1:hurricane_wording[3]))
      }
    Writefile(L_FILE_NAME,"%s","<033>&a220h+40V")
  }

---end of Hurricane Deductible

Writefile(L_FILE_NAME,"%s","<033>&a200h+0V<033>*c5a240b0P")   --left vertical line  second box on pg 1
Writefile(L_FILE_NAME,"%s","<033>&a5479h+0V<033>*c5a240b0P")   --right vertical line seond box on pg 1
L_LINE_COUNTER = L_LINE_COUNTER + 1
Writefile(L_FILE_NAME,"%s%s","<033>&a200h+0V<033>*c5289h5v0P",
                      "<NL>")  --HORZ LINE deductible section I coverage PG. 1
Writefile(L_FILE_NAME,"%s%s%s%s%s","<033>&a220h-0V",L_ARIAL_BOLD,
                      "SECTION II COVERAGES","<033>&a2600h+0V",
                      "LIMITS OF LIABILITY")
L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s%s%s","<033>&a200h+40V<033>*c5289h5v0P","<NL>","<NL>")  --HORZ LINE
If (agqPERSONAL:LIABILITY_LIMIT = 0) Then
  {
    Writefile(L_FILE_NAME,"%s%s%s%s",L_ARIAL,"<033>&a220h+0V",
                          "E. ",SCIPSCONTROL:SECTION2_COVERAGE_E)
    Writefile(L_FILE_NAME,"%s","<033>&a2600h+0V")
    Writefile(L_FILE_NAME,"%s","$")
    Writefile(L_FILE_NAME,"%s","<033>&a2900h+0V")
    Writefile(L_FILE_NAME,"%s%s",SCIPSCONTROL:BLANK_WORDING,"<NL>")
  }
Else
  {
    Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s%s%s%s",L_ARIAL,
                          "<033>&a220h+0V",
                          "E. ",SCIPSCONTROL:SECTION2_COVERAGE_E,
                          "<033>&a2600h+0V",
                          "$",L_LETTER_GOTHIC_BOLD_12,"<033>&a2650h+0V",
                          Str(agqPERSONAL:LIABILITY_LIMIT,"ZZ,ZZZ,ZZZ"),L_ARIAL,
                          "<033>&a3400h+0V","Each Occurrence","<NL>")
  }
L_LINE_COUNTER = L_LINE_COUNTER + 1
If (agqPERSONAL:MEDICAL_LIMIT = 0) Then
  {
    Writefile(L_FILE_NAME,"%s%s%s",L_ARIAL,"<033>&a220h+0V",
                          "F. MEDICAL PAYMENT TO OTHERS")
    Writefile(L_FILE_NAME,"%s","<033>&a2600h+0V")
    Writefile(L_FILE_NAME,"%s","$")
    Writefile(L_FILE_NAME,"%s","<033>&a2900h+0V")
    Writefile(L_FILE_NAME,"%s",SCIPSCONTROL:BLANK_WORDING)
  }
Else
  {
    Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s%s",L_ARIAL,"<033>&a220h+0V",
                          "F. MEDICAL PAYMENT TO OTHERS","<033>&a2600h+0V",
                          "$",L_LETTER_GOTHIC_BOLD_12,"<033>&a2650h+0V",
                          Str(agqPERSONAL:MEDICAL_LIMIT,"ZZ,ZZZ,ZZZ"),L_ARIAL,
                          "<033>&a3400h+0V","Each Person")
  }

Writefile(L_FILE_NAME,"%s%s","<033>&a200h+50V<033>*c5289h5v0P",
                      "<NL>")  --HORZ LINE bottom section II coverage PG. 1

If (agqPERSONAL:SECONDARY_RESIDENCE[1] <> "") Or
   (agqPERSONAL:SECONDARY_RESIDENCE[2] <> "") Then
  {
    Writefile(L_FILE_NAME,"%s","<033>&a220h-0V")
    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
    Writefile(L_FILE_NAME,"%s","SECTION II OTHER INSURED LOCATIONS")
    Writefile(L_FILE_NAME,"%s","<033>&a4800h-0V")
    Writefile(L_FILE_NAME,"%s","No. of Families")
    Writefile(L_FILE_NAME,"%s%s","<033>&a200h+50V<033>*c5289h5v0P",
                      "<NL>")  --HORZ LINE bottom section II other location
    Writefile(L_FILE_NAME,"%s","<033>&a220h-0V")
    Writefile(L_FILE_NAME,"%s",L_ARIAL)
    Writefile(L_FILE_NAME,"%s",Uppercase( Trun(agqPERSONAL:SECONDARY_RESIDENCE[1])))
    Writefile(L_FILE_NAME,"%s","<033>&a5400h-0V")
    Writefile(L_FILE_NAME,"%n",agqPERSONAL:SECONDARY_RESIDENCE_FAMILIES[1])
    If agqPERSONAL:SECONDARY_RESIDENCE[2] <> "" Then
      {
        Writefile(L_FILE_NAME,"%s","<NL>")
        Writefile(L_FILE_NAME,"%s","<033>&a220h-0V")
        Writefile(L_FILE_NAME,"%s",Uppercase( Trun(agqPERSONAL:SECONDARY_RESIDENCE[2])))
        Writefile(L_FILE_NAME,"%s","<033>&a5400h-0V")
        Writefile(L_FILE_NAME,"%n",agqPERSONAL:SECONDARY_RESIDENCE_FAMILIES[2])
      }
  }

if agqpersonal:companion_discount = 1 and
   agqpersonal:state = 29 then
  begin
    Writefile(L_FILE_NAME,"%s","<033>&a220h+120V")
    Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_bold_12))
    writefile(l_file_name,"%s%s",trun(scipscontrol1:palisades_credit_wording[1]),"<NL>")
    Writefile(L_FILE_NAME,"%s","<033>&a220h+0V")
    writefile(l_file_name,"%s",trun(scipscontrol1:palisades_credit_wording[2]))
  end
if agqpersonal:companion_discount = 1 and
   agqpersonal:state = 19 then
  begin
    Writefile(L_FILE_NAME,"%s","<033>&a220h+100V")
    Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_bold_12))
    writefile(l_file_name,"%s%s",trun(scipscontrol1:palisades_credit_wording[1]),"<NL>")
    Writefile(L_FILE_NAME,"%s","<033>&a220h+0V")
    writefile(l_file_name,"%s",trun(scipscontrol1:palisades_credit_wording[2]))
  end
if agqpersonal:companion_discount_1 = 1 and
   agqpersonal:state = 19 then
  begin
    Writefile(L_FILE_NAME,"%s","<033>&a220h+100V")
    Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_bold_12))
    writefile(l_file_name,"%s%s",trun(scipscontrol1:palisades_credit_wording[3]),"<NL>")
    Writefile(L_FILE_NAME,"%s","<033>&a220h+0V")
    writefile(l_file_name,"%s",trun(scipscontrol1:palisades_credit_wording[4]))
  end
if agqpersonal:ifa_companion_discount = 1 and
   agqpersonal:state one of 19, 29 then
  begin
    Writefile(L_FILE_NAME,"%s","<033>&a220h+100V")
    Writefile(L_FILE_NAME,"%s",trun(L_ARIAL_bold_12))
    writefile(l_file_name,"%s%s",trun(scipscontrol1:palisades_credit_wording[7]),"<NL>")
    Writefile(L_FILE_NAME,"%s","<033>&a220h+0V")
    writefile(l_file_name,"%s",trun(scipscontrol1:palisades_credit_wording[8]))
  end
else
if agqpersonal:other_companion_auto_credit = 1 then
    begin
    Writefile(L_FILE_NAME,"%s",L_ARIAL_bold_12)
    Writefile(L_FILE_NAME,"%s","<033>&a600h+100V")
    writefile(l_file_name,"%s%s",trun(scipscontrol1:palisades_credit_wording[1])," ")
    If agqpersonal:other_companion_percent < 100 then
      {
        writefile(l_file_name,"%s",str(agqpersonal:other_companion_percent,"Z9%"))
      }
    else
      {
        writefile(l_file_name,"%s"," ")
        writefile(l_file_name,"%s",str(agqpersonal:other_companion_percent,"ZZ9%"))
      }

    writefile(l_file_name,"%s"," ")
    writefile(l_file_name,"%s",trun(uppercase(agqpersonal:other_companion_co_name)))
    Writefile(L_FILE_NAME,"%s",L_ARIAL_bold_12)
    Writefile(L_FILE_NAME,"%s","<033>&a600h+120V")
    writefile(l_file_name,"%s",trun(scipscontrol1:palisades_credit_wording[2]))
    end

Writefile(L_FILE_NAME,"%s",l_arial_bold_14)
Writefile(L_FILE_NAME,"%s%s","<033>&a2130h+240V",
                      "THIS IS NOT A POLICY")


Access SFSMESSAGE,
   Set SFSMESSAGE:COMPANY_ID       = L_COMPANY_ID,
       SFSMESSAGE:STATE            = I_STATE,
       SFSMESSAGE:LINE_OF_BUSINESS = agqpersonal:line_of_business, generic

l_message_eff_date = 0
l_message_exp_date = 0
l_print_on_front   = 0
l_print_on_back    = 0
while SFSMESSAGE:COMPANY_ID       = l_COMPANY_ID and
      SFSMESSAGE:STATE            = I_STATE and
      SFSMESSAGE:LINE_OF_BUSINESS = agqpersonal:line_of_business
        begin
        if agqpersonal:eff_date >= sfsmessage:eff_date and
           agqpersonal:eff_date <= sfsmessage:exp_date then
            begin
            l_print_on_front   = sfsmessage:print_on_front
            l_print_on_back    = sfsmessage:print_on_back
            L_message_eff_date = sfsmessage:eff_date
            L_message_exp_date = sfsmessage:exp_date
            end

        Next SFSMESSAGE
        end

Access SFSMESSAGE,
   Set SFSMESSAGE:COMPANY_ID       = L_COMPANY_ID,
       SFSMESSAGE:STATE            = I_STATE,
       SFSMESSAGE:LINE_OF_BUSINESS = agqpersonal:line_of_business,
       SFSMESSAGE:EFF_DATE         = L_MESSAGE_EFF_DATE,
       SFSMESSAGE:EXP_DATE         = L_MESSAGE_EXP_DATE, generic

If sfsmessage:eff_date = l_message_eff_date and
   sfsmessage:exp_date = l_message_exp_date and
   l_print_on_front = 1 then
    begin
    If ((SFSMESSAGE:NEW = 1 and
       agqmaster:trans_code = 10) or
       (SFSMESSAGE:RENEWAL = 1 and
       agqmaster:trans_code = 14) or
       (SFSMESSAGE:ENDORSEMENT = 1 and
       agqmaster:trans_code one of 12, 13) or
       (SFSMESSAGE:CANCELLATION = 1 and
       agqmaster:trans_code one of 11) or
       (SFSMESSAGE:REINSTATEMENT = 1 and
       agqmaster:trans_code one of 16) or
       SFSMESSAGE:ALL = 1) then
        begin
        Writefile(L_FILE_NAME,"%s%s%s%s%s","<NL>","<NL>","<033>&a220h-0V",L_ARIAL_BOLD_12,
                          "Important Messages")
        end
    end

If L_TRANS_CODE one of 10 and
   SFSMESSAGE:NEW   = 1 and
   l_print_on_front = 1 then
    begin
    L_FONT             = L_ARIAL_BOLD
    L_V_POSITION       = "+120"
    L_H_POSITION       = "200"
    L_CHARACTER_STRING = SFSMESSAGE:NEW_MESSAGE
    L_MAX_CHAR         = 100

    Include "line_spacing.inc"
    end

If L_TRANS_CODE one of 11 and
   SFSMESSAGE:CANCELLATION = 1 and
   l_print_on_front = 1 then
    begin
    L_FONT             = L_ARIAl_BOLD
    L_V_POSITION       = "+120"
    L_H_POSITION       = "200"
    L_CHARACTER_STRING = SFSMESSAGE:CANCELLATION_MESSAGE
    L_MAX_CHAR         = 100

    Include "line_spacing.inc"
    end

If L_TRANS_CODE one of 14 and
   SFSMESSAGE:RENEWAL = 1 and
   l_print_on_front = 1 then
    begin
    L_FONT             = L_ARIAL_BOLD
    L_V_POSITION       = "+120"
    L_H_POSITION       = "200"
    L_CHARACTER_STRING = SFSMESSAGE:RENEWAL_MESSAGE
    L_MAX_CHAR         = 100

    Include "line_spacing.inc"
    end

If L_TRANS_CODE one of 16 and
   SFSMESSAGE:NEW = 1 and
   l_print_on_front = 1 then
    begin
    L_FONT             = L_ARIAL_BOLD
    L_V_POSITION       = "+120"
    L_H_POSITION       = "200"
    L_CHARACTER_STRING = SFSMESSAGE:REINSTATEMENT_MESSAGE
    L_MAX_CHAR         = 100

    Include "line_spacing.inc"
    end

If L_TRANS_CODE one of 12, 13 and
   SFSMESSAGE:ENDORSEMENT = 1 and
   l_print_on_front = 1 then
    begin
    L_FONT             = L_ARIAL_BOLD
    L_V_POSITION       = "+120"
    L_H_POSITION       = "200"
    L_CHARACTER_STRING = SFSMESSAGE:ENDORSEMENT_MESSAGE
    L_MAX_CHAR         = 100

    Include "line_spacing.inc"
    end

If SFSMESSAGE:ALL = 1 and
   l_print_on_front = 1 then
    begin
    L_FONT             = L_ARIAL_BOLD
    L_V_POSITION       = "+120"
    L_H_POSITION       = "200"
    L_CHARACTER_STRING = SFSMESSAGE:ALL_MESSAGE
    L_MAX_CHAR         = 100

    Include "line_spacing.inc"
    end

do fraud_warning

If SCIPSCONTROL:PRINT_BORDERS_ON_DEC_PAGE = 1 Then
  {
    Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c10a3045b0P")   --left vertical li
    Writefile(L_FILE_NAME,"%s","<033>&a5585h0V<033>*c10a3045b0P")   --right vertical
    Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c5467h20v0P") --top horizontal line to
    Writefile(L_FILE_NAME,"%s","<033>&a140h7300V<033>*c5467h20v0P") --bottom horizontal line
  }
--used for heading on the DEC
Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
Writefile(L_FILE_NAME,"%s",L_ARIAL)
Writefile(L_FILE_NAME,"%s","<033>&a4950h7200V")
Writefile(L_FILE_NAME,"%s","Page ")
Writefile(L_FILE_NAME,"%n",L_PAGE_NUMBER)
--Start of page 2
Do INSERT_NEWPAGE

Writefile(L_FILE_NAME,"%s","<033>&a5479h+0V<033>*c5a120b0P")   --right vertical line seond box on pg 1
Writefile(L_FILE_NAME,"%s","<033>&a200h+0V<033>*c5a120b0P")   --left vertical line seond box on pg 1
Writefile(L_FILE_NAME,"%s%s","<033>&a200h+0V<033>*c5289h5v0P","<NL>")  --HORZ LINE deductible section I coverage PG. 1
L_LINE_COUNTER = L_LINE_COUNTER + 1


L_STRING = "QUOTE PREMIUM BREAKDOWN"
L_FONT = L_ARIAL_BOLD_14
L_PITCH_HALF = 7
L_PITCH_FULL = 14
L_VERTICAL_POS = "+80"
Include "center2.pro"

--Writefile(L_FILE_NAME,"%s%s%s%s",L_ARIAL_bold_14,"<033>&a220h-0V",
--                      ,"<NL>")
--L_LINE_COUNTER = L_LINE_COUNTER + 1

Writefile(L_FILE_NAME,"%s%s","<033>&a200h-40V<033>*c5289h5v0P",
                      "<NL>")  --HORZ LINE deductible section I coverage PG. 1
L_LINE_COUNTER = L_LINE_COUNTER + 1

--  I need to loop though all forms in agqprint2 and 3 and count the number of
--  forms that I have.  This is done to make sure that I have enough room to put
--  the counter signature on the same page.
--  This will not be possible if there are more then 40 endorsement.

Access agqEND,
   Set agqEND:app_no = L_app_no ,generic

l_mdl1  = 0
l_mpl03 = 0
While agqEND:app_no    = L_app_no
{
--I need to check for this endorsement.  if this endorsement exists.  Then I
--do not print Personal Liability endorsment out with premium.
--I need to put that premium with MDL1.  This is only for the sfsline=dwelling
  If SFSLINE:LOB_CODE = "DWELLING" Then
    {
      If agqEND:CODE = "MDL1" Then  --do not need to spaces because of padchacter = space
        {
          L_MDL1 = 1
        }
      if agqend:code = "MPL03" then
          l_mpl03 = 1
    }
  else
  if agqend:code = "MPL03" then
      l_mpl03 = 1

  Next agqEND
}

if l_mpl03 = 1 then
    l_mdl1 = 0

--reaccessing the file so agqend will not be at the end
Access agqEND,
   Set agqEND:app_no = L_app_no ,generic

--Writefile(L_FILE_NAME,"%s%s%s%s%s",L_ARIAL,"<NL>","<033>&a1300h+0V",
--                      "Jacket","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 2
L_FIRST_MANDATORY_ENDORSEMENT = 0 --set to zero so mho form total prints
access sfsend,
   set sfsend:company_id       = l_company_id,
       sfsend:state            = agqpersonal:state,
       sfsend:line_of_business = l_line_of_business,
       sfsend:form             = agqpersonal:form, approximate

While sfsend:company_id       = l_company_id and
      sfsend:state            = agqpersonal:state and
      sfsend:line_of_business = agqpersonal:line_of_business and
      sfsend:form             = agqpersonal:form

{
if (agqpersonal:eff_date >= sfsend:eff_date and
   (agqpersonal:eff_date <= sfsend:exp_date or
   sfsend:exp_date = 0)) then
    begin
--this is here to break out of the loop for first mandatory endorsement
--which are the MHO - Homeowners Coverage Form
--I could not search for the agqprint2:code because they may add endorsement
--to the system
--I am also breaking out the liability form the total premium

  If (L_FIRST_MANDATORY_ENDORSEMENT = 0) Then
    {
      If (SFSLINE:LOB_CODE = "DWELLING") Then
        {
          Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s%s",L_ARIAL,
                            "<033>&a220h+0V",sfsend:FORM_EDITION,
                            "<033>&a1300h+0V",sfsend:DESCRIPTION,
                            "<033>&a4750h+0V","$",L_LETTER_GOTHIC_BOLD_12,
                            "<033>&a4800h+0V",
                            Str(agqPERSONAL:DWELLING_PREMIUM[1] +
                                agqPERSONAL:STRUCTURES_PREMIUM_1[1] +
                                agqPERSONAL:CONTENTS_PREMIUM[1] +
                                agqPERSONAL:LOSS_RENTS_PREMIUM[1] +
                                agqmaster:total[9] +
                                agqmaster:total[10] +
                                agqtotals:irpm_total +
                                agqPERSONAL:DF_DEDUCT_PREMIUM,"(ZZ,ZZZ,ZZZ)"),
                                 --needed to add in deductible into base premium so it add up on the dec page.
                            "<NL>")
        }
      Else
      if sfsend:code not one of "MPL01" then
        {
          Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s%s",L_ARIAL,
                            "<033>&a220h+0V",sfsend:FORM_EDITION,
                            "<033>&a1300h+0V",sfsend:DESCRIPTION,
                            "<033>&a4750h+0V","$",L_LETTER_GOTHIC_BOLD_12,
                            "<033>&a4800h+0V",
                            Str(agqPERSONAL:DWELLING_PREMIUM[1] +
                                agqPERSONAL:STRUCTURES_PREMIUM_1[1] +
                                agqPERSONAL:CONTENTS_PREMIUM[1] +
                                agqtotals:irpm_total +
                                agqPERSONAL:LOSS_RENTS_PREMIUM[1],
                                "(ZZ,ZZZ,ZZZ)"),
                                "<NL>")
        }
      If agqPERSONAL:LIAB_MEDICAL_PREMIUM > 0 Then
        {
          --I need to check to see if L_mdl1 <> 1 if so do print Personal Liability
          --I do not need to check for DWElling because L_MDL1 is being set with the
          --sfsline:lob_code = DWELLing
          If (L_MDL1 <> 1) Then  --will be one if MDL1 is added as an endorsment under dwelling
            {
              If l_mpl03 = 1 then
                {
                  Writefile(L_FILE_NAME,"%s",L_ARIAL)
                  Writefile(L_FILE_NAME,"%s","<033>&a1300h+0V")
                  Writefile(L_FILE_NAME,"%s","Premises Liability")
                }
              else
                {
                  Writefile(L_FILE_NAME,"%s",L_ARIAL)
                  Writefile(L_FILE_NAME,"%s","<033>&a1300h+0V")
                  Writefile(L_FILE_NAME,"%s","Personal Liability")
                }

              Writefile(L_FILE_NAME,"%s","<033>&a4750h+0V")
              Writefile(L_FILE_NAME,"%s","$")
              Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_12)
              Writefile(L_FILE_NAME,"%s","<033>&a4800h+0V")
              Writefile(L_FILE_NAME,"%s%s",
                        Str(agqPERSONAL:LIAB_MEDICAL_PREMIUM,"(ZZ,ZZZ,ZZZ)"),
                        "<NL>")
            }
          L_LINE_COUNTER = L_LINE_COUNTER + 1
        }
      L_FIRST_MANDATORY_ENDORSEMENT = 1
    }
  Else
    {
    if sfsend:code = "MPL01" and
       l_mpl03 = 1 then
        l_mpl01 = "N"
    else
        l_mpl01 = "Y"

        If SFSEND:RENEWAL = 1 And
           agqNAME:previous_policy_no <> 0 Then
            Begin
            If ((agqpersonal:eff_date <= SFSEND:EXP_DATE Or
               SFSEND:EXP_DATE = 0) And
               agqpersonal:eff_date >= SFSEND:RENEWAL_EFF_DATE) Then
                Begin
                if ((sfsend:code = "MPL01" and
                   l_mpl01 = "Y") or
                   sfsend:code not one of "MPL01") then
                    begin
                    Writefile(L_FILE_NAME,"%s%s%s%s%s%s",L_ARIAL,
                                "<033>&a220h+0V",sfsend:FORM_EDITION,
                                "<033>&a1300h+0V",sfsend:DESCRIPTION,
                                "<NL>")
                    end
                End
            End
        Else
            If SFSEND:NEW = 1 And
               agqNAME:previous_policy_no = 0 Then
                Begin
                If ((agqpersonal:eff_date <= SFSEND:EXP_DATE Or
                   SFSEND:EXP_DATE = 0) And
                   agqpersonal:eff_date >= SFSEND:NEW_EFF_DATE) Then
                    Begin
                    if ((sfsend:code = "MPL01" and
                       l_mpl01 = "Y") or
                       sfsend:code not one of "MPL01") then
                        begin
                        Writefile(L_FILE_NAME,"%s%s%s%s%s%s",L_ARIAL,
                               "<033>&a220h+0V",sfsend:FORM_EDITION,
                                "<033>&a1300h+0V",sfsend:DESCRIPTION,
                                "<NL>")
                        end
                    End
                End
            Else
            if sfsend:new = 0 and
               sfsend:renewal = 0 then
                Begin
                if ((sfsend:code = "MPL01" and
                   l_mpl01 = "Y") or
                   sfsend:code not one of "MPL01") then
                    begin
                    Writefile(L_FILE_NAME,"%s%s%s%s%s%s",L_ARIAL,
                                "<033>&a220h+0V",sfsend:FORM_EDITION,
                                "<033>&a1300h+0V",sfsend:DESCRIPTION,
                                "<NL>")
                    end
                End


        }
     L_LINE_COUNTER = L_LINE_COUNTER + 1
  end

  Next sfsend
}

L_WATER_DAMAGE_WORDING = "N"

While agqEND:app_no    = L_app_no

{

  If agqEND:CODE = "HO2320 " Then -- For CCMI water damage wording below
    {
      L_WATER_DAMAGE_WORDING = "Y"
    }

  L_NUM_FORMS = L_NUM_FORMS + 1
  If agqEND:CODE = "HO0446" Then  --For inflation guard0
    {
      Writefile(L_FILE_NAME,"%s",L_ARIAL)
      Writefile(L_FILE_NAME,"%s","<033>&a220h+0V")
      Writefile(L_FILE_NAME,"%s",agqEND:FORM_EDITION)
      Writefile(L_FILE_NAME,"%s","<033>&a1300h+0V")
      Writefile(L_FILE_NAME,"%s",Trun(agqEND:DESCRIPTION))
      Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)

      Writefile(L_FILE_NAME," %s%s%s",Str(agqPERSONAL:INFLATION_GUARD,"ZZZ"),"%","<NL>")
    }
  Else
  If agqEND:CODE = "MPL76" Then
    {
      Writefile(L_FILE_NAME,"%s",L_ARIAL)
      Writefile(L_FILE_NAME,"%s","<033>&a220h+0V")
      Writefile(L_FILE_NAME,"%s",agqEND:FORM_EDITION)
      Writefile(L_FILE_NAME,"%s","<033>&a1300h+0V")
      Writefile(L_FILE_NAME,"%s",Trun(agqEND:DESCRIPTION))
      Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
      Writefile(L_FILE_NAME,"%s","<033>&a5055h+0V")
      Writefile(L_FILE_NAME,"%s","Included")
      Writefile(L_FILE_NAME,"%s","<NL>")
    }
  else
  If agqEND:CODE = "MPL22" Then
    {
      Writefile(L_FILE_NAME,"%s",L_ARIAL)
      Writefile(L_FILE_NAME,"%s","<033>&a220h+0V")
      Writefile(L_FILE_NAME,"%s",agqEND:FORM_EDITION)
      Writefile(L_FILE_NAME,"%s","<033>&a1300h+0V")
      Writefile(L_FILE_NAME,"%s",Trun(agqEND:DESCRIPTION))
      Writefile(L_FILE_NAME,"%s","<033>&a+60h-35V<033>*c50h5v0P")
      Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
      Writefile(L_FILE_NAME,"%s","<033>&a+100h+35V")
      Writefile(L_FILE_NAME,"%s",Str(agqpersonal:wind_deductible,"($Z,ZZZ)"))
      Writefile(L_FILE_NAME,"%s","<NL>")
    }
  else
  If agqEND:CODE one of "FPL02", "MPL720" Then
    {
      Writefile(L_FILE_NAME,"%s",L_ARIAL)
      Writefile(L_FILE_NAME,"%s","<033>&a220h+0V")
      Writefile(L_FILE_NAME,"%s",agqEND:FORM_EDITION)
      Writefile(L_FILE_NAME,"%s","<033>&a1300h+0V")
      Writefile(L_FILE_NAME,"%s",Trun(agqEND:DESCRIPTION))
      Writefile(L_FILE_NAME,"%s",L_ARIAL)
      Writefile(L_FILE_NAME,"%s","<033>&a4750h+0V")
      Writefile(L_FILE_NAME,"%s","$")
      Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_12)
      Writefile(L_FILE_NAME,"%s","<033>&a4800h+0V")
      Writefile(L_FILE_NAME,"%s",Str(agqmaster:total[2],"(ZZ,ZZZ,ZZZ)"))
      Writefile(L_FILE_NAME,"%s","<NL>")
    }
  Else
  If agqEND:CODE = "MDW30" Then
    {
      Writefile(L_FILE_NAME,"%s",L_ARIAL)
      Writefile(L_FILE_NAME,"%s","<033>&a220h+0V")
      Writefile(L_FILE_NAME,"%s",agqEND:FORM_EDITION)
      Writefile(L_FILE_NAME,"%s","<033>&a1300h+0V")
      Writefile(L_FILE_NAME,"%s",Trun(agqEND:DESCRIPTION))
      Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
      Writefile(L_FILE_NAME,"%s","<033>&a5055h+0V")
      if agqend:premium <> 0 then
          Writefile(L_FILE_NAME,"%s%s%s%s%s","<033>&a4750h+0V",
                                             "$",
                                             L_LETTER_GOTHIC_BOLD_12,
                                             "<033>&a4800h+0V",
                                             Str(agqEND:PREMIUM,"(ZZ,ZZZ,ZZZ)"))
      else
          Writefile(L_FILE_NAME,"%s","Included")
      Writefile(L_FILE_NAME,"%s","<NL>")
    }
  Else
  --means I need to print the MDL1 form with the premium across from it from
  If agqEND:CODE = "MDL1" And
     L_MDL1 = 1 Then
    {
      If agqPERSONAL:LIAB_MEDICAL_PREMIUM > 0 Then
        {
          Writefile(L_FILE_NAME,"%s",L_ARIAL)
          Writefile(L_FILE_NAME,"%s","<033>&a220h+0V")
          Writefile(L_FILE_NAME,"%s",agqEND:FORM_EDITION)
          Writefile(L_FILE_NAME,"%s","<033>&a1300h+0V")
          Writefile(L_FILE_NAME,"%s",agqEND:DESCRIPTION)
          Writefile(L_FILE_NAME,"%s","<033>&a4750h+0V")
          Writefile(L_FILE_NAME,"%s","$")
          Writefile(L_FILE_NAME,"%s",L_LETTER_GOTHIC_BOLD_12)
          Writefile(L_FILE_NAME,"%s","<033>&a4800h+0V")
          Writefile(L_FILE_NAME,"%s%s",Str(agqPERSONAL:LIAB_MEDICAL_PREMIUM,"(ZZ,ZZZ,ZZZ)"),"<NL>")
        }
    }
  Else
    If agqEND:CODE One Of "MPL70","HO0416" Then
      {
        If agqEND:PREMIUM <> 0 Then
          {
            Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s",L_ARIAL,
                            "<033>&a220h+0V",agqEND:FORM_EDITION,
                            "<033>&a1300h+0V",
                            Trun(agqEND:DESCRIPTION),"<033>&a4750h+0V","$",
                            L_LETTER_GOTHIC_BOLD_12,
                            "<033>&a4800h+0V",
                            Str(agqEND:PREMIUM,"(ZZ,ZZZ,ZZZ)"))
          }
        Else
          {
          if agqend:code <> "MDL1" then
            {
            Writefile(L_FILE_NAME,"%s%s%s%s%s",L_ARIAL,
                            "<033>&a220h+0V",agqEND:FORM_EDITION,
                            "<033>&a1300h+0V",
                            Trun(agqEND:DESCRIPTION))
            }
          }
        L_COUNTER = 1
        While L_COUNTER < 6
          { --Adds up the alarm credits to get discount totals for alarm.
            If agqPERSONAL:ALARM_OPTION[L_COUNTER] = 1 Then
              {
                L_CREDIT = 1.0 - agqPERSONAL:ALARM_FACTOR[L_COUNTER]
                L_TOTAL_CREDIT = L_TOTAL_CREDIT + L_CREDIT
              }
            L_COUNTER = L_COUNTER + 1
          }
        If SFSLINE:OPTION One Of "R", "P" Then   --R is preferred and P = premier
          {  -- I do not need to subtract 2% because it is included in premier and preferred program
             -- debbiep put a 1.0 factor in the screen so no need to subtract anyting
            L_TOTAL_CREDIT = L_TOTAL_CREDIT * 100
            If L_TOTAL_CREDIT > 2 Then
              {
                L_PRINT_STRING = " 2% included additional " +
                                 Str(L_TOTAL_CREDIT) + "% credit"
              }
            Else
              {
                L_PRINT_STRING = " 2% included"
              }
          }
        Else  --there will be no additional wording here because it is only
              --included in the premier and preferred.  Just need to print the
              --100 - l_total_credit and I should be done.
          {
            L_TOTAL_CREDIT = L_TOTAL_CREDIT  * 100      -- need to convert to percent
            L_PRINT_STRING = " " + Str(L_TOTAL_CREDIT) + "% credit"
          }
        Writefile(L_FILE_NAME,"%s%s%s%s",L_ARIAL_BOLD,"<033>&a+100h+0V",
                              L_PRINT_STRING,"<NL>")
      } -- end of mpl70 and ho0416
    Else
      If agqEND:PREMIUM <> 0 and
         agqend:code <> "MDL1" Then
        {
          Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s%s",L_ARIAL,
                            "<033>&a220h+0V",agqEND:FORM_EDITION,"<033>&a1300h+0V",
                            agqEND:DESCRIPTION,"<033>&a4750h+0V","$",
                            L_LETTER_GOTHIC_BOLD_12,
                            "<033>&a4800h+0V",Str(agqEND:PREMIUM,"(ZZ,ZZZ,ZZZ)"),
                            "<NL>")
        }
      Else  -- if 0 don't print dollor amounts
        {
        if agqend:code <> "MDL1" then
          {
          Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s",L_ARIAL,
                            "<033>&a220h+0V",agqEND:FORM_EDITION,"<033>&a1300h+0V",
                            agqEND:DESCRIPTION,L_LETTER_GOTHIC_12,
                            "<033>&a4800h+0V",
                            "<NL>")
          }
        }

    L_LINE_COUNTER = L_LINE_COUNTER + 1
  Next agqEND
}




Access SCIPSCONTROL1,
   Set SCIPSCONTROL1:COMPANY_ID = L_COMPANY_ID,
       SCIPSCONTROL1:STATE      = agqpersonal:state,
       SCIPSCONTROL1:LOB_CODE   = L_LOB_CODE, Exact

if agqmaster:total[9] <> 0 then   --minumum premium info here
  begin
    writefile(l_file_name,"%s%s%s%s%s",l_arial,
                          "<033>&a1300h+0V",
                          str(l_policy_percent),"% ",
                          scipscontrol:seasonal_occupancy_wording)
    Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
    Writefile(L_FILE_NAME,"%s","<033>&a5055h+0V")
    Writefile(L_FILE_NAME,"%s","Included")
    Writefile(L_FILE_NAME,"%s","<NL>")
  end

if agqpersonal:windstorm_loss_mitigation = 1 and
   agqpersonal:state = 19 then
    begin
    l_windstorm_surcharge = agqpersonal:windstorm_surcharge
    writefile(l_file_name,"%s%s",l_arial,
                                 "<033>&a1300h+0V")
    writefile(l_file_name,"%s","Windstorm Loss Mitigation Credit")
    writefile(l_file_name,"%s",L_LETTER_GOTHIC_BOLD_12)
    writefile(l_file_name,"%s","<033>&a2800h+0V")
    writefile(l_file_name,"%s",Str(agqpersonal:windstorm_factor,"(ZZ%)"))
    writefile(l_file_name,"%s","<NL>")
    end

--Total Estimated premium here

if agqpersonal:companion_discount = 1 and
   agqpersonal:state = 29 then
    begin
    l_palisades_credit = agqpersonal:palisades_credit * -1
    writefile(l_file_name,"%s%s",l_arial,
                                 "<033>&a1300h+0V")
    writefile(l_file_name,"%s",trun(scipscontrol1:palisades_credit_wording[3]))
    writefile(l_file_name,"%s","<033>&a4750h+0V")
    writefile(l_file_name,"%s","$")
    writefile(l_file_name,"%s",L_LETTER_GOTHIC_BOLD_12)
    writefile(l_file_name,"%s","<033>&a4800h+0V")
    writefile(l_file_name,"%s",Str(agqpersonal:palisades_credit,"(ZZ,ZZZ,ZZZ)"))
    writefile(l_file_name,"%s","<NL>")
    end

if ((agqpersonal:companion_discount = 1 or
   agqpersonal:companion_discount_1 = 1) and
   agqpersonal:state = 19) then
    begin
    l_palisades_credit = agqpersonal:palisades_credit * -1
    writefile(l_file_name,"%s%s",l_arial,
                                 "<033>&a1300h+0V")
    if agqpersonal:companion_discount = 1 then
        writefile(l_file_name,"%s",trun(scipscontrol1:palisades_credit_wording[5]))
    else
    if agqpersonal:companion_discount_1 = 1 then
        writefile(l_file_name,"%s",trun(scipscontrol1:palisades_credit_wording[6]))
    writefile(l_file_name,"%s","<033>&a4750h+0V")
    writefile(l_file_name,"%s","$")
    writefile(l_file_name,"%s",L_LETTER_GOTHIC_BOLD_12)
    writefile(l_file_name,"%s","<033>&a4800h+0V")
    writefile(l_file_name,"%s",Str(agqpersonal:palisades_credit,"(ZZ,ZZZ,ZZZ)"))
    writefile(l_file_name,"%s","<NL>")
    end

if agqpersonal:ifa_companion_discount = 1 and
   agqpersonal:state one of 19, 29 then
    begin
    l_ifa_credit = agqpersonal:ifa_credit * -1
    writefile(l_file_name,"%s%s",l_arial,
 "<033>&a1300h+0V")
    writefile(l_file_name,"%s",trun(scipscontrol1:palisades_credit_wording[9]))
    writefile(l_file_name,"%s","<033>&a4750h+0V")
    writefile(l_file_name,"%s","$")
    writefile(l_file_name,"%s",L_LETTER_GOTHIC_BOLD_12)
    writefile(l_file_name,"%s","<033>&a4800h+0V")
    writefile(l_file_name,"%s",Str(agqpersonal:ifa_credit,"(ZZ,ZZZ,ZZZ)"))
    writefile(l_file_name,"%s","<NL>")
    end

if agqpersonal:other_companion_auto_credit = 1 then
    begin
    l_palisades_credit = agqpersonal:palisades_credit * -1
    writefile(l_file_name,"%s%s",l_arial,
                                 "<033>&a1300h+0V")
    writefile(l_file_name,"%s%s%s%s",trun(scipscontrol1:palisades_credit_wording[3]),trun(agqpersonal:other_companion_co_name)," ",trun(scipscontrol1:palisades_credit_wording[4]))
    writefile(l_file_name,"%s","<033>&a4750h+0V")
    writefile(l_file_name,"%s","$")
    writefile(l_file_name,"%s",L_LETTER_GOTHIC_BOLD_12)
    writefile(l_file_name,"%s","<033>&a4800h+0V")
    writefile(l_file_name,"%s",Str(agqpersonal:palisades_credit,"(ZZ,ZZZ,ZZZ)"))
    writefile(l_file_name,"%s","<NL>")
    end

if agqpersonal:windstorm_loss_mitigation = 1 and
   agqpersonal:state = 19 then
    begin
    l_windstorm_surcharge = agqpersonal:windstorm_surcharge
    writefile(l_file_name,"%s%s",l_arial,
                                 "<033>&a1300h+0V")
    writefile(l_file_name,"%s","Windstorm Loss Mitigation Credit")
    writefile(l_file_name,"%s",L_LETTER_GOTHIC_BOLD_12)
    writefile(l_file_name,"%s","<033>&a2800h+0V")
    writefile(l_file_name,"%s",Str(agqpersonal:windstorm_factor,"(ZZ%)"))
    writefile(l_file_name,"%s","<NL>")
    end

Writefile(L_FILE_NAME,"%s%s%s%s%s","<NL>",L_ARIAL,"<033>&a220h+0V",
                      "* Mandatory Endorsement","<NL>")
  L_LINE_COUNTER = L_LINE_COUNTER + 2

Writefile(L_FILE_NAME,"%s%s%s%s","<NL>","<NL>","<033>&a220h+0V",
                      "TOTAL ESTIMATED PREMIUM")
  L_LINE_COUNTER = L_LINE_COUNTER + 2

Writefile(L_FILE_NAME,"%s%s%s%s%s%s","<033>&a4750h+0V","$",
                      L_LETTER_GOTHIC_BOLD_12,"<033>&a4800h+0V",
                      Str(agqMASTER:TOTAL[1] + agqmaster:total[2] +
                          agqMASTER:TERRORISM_PREMIUM,"(ZZ,ZZZ,ZZZ)"),"<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1

--surcharge

--Writefile(L_FILE_NAME,"%s%n","<033>&a4750h+0V",SCIPScontrol:state)
If (SCIPSCONTROL:SURCHARGE_WORDING <> "") Then
  {
    Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s%s",L_ARIAL,"<033>&a220h+0V",
                      Trun(SCIPSCONTROL:SURCHARGE_WORDING),"<033>&a4750h+0V","$",
                      L_LETTER_GOTHIC_BOLD_12,"<033>&a4800h+0V",
                      Str(agqMASTER:SURCHARGE,"(ZZ,ZZZ,ZZZ)"),
                      L_ARIAL,"<NL>","<NL>")
    L_LINE_COUNTER = L_LINE_COUNTER + 2
  }

Writefile(L_FILE_NAME,"%s%s%s",L_ARIAL,"<033>&a220h+0V",
                      "TOTAL QUOTE PREMIUM")

Writefile(L_FILE_NAME,"%s%s%s%s%s%s","<033>&a4750h+0V","$",
                      L_LETTER_GOTHIC_BOLD_12,"<033>&a4800h+0V",
                      Str((agqMASTER:TOTAL[1]  + agqmaster:total[2] +
                           agqMASTER:SURCHARGE + agqMASTER:TERRORISM_PREMIUM),"(ZZ,ZZZ,ZZZ)")
                      ,"<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1

if scipscontrol:breakout_pliga = 1 then
    begin
    If L_TRANS_CODE One Of 11,16 Then  --these are cx transcodes
        begin
        Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s","<NL>",
                              L_ARIAL,"<033>&a4750h-40V","$",
                              L_LETTER_GOTHIC_BOLD_12,
                              Str(agqMASTER:amt_due_total[1],"(ZZ,ZZZ,ZZ9)"),L_ARIAL,
                              "<033>&a220h+0V",L_ARIAL_BOLD,
                              SCIPSCONTROL:CANCELLATION_DEFINITION)
        L_LINE_COUNTER = L_LINE_COUNTER + 1
        Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s","<NL>",
                              L_ARIAL,"<033>&a4750h+0V","$",
                              L_LETTER_GOTHIC_BOLD_12,
                              Str(agqMASTER:amt_due_total[3],"(ZZ,ZZZ,ZZ9)"),L_ARIAL,
                              "<033>&a220h+0V",L_ARIAL_BOLD,
                              scipscontrol:cancellation_definition_1)
        L_LINE_COUNTER = L_LINE_COUNTER + 1
        end

    If L_TRANS_CODE One Of 12,13 Then  --these are endorsements transcodes
        begin
        Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s","<NL>",
                              L_ARIAL,"<033>&a4750h-40V","$",
                              L_LETTER_GOTHIC_BOLD_12,
                              Str(agqMASTER:amt_due_total[1],"(ZZ,ZZZ,ZZ9)"),L_ARIAL,
                              "<033>&a220h+0V",L_ARIAL_BOLD,
                              scipscontrol:endorsement_definition)
        L_LINE_COUNTER = L_LINE_COUNTER + 1
        Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s","<NL>",
                              L_ARIAL,"<033>&a4750h+0V","$",
                              L_LETTER_GOTHIC_BOLD_12,
                              Str(agqMASTER:amt_due_total[3],"(ZZ,ZZZ,ZZ9)"),L_ARIAL,
                              "<033>&a220h+0V",L_ARIAL_BOLD,
                              scipscontrol:endorsement_definition_1)
       L_LINE_COUNTER = L_LINE_COUNTER + 1
       end

    Writefile(L_FILE_NAME,"%s","<NL>")
    L_LINE_COUNTER = L_LINE_COUNTER + 1
    end
else
    begin
    If L_TRANS_CODE One Of 11,16 Then  --these are cx transcodes
        begin
        Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s","<NL>",
                              L_ARIAL,"<033>&a4750h-40V","$",
                              L_LETTER_GOTHIC_BOLD_12,
                              Str(agqMASTER:total[20],"(ZZ,ZZZ,ZZ9)"),L_ARIAL,
                              "<033>&a220h+0V",L_ARIAL_BOLD,
                              SCIPSCONTROL:CANCELLATION_DEFINITION)
        L_LINE_COUNTER = L_LINE_COUNTER + 1
        end

    If L_TRANS_CODE One Of 12,13 Then  --these are endorsements transcodes
        begin
        Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s","<NL>",
                              L_ARIAL,"<033>&a4750h-40V","$",
                              L_LETTER_GOTHIC_BOLD_12,
                              Str(agqMASTER:total[20],"(ZZ,ZZZ,ZZ9)"),L_ARIAL,
                              "<033>&a220h+0V",L_ARIAL_BOLD,
                              scipscontrol:cancellation_definition)
        L_LINE_COUNTER = L_LINE_COUNTER + 1
       end

    Writefile(L_FILE_NAME,"%s","<NL>")
    L_LINE_COUNTER = L_LINE_COUNTER + 1
    end

If SCIPSCONTROL:WATER_BACKUP_WORDING = 1 Then -- For CCMI, Need this wording for there dec page.
  {
    Writefile(L_FILE_NAME,"%s","<NL>")
    Writefile(L_FILE_NAME,"%s","<NL>")
    L_LINE_COUNTER = L_LINE_COUNTER + 2

    If L_WATER_DAMAGE_WORDING = "Y" Then
      {
        Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
        Writefile(L_FILE_NAME,"%s","<033>&a410h+0V")
        Writefile(L_FILE_NAME,"%s","EXCEPT FOR THE COVERAGE THAT IS PROVIDED FOR WATER THAT BACKS UP THROUGH SEWERS,")
        Writefile(L_FILE_NAME,"%s","<NL>")
        L_LINE_COUNTER = L_LINE_COUNTER + 1

        Writefile(L_FILE_NAME,"%s","<033>&a560h+0V")
        Writefile(L_FILE_NAME,"%s","AND DRAINS THIS QUOTE DOES NOT PROVIDE COVERAGE FOR DAMAGE CAUSED BY FLOOD")
        Writefile(L_FILE_NAME,"%s","<NL>")
        L_LINE_COUNTER = L_LINE_COUNTER + 1
      }
    Else
      {
        Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
        Writefile(L_FILE_NAME,"%s","<033>&a896h+0V")
        Writefile(L_FILE_NAME,"%s","THIS QUOTE DOES NOT PROVIDE COVERAGE FOR DAMAGE CAUSED BY FLOOD")
        Writefile(L_FILE_NAME,"%s","<NL>")
        L_LINE_COUNTER = L_LINE_COUNTER + 1
      }
  }

Writefile(L_FILE_NAME,"%s%s%s%s","<NL>","<033>&a220h+0V<033>*c5350h5v0P","<NL>","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 3

If (L_LINE_COUNTER > (L_MAX_LINES - 8)) Then
  {
    Do INSERT_NEWPAGE
  }
Else
  {
    Writefile(L_FILE_NAME,"%s%s%s%s",L_ARIAL_BOLD,"<033>&a2400h+0V",
                      "RATING INFORMATION ","<NL>")
    L_LINE_COUNTER = L_LINE_COUNTER + 1

    --the follow access will give me the correct construction description

    Access SFSCONSTRUCTION,
       Set SFSCONSTRUCTION:COMPANY_ID = agqPERSONAL:COMPANY_ID,
           SFSCONSTRUCTION:STATE = agqPERSONAL:STATE,
           SFSCONSTRUCTION:LINE_OF_BUSINESS = agqPERSONAL:LINE_OF_BUSINESS,
           SFSCONSTRUCTION:CONSTRUCTION = agqPERSONAL:CONSTRUCTION, Exact
    If (SFSLINE:LOB_CODE One Of "DWELLING") Then
      {
        Writefile(L_FILE_NAME,"%s%s","<033>&a220h+0V",L_ARIAL_BOLD)
      }

    If (SFSLINE:LOB_CODE One Of "HOME" And
        SFSLINE:OPTION = "S") Then   --for standard homeowners
      {
        Writefile(L_FILE_NAME,"%s%s%s","<033>&a220h+0V",trun(L_ARIAL_BOLD),
                              "Standard ")
      }
    Else
      If SFSLINE:LOB_CODE One Of "HOME" And   --homeowners and preferred
         SFSLINE:OPTION = "P" Then       --agqpersonal:line_of_business = 14 Then
        {
          Writefile(L_FILE_NAME,"%s%s%s","<033>&a220h+0V",trun(L_ARIAL_BOLD),
                           "Preferred ")
        }
      Else
        If SFSLINE:LOB_CODE One Of "HOME" And  --homeowner premier
           SFSLINE:OPTION = "R" Then     --agqpersonal:line_of_business = 24 Then
          {
            Writefile(L_FILE_NAME,"%s%s%s","<033>&a220h+0V",trun(L_ARIAL_BOLD),
                                 "Premier ")
          }

      {
        Writefile(L_FILE_NAME,"%s%n%s%s%s%n%s",trun(L_ARIAL),
                           agqPERSONAL:YEAR_CONSTRUCTION,
                           " ",Trun(SFSCONSTRUCTION:DESCRIPTION),", ",
                           agqPERSONAL:NO_FAMILIES," Family Dwelling, ")
      }

    If Uppercase(SFSLINE:LOB_CODE) = "DWELLING" Then
      {
        If agqPERSONAL:OWNER_OCCUPIED = "Y" Then
          {
            Writefile(L_FILE_NAME,"%s%s",SCIPSCONTROL:SEASONAL_WORDING[1],"<NL>")
          }
        Else
          {
            Writefile(L_FILE_NAME,"%s%s",SCIPSCONTROL:SEASONAL_WORDING[2],"<NL>")
          }
       }
    If Uppercase(SFSLINE:LOB_CODE) = "HOME" Then
      {
        If (agqPERSONAL:SEASONAL = "N") Then
          {
            Writefile(L_FILE_NAME,"%s%s",SCIPSCONTROL:SEASONAL_WORDING[1],"<NL>")
          }
        Else
          {
            Writefile(L_FILE_NAME,"%s%s",SCIPSCONTROL:SEASONAL_WORDING[2],"<NL>")
          }
      }
    L_LINE_COUNTER = L_LINE_COUNTER + 1

    Access SFSPROTECTION,
       Set SFSPROTECTION:COMPANY_ID = agqPERSONAL:COMPANY_ID,
           SFSPROTECTION:STATE = agqPERSONAL:STATE,
           SFSPROTECTION:LINE_OF_BUSINESS = agqPERSONAL:LINE_OF_BUSINESS,
           SFSPROTECTION:PROTECTION = agqPERSONAL:PROTECTION, Exact

    Writefile(L_FILE_NAME,"%s%s%s%n%s%s%s%s","<033>&a220h+0V",trun(L_ARIAL),
                      "Protection Class ",agqPERSONAL:PROTECTION,", ",
                      Trun(Lowercase(SFSPROTECTION:DESCRIPTION)),",","<NL>")
    L_LINE_COUNTER = L_LINE_COUNTER + 1
    Writefile(L_FILE_NAME,"%s%s%n%s%s%s%d%s",trun("<033>&a220h+0V"),"Territory Code ",
                      agqPERSONAL:TERRITORY,",County-",toggle(trun(SFSSTATE:DESCRIPTION)),
                      " First Insured Date ",agqNAME:ORIGINAL_EFF_DATE,"<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1

    Writefile(L_FILE_NAME,"%s%s%s","<NL>","<033>&a220h+30V<033>*c5350h5v0P","<NL>")  --rating information line
    L_LINE_COUNTER = L_LINE_COUNTER + 2
  }

If (L_LINE_COUNTER > L_MAX_LINES - 6) Then
--mobile homeowner description --just checking to see if I have enough room to print it on the page.
  {
    Do INSERT_NEWPAGE
  }

If (SFSLINE:LOB_CODE = "MOBILE") Then
  {
    Writefile(L_FILE_NAME,"%s%s","<NL>","<033>&a200h+30V<033>*c5289h5v0P")  --Line for description of mobile homeowners
    Writefile(L_FILE_NAME,"%s","<033>&a200h+0V<033>*c5a300b0P")   --left vertical line for mobile homwoner description
    Writefile(L_FILE_NAME,"%s","<033>&a5479h+0V<033>*c5a300b0P")   --right vertical line for mobile homwoner description
    Writefile(L_FILE_NAME,"%s","<033>&a1500h+0V<033>*c5a300b0P")   --middle full vertical line year
    Writefile(L_FILE_NAME,"%s","<033>&a2450h+0V<033>*c5a120b0P")   --middle full vertical line length
    Writefile(L_FILE_NAME,"%s","<033>&a3450h+0V<033>*c5a120b0P")   --middle full vertical line manufacture

    Writefile(L_FILE_NAME,"%s%s%s%s%n%s%s%s%s",L_ARIAL_8,"<033>&a2500h+90V",
                         "LENGTH",
                          "<033>&a3000h+0V",agqPERSONAL:LENGTH,
                          "<033>&a3500h+0V","MANUFACTURER","<033>&a4200h+0V",
                          agqPERSONAL:MAKE)

    Writefile(L_FILE_NAME,"%s%s%s%s%n%s%s%s%s",L_ARIAL_8,"<033>&a1700h+90V",
                          "YEAR","<033>&a2100h+0V",
                          agqPERSONAL:YEAR_CONSTRUCTION,
                          "<033>&a2625h+0V","X","<033>&a2800h-30V<033>*c400h5v0P", --horizontal
                          "<033>&a4200h-0V<033>*c1210h5v0P")  --horizontal

    Writefile(L_FILE_NAME,"%s%s%s%s%s%s%n%s%s%s",L_ARIAL_8,"<033>&a220h+120V",
                          "Description of Mobile Home:","<033>&a2500h+0V",
                          "WIDTH","<033>&a3000h+V",agqPERSONAL:WIDTH,
                          "<033>&a3700h+0V","(MAKE)","<NL>")
    L_LINE_COUNTER = L_LINE_COUNTER + 2

    Writefile(L_FILE_NAME,"%s%s%s","<033>&a1500h-100V<033>*c3910h5v0P",
                          "<033>&a3200h+0V<033>*c5a110b0P",
                          "<033>&a4350h+0V<033>*c5a110b0P"  )

    Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%n%s%s%s%s%n",L_ARIAL_8,
                          "<033>&a1650h+115V","SERIAL",
                          "<033>&a3300h+0V",
                          "PURCHASE","<033>&a4950h-20V","MO","<033>&a5200h+0V",
                          agqPERSONAL:MONTH_PURCHASED,"<033>&a4930h+30V<033>*c475h5v0P",
                          "<033>&a4950h+80V","YR","<033>&a5200h+0V",
                          agqPERSONAL:YEAR_PURCHASED)

    Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s%s%s%s","<033>&a4400h-50V","PURCHASED",
                          "<033>&a3300h+60V","PRICE","<033>&a3700h+0V",
                          Str(agqPERSONAL:PURCHASE_PRICE,"$$$,$$$,$$$"),
                          "<033>&a1710h-0V","NO","<033>&a2300h+0V",
                          agqPERSONAL:SERIAL)
    Writefile(L_FILE_NAME,"%s","<033>&a1500h+60V<033>*c3910h5v0P")  --hozon line under serial no purchase price purchased

    Writefile(L_FILE_NAME,"%s%s%s%s%s%s%n%s","<NL>","<033>&a220h-0V",
                          "Rating Information:","<033>&a1650h-0V","TERR",
                          "<033>&a1950h-0V",agqPERSONAL:TERRITORY,
                          "<033>&a200h+30V<033>*c5275h5v0P")  --Line for description of mobile homeowners
  }
Writefile(L_FILE_NAME,"%s%s%s","<NL>","<NL>","<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 3

If (SCIPSCONTROL:SIGNATURE = 1) Then
  {
     --the next line of code will be used to a signature

     L_SIGNATURE_STRING = "<033>" + Trun(SCIPSCONTROL:SIGNATURE_SYMBOL_SET) +
                          "<033>" + Trun(SCIPSCONTROL:SIGNATURE_DEFINITION)

     If SCIPSCONTROL:SIGNATURE_VERT_POS[1] = "-" Then
       {
         L_VERT_POS_1 = "+" + SCIPSCONTROL:SIGNATURE_VERT_POS[2,5]
       }
     Else If SCIPSCONTROL:SIGNATURE_VERT_POS[1] = "+" Then
       {
         L_VERT_POS_1 = "-" + SCIPSCONTROL:SIGNATURE_VERT_POS[2,5]
       }

     Writefile(L_FILE_NAME,"%s","<033>&a")
     Writefile(L_FILE_NAME,"%n",SCIPSCONTROL:SIGNATURE_HOZ_POS)
     Writefile(L_FILE_NAME,"%s","h")
     Writefile(L_FILE_NAME,"%s",Trun(SCIPSCONTROL:SIGNATURE_VERT_POS))
     Writefile(L_FILE_NAME,"%s","V")
     Writefile(L_FILE_NAME,"%s",L_SIGNATURE_STRING)
     Writefile(L_FILE_NAME,"%s",Trun(SCIPSCONTROL:SIGNATURE_STRING_TO_PRINT))
     Writefile(L_FILE_NAME,"%s","<033>&a0h")
     Writefile(L_FILE_NAME,"%s",Trun(L_VERT_POS_1))
     Writefile(L_FILE_NAME,"%s","V")
  }

Writefile(L_FILE_NAME,"%s%s%s%d%s",L_ARIAL,"<033>&a220h+0V",
                         "Printed Date:",Todaysdate,"<NL>")
L_LINE_COUNTER = L_LINE_COUNTER + 1

If (L_MAX_LINES - L_LINE_COUNTER < 14) Then  --CHECKS TO MAKE SURE I
                                              --HAVE ENOUGH SPACE TO PRINT THE
                                               -- MORTGAGE INFORMATION
  {
    Do INSERT_NEWPAGE
  }
Else
  {
    If agqSUPP:app_no = L_app_no Then
      {
        Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s","<NL>","<NL>",L_ARIAL_12,
                              "<033>&a220h+0V","Mortgage Company",L_ARIAL,"<NL>")
        L_LINE_COUNTER = L_LINE_COUNTER + 3
      }
  }

While (agqSUPP:app_no = L_app_no)
  {
    If agqSUPP:MORTGAGE_ID <> "" Then
      {

    If (L_LINE_COUNTER >= L_MAX_LINES - 14) Then  --CHECKS TO MAKE SURE I HAVE ENOUGH SPACE TO PRINT THE MORTGAGE INFORMATION
     {
       Do INSERT_NEWPAGE
     }
    L_MORTGAGE_ID = agqSUPP:MORTGAGE_ID
    Access SFSMORT,
       Set SFSMORT:COMPANY_ID   = agqpersonal:company_id,
           SFSMORT:MORTGAGE_ID  = L_MORTGAGE_ID,  Exact
    L_SFSMORT_ZIP = If (Val(SFSMORT:STR_ZIPCODE[6,9]) = 0) Then
                      SFSMORT:STR_ZIPCODE[1,5]
                    Else
                      SFSMORT:STR_ZIPCODE[1,5] + "-" + SFSMORT:STR_ZIPCODE[6,9]

    Writefile(L_FILE_NAME,"%s%s%s%n%s%s%s%s%n%s","<033>&a300h+0V","Location",
                          "<033>&a825h+0V",agqSUPP:PREM_NO,"<NL>",
                          "<033>&a1550h-120V","Building","<033>&a2000h+0V",
                          agqSUPP:BUILD_NO,"<NL>")
    L_LINE_COUNTER = L_LINE_COUNTER + 2
    Writefile(L_FILE_NAME,"%s%s","<033>&a300h+0V","Interest ")
    L_COMPANY_ID      = agqpersonal:company_id
    L_MORTGAGE_TYPE_2 = agqSUPP:MORTGAGE_TYPE_2

    Access SFSMORTTYPE,
           Set SFSMORTTYPE:COMPANY_ID = L_COMPANY_ID,
               SFSMORTTYPE:MORTGAGE_CODE = L_MORTGAGE_TYPE_2, Exact
                 --access the sfsmorttype to print out firt mortgage or loss payee ...etc
    Writefile(L_FILE_NAME,"%s%s%s","<033>&a900h+0V",SFSMORTTYPE:DESCRIPTION,"<NL>")
    L_LINE_COUNTER = L_LINE_COUNTER + 1
    Writefile(L_FILE_NAME,"%s%s","<033>&a300h+0V","Name")
    For L_LOOP = 1 To 3
      {
        If (SFSMORT:NAME[L_LOOP] <> "" ) Then
          {
            Writefile(L_FILE_NAME,"%s%s%s","<033>&a900h+0V",SFSMORT:NAME[L_LOOP],
                              "<NL>")               --insured name field [1]
            L_LINE_COUNTER = L_LINE_COUNTER + 1
          }
      }
    If (agqSUPP:SUCCESSOR = "Y") Then
      {
        Writefile(L_FILE_NAME,"%s%s%s","<033>&a900h+0V",
                              Uppercase("Its Successors And/Or Assigns"),"<NL>")
        L_LINE_COUNTER = L_LINE_COUNTER + 1
      }
    If (agqSUPP:ATIMA = "Y") Then
      {
        Writefile(L_FILE_NAME,"%s%s%s","<033>&a900h+0V","ATIMA","<NL>")
        L_LINE_COUNTER = L_LINE_COUNTER + 1
      }
    Writefile(L_FILE_NAME,"%s%s","<033>&a300h+0V","Address")
    L_LINE_COUNTER = L_LINE_COUNTER + 1
    For L_LOOP = 1 To 3
      {
        If (SFSMORT:ADDRESS[L_LOOP] <> "") Then
          {
            Writefile(L_FILE_NAME,"%s%s%s","<033>&a900h-0V",
                                  SFSMORT:ADDRESS[L_LOOP],"<NL>")
            L_LINE_COUNTER = L_LINE_COUNTER + 1
          }
      }
    Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s","<033>&a900h-0V",Trun(SFSMORT:CITY),", ",
                          SFSMORT:STR_STATE," ",L_SFSMORT_ZIP,"<NL>")
    If (agqSUPP:ACCOUNT_NO <> "") Then
      {
        Writefile(L_FILE_NAME,"%s%s%s%s%s","<033>&a300h+0V","Loan # ",
                              "<033>&a900h+0V",agqSUPP:ACCOUNT_NO,"<NL>")
        L_LINE_COUNTER = L_LINE_COUNTER + 1
      }
    L_LINE_COUNTER = L_LINE_COUNTER + 2
    Writefile(L_FILE_NAME,"%s","<NL>")

      } --Not is master mortage file sfsmort using sfspsupp
  Else
    If agqSUPP:app_no = L_app_no  Then
      {

    If (L_LINE_COUNTER >= L_MAX_LINES - 14) Then  --CHECKS TO MAKE SURE I HAVE ENOUGH SPACE TO PRINT TH  MORTGAGE INFORMATION
     {
       Do INSERT_NEWPAGE
     }

            L_agqSUPP_ZIP = If (Val(agqSUPP:STR_ZIPCODE[6,9]) = 0) Then
                              agqSUPP:STR_ZIPCODE[1,5]
                            Else
                              agqSUPP:STR_ZIPCODE[1,5] + "-" +
                              agqSUPP:STR_ZIPCODE[6,9]

            Writefile(L_FILE_NAME,"%s%s%s%n%s%s%s%s%n%s","<033>&a300h+0V","Location",
                             "<033>&a825h+0V",agqSUPP:PREM_NO,"<NL>",
                             "<033>&a1550h-120V","Building","<033>&a2000h+0V",
                             agqSUPP:BUILD_NO,"<NL>")
            L_LINE_COUNTER = L_LINE_COUNTER + 2
            Writefile(L_FILE_NAME,"%s%s","<033>&a300h+0V","Interest ")
            L_COMPANY_ID      = agqpersonal:company_id
            L_MORTGAGE_TYPE_2 = agqSUPP:MORTGAGE_TYPE_2

            Access SFSMORTTYPE,
                   Set SFSMORTTYPE:COMPANY_ID = L_COMPANY_ID,
                       SFSMORTTYPE:MORTGAGE_CODE = L_MORTGAGE_TYPE_2, Exact
            --access the sfsmorttype to print out firt mortgage or loss payee ...etc
            Writefile(L_FILE_NAME,"%s%s%s","<033>&a900h+0V",
                                  SFSMORTTYPE:DESCRIPTION,"<NL>")
            L_LINE_COUNTER = L_LINE_COUNTER + 1

            Writefile(L_FILE_NAME,"%s%s","<033>&a300h+0V","Name")
            For L_LOOP = 1 To 3
              {
                If (agqSUPP:NAME[L_LOOP] <> "" ) Then
                  {
                    Writefile(L_FILE_NAME,"%s%s%s","<033>&a900h+0V",agqSUPP:NAME[L_LOOP],
                                          "<NL>")               --insured name field [l_loop]
                    L_LINE_COUNTER = L_LINE_COUNTER + 1
                  }
              }
            If (agqSUPP:SUCCESSOR = "Y") Then
              {
                Writefile(L_FILE_NAME,"%s%s%s","<033>&a900h+0V",
                                      Uppercase("Its Successors And/Or Assigns"),"<NL>")
                L_LINE_COUNTER = L_LINE_COUNTER + 1
              }
            If (agqSUPP:ATIMA = "Y") Then
              {
                Writefile(L_FILE_NAME,"%s%s%s","<033>&a900h+0V","ATIMA","<NL>")
                L_LINE_COUNTER = L_LINE_COUNTER + 1
              }
            Writefile(L_FILE_NAME,"%s%s","<033>&a300h+0V","Address")
            For L_LOOP = 1 To 3
              {
                If (agqSUPP:ADDRESS[L_LOOP] <> "") Then
                  {
                    Writefile(L_FILE_NAME,"%s%s%s","<033>&a900h-0V",
                                          agqSUPP:ADDRESS[L_LOOP],"<NL>")
                    L_LINE_COUNTER = L_LINE_COUNTER + 1
                  }
              }
            Writefile(L_FILE_NAME,"%s%s%s%s%s%s%s","<033>&a900h-0V",
                                  Trun(agqSUPP:CITY),", ",
                                  agqSUPP:STR_STATE," ",L_agqSUPP_ZIP,"<NL>")
            If (agqSUPP:ACCOUNT_NO <> "") Then
               {
                 Writefile(L_FILE_NAME,"%s%s%s%s%s","<033>&a300h+0V",
                                  "Loan # ",
                                  "<033>&a900h+0V",agqSUPP:ACCOUNT_NO,"<NL>")
                 L_LINE_COUNTER = L_LINE_COUNTER + 1
              }
            L_LINE_COUNTER = L_LINE_COUNTER + 2
            Writefile(L_FILE_NAME,"%s","<NL>")
       --  } --if with the mort
       } --if
     Next agqSUPP
   } -- while

Access SFSMESSAGE,
   Set SFSMESSAGE:COMPANY_ID       = L_COMPANY_ID,
       SFSMESSAGE:STATE            = I_STATE,
       SFSMESSAGE:LINE_OF_BUSINESS = agqpersonal:line_of_business,
       SFSMESSAGE:EFF_DATE         = L_MESSAGE_EFF_DATE,
       SFSMESSAGE:EXP_DATE         = L_MESSAGE_EXP_DATE, generic

If sfsmessage:eff_date = l_message_eff_date and
   sfsmessage:exp_date = l_message_exp_date and
   l_print_on_back = 1 then
    begin
    If ((SFSMESSAGE:NEW = 1 and
       agqmaster:trans_code = 10) or
       (SFSMESSAGE:RENEWAL = 1 and
       agqmaster:trans_code = 14) or
       (SFSMESSAGE:ENDORSEMENT = 1 and
       agqmaster:trans_code one of 12, 13) or
       (SFSMESSAGE:CANCELLATION = 1 and
       agqmaster:trans_code one of 11) or
       (SFSMESSAGE:REINSTATEMENT = 1 and
       agqmaster:trans_code one of 16) or
       SFSMESSAGE:ALL = 1) then
        begin
        If (L_LINE_COUNTER > (L_MAX_LINES - 10)) Then
            begin
            Do INSERT_NEWPAGE
            end
        Writefile(L_FILE_NAME,"%s%s%s%s%s","<NL>","<NL>","<033>&a220h-0V",L_ARIAL_BOLD_12,
                          "Important Messages")
        end
    end

If L_TRANS_CODE one of 10 and
   SFSMESSAGE:NEW = 1 and
   l_print_on_back = 1 then
  {
    If (L_LINE_COUNTER > (L_MAX_LINES - 10)) Then
      {
        Do INSERT_NEWPAGE
      }
    L_FONT             = L_ARIAL_BOLD
    L_V_POSITION       = "+120"
    L_H_POSITION       = "200"
    L_CHARACTER_STRING = SFSMESSAGE:NEW_MESSAGE
    L_MAX_CHAR         = 100
    Include "line_spacing.inc"
  }
If L_TRANS_CODE one of 11 and
   SFSMESSAGE:CANCELLATION = 1 and
   l_print_on_back = 1 then
  {
    If (L_LINE_COUNTER > (L_MAX_LINES - 10)) Then
      {
        Do INSERT_NEWPAGE
      }
    L_FONT             = L_ARIAl_BOLD
    L_V_POSITION       = "+120"
    L_H_POSITION       = "200"
    L_CHARACTER_STRING = SFSMESSAGE:CANCELLATION_MESSAGE
    L_MAX_CHAR         = 100
    Include "line_spacing.inc"
  }
If L_TRANS_CODE one of 14 and
   SFSMESSAGE:RENEWAL = 1 and
   l_print_on_back = 1 then
  {
    If (L_LINE_COUNTER > (L_MAX_LINES - 10)) Then
      {
        Do INSERT_NEWPAGE
      }
    L_FONT             = L_ARIAL_BOLD
    L_V_POSITION       = "+120"
    L_H_POSITION       = "200"
    L_CHARACTER_STRING = SFSMESSAGE:RENEWAL_MESSAGE
    L_MAX_CHAR         = 100
    Include "line_spacing.inc"
  }
If L_TRANS_CODE one of 16 and
   SFSMESSAGE:NEW = 1 and
   l_print_on_back = 1 then
  {
    If (L_LINE_COUNTER > (L_MAX_LINES - 10)) Then
      {
        Do INSERT_NEWPAGE
      }
    L_FONT             = L_ARIAL_BOLD
    L_V_POSITION       = "+120"
    L_H_POSITION       = "200"
    L_CHARACTER_STRING = SFSMESSAGE:REINSTATEMENT_MESSAGE
    L_MAX_CHAR         = 100
    Include "line_spacing.inc"
  }
If L_TRANS_CODE one of 12,13 and
   SFSMESSAGE:ENDORSEMENT = 1 and
   l_print_on_back = 1 then
  {
    If (L_LINE_COUNTER > (L_MAX_LINES - 10)) Then
      {
        Do INSERT_NEWPAGE
      }
    L_FONT             = L_ARIAL_BOLD
    L_V_POSITION       = "+120"
    L_H_POSITION       = "200"
    L_CHARACTER_STRING = SFSMESSAGE:ENDORSEMENT_MESSAGE
    L_MAX_CHAR         = 100
    Include "line_spacing.inc"
  }
If SFSMESSAGE:ALL = 1 and
   l_print_on_back = 1 then
  {
    If (L_LINE_COUNTER > (L_MAX_LINES - 10)) Then
      {
        Do INSERT_NEWPAGE
      }
    L_FONT             = L_ARIAL_BOLD
    L_V_POSITION       = "+120"
    L_H_POSITION       = "200"
    L_CHARACTER_STRING = SFSMESSAGE:ALL_MESSAGE
    L_MAX_CHAR         = 100
    Include "line_spacing.inc"
  }

--do fraud_warning


If (L_PAGE_NUMBER Mod 2 = 1) Then
  {
    --insert newpage so following copies are not printed on the back of dec
    Writefile(L_FILE_NAME,"%s","<FF>")
  }

update

Screen Exit
  writefile(l_file_name,"%s","<FF>")
  Closefile(L_FILE_NAME)


Procedure Definition

Procedure fraud_warning

Begin
  Access SCIPSFRAUD,
     Set SCIPSFRAUD:COMPANY_ID = L_COMPANY_ID, approximate

  Writefile(L_FILE_NAME,"%s",l_arial_bold_9)
  Writefile(L_FILE_NAME,"%s","<033>&a200h6700V")
  Writefile(L_FILE_NAME,"%s","FRAUD WARNING")
  Writefile(L_FILE_NAME,"%s",l_arial_bold_7)
  Writefile(L_FILE_NAME,"%s","<033>&a3200h+0V")
  Writefile(L_FILE_NAME,"%s",l_arial_8)
  Writefile(L_FILE_NAME,"%s","<033>&a200h+240V")

  l_max_lines        = 60
  L_FONT             = l_arial_8
  L_V_POSITION       = "+0"
  L_H_POSITION       = "200"
  L_CHARACTER_STRING = trun(SCIPSFRAUD:FRAUD_WARNING)
  L_MAX_CHAR         = 75
  include "line_spacing.inc"
End -- End of Fraud Procedure

Procedure INSERT_NEWPAGE

{
  Writefile(L_FILE_NAME,"%s","<FF>")
  L_LINE_COUNTER = 0
  If SCIPSCONTROL:PRINT_BORDERS_ON_DEC_PAGE = 1 Then
    {
      Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c10a3045b0P")   --left vertical li
      Writefile(L_FILE_NAME,"%s","<033>&a5585h0V<033>*c10a3045b0P")   --right vertical
      Writefile(L_FILE_NAME,"%s","<033>&a140h0V<033>*c5467h20v0P") --top horizontal line to
      Writefile(L_FILE_NAME,"%s","<033>&a140h7300V<033>*c5467h20v0P") --bottom horizontal line
    }
  L_PAGE_NUMBER = L_PAGE_NUMBER + 1
  do fraud_warning
  Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD_9)
  Writefile(L_FILE_NAME,"%s",L_ARIAL)
  Writefile(L_FILE_NAME,"%s","<033>&a4950h7200V")
  Writefile(L_FILE_NAME,"%s","Page ")
  Writefile(L_FILE_NAME,"%n",L_PAGE_NUMBER)

  Writefile(L_FILE_NAME,"%s","<033>&a220h120V")

  Writefile(L_FILE_NAME,"%s",Trun(SFSLINE:DESCRIPTION))
  Writefile(L_FILE_NAME,"%s"," QUOTE LETTER")
  Writefile(L_FILE_NAME,"%s","<033>&a4200h+0V")
  Writefile(L_FILE_NAME,"%s","Application No. ")
  Writefile(L_FILE_NAME,"%s",L_ARIAL_9)
  Writefile(L_FILE_NAME,"%n",L_app_no)

  Writefile(L_FILE_NAME,"%s%s%s","<033>&a200h+40V<033>*c5289h5v0P","<NL>","<NL>")  --HORZ LINE deductible section I coverage PG. 1
  L_LINE_COUNTER = L_LINE_COUNTER + 2
}


Procedure print_payor_codes

{
--  access agqname,
--     Set agqname:app_no = l_app_no, exact

  access agqsupp,
     Set agqsupp:app_no = l_app_no, generic


  L_BILL_PLAN = agqNAME:BILL_PLAN
  If agqSUPP:MORTGAGE_TYPE_1 = "" Then
    {
      L_MORTGAGE_TYPE_1 = " "
    }
  Else
    {
      L_MORTGAGE_TYPE_1 = agqSUPP:MORTGAGE_TYPE_1
    }
  Access SFSPAYCODE,
     Set SFSPAYCODE:COMPANY_ID      = L_COMPANY_ID,
         SFSPAYCODE:BILL_PLAN       = L_BILL_PLAN,
         SFSPAYCODE:MORTGAGE_TYPE_1 = L_MORTGAGE_TYPE_1, Generic
  Writefile(L_FILE_NAME,"%s",L_ARIAL_BOLD)
  Writefile(L_FILE_NAME,"%s","<033>&a+0h+0V")
  If l_company_id = "FARMERS" then
    {
      Writefile(L_FILE_NAME,"%s"," - ")
    }
  Writefile(L_FILE_NAME,"%s",agqNAME:BILL_PLAN)
  Writefile(L_FILE_NAME,"%s"," - ")
  Writefile(L_FILE_NAME,"%s",SFSPAYCODE:PAY_CODE)
}


End  --end of the program

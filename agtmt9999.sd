%%
Screen
        Name = "agtmt9999" ;
        Type = "Multiline" ;
        Repeat LINE_ITEMS, 40 times down ;
        Padcharacter = Space ;
        Highlight = Underscore ;
        Screensize = "dynamic" ;
--        Windowtitle = "%a    %s Location Totals - Ver. 7.00     %m" ;
        Domain = "agqamt" ;
        showunusedrecords=false
        autoscroll=true
        resizeable = yes ;
        iconline = 0 ;

        Global Unsigned Ascii Number G_app_NO[11] ;
        Global Unsigned Ascii Number G_prem_no[4] ;
        Global Unsigned Ascii Number G_build_no[4] ;
        Global Unsigned Ascii Number G_line_of_business[4] ;
        Global Unsigned Ascii Number G_vehicle_no[4] ;

        global string g_inquiry[1],
                      g_portfolio[1] ;

        local tag l_tag[8] ;

/*        local string l_user_id[15],
                     l_company_id[10] ,
                     l_enter,
                     l_first_display="Y",
                     l_vehicle_desc[30],
                     l_server_name[100],
                     l_current_web_page[50],
                     l_web_site_address[150] ,
                     l_csexec_application[25] ,
                     l_app[3] ,
                     l_private_passenger[1]="N",
                     l_dec[15] ,
                     l_name[50],
                     l_lob_code[10] ,
                     l_agqfarm[1],
                     l_agqinland[1],
                     l_agqartisan[1],
                     l_agqliability[1],
                     l_agqgeneral[1] ;

        local unsigned ascii number l_no_vehicles[4] ,
                                    l_total[9] ,
                                    l_app_no[11],
                                    l_state[2],
                                    l_csexec_number[12] ,
                                    i_csexec_number[12] ;*/

        Local unsigned ascii number l_current_dec_page_premium = 0;

        Local Unsigned Ascii Number L_TOTAL_1[8]=0,
                                    L_TOTAL_2[8]=0,
                                    L_TOTAL_3[8]=0,
                                    L_TOTAL_4[8]=0,
                                    L_TOTAL_5[8]=0,
                                    L_TOTAL_6[8]=0,
                                    L_TOTAL_7[8]=0,
                                    L_TOTAL_8[8]=0,
                                    L_TOTAL_9[8]=0,
                                    l_total_10[8]=0,
                                    l_app_no[11],
                                    l_terrorism_total[8]=0,
                                    l_reins_co[6]=0,
                                    l_rating_line_of_business[4]=0008,
                                    l_protection[2]=0,
                                    l_force_to_subject[1]=0,
                                    l_exclude_terrorism[1],
                                    l_include_prop_opt_cov[1]=0,
                                    l_include_business_income[1]=0,
                                    l_general_total[8]=0,
                                    l_include_glass[1]=0,
                                    l_include_crime[1]=0,
                                    l_include_inland_marine[1]=0,
                                    l_include_boiler[1]=0,
                                    l_include_irpm[1]=0,
                                    l_business_total[8]=0,
                                    l_mp_total[8]=0,
                                    l_liability_terrorism[8]=0,
                                    l_terror_line_of_business[4]=0011,
                                    l_property_terrorism[8]=0,
                                    l_premium_2[8]=0,
                                    l_premium_3[8]=0,
                                    l_premium_4[8]=0,
                                    l_prem_no[4]=0,
                                    l_build_no[4]=0,
                                    l_minimum_premium[4]=0,
                                    l_location_premium_10[8]=0,
                                    l_agqmaster_total_10[8]=0,
                                    l_fire_minimum_total[8]=0,
                                    l_location_premium_11[8]=0,
                                    l_rating_territory_factor[5]=0/dec=3,
                                    l_county[3]=0,
                                    L_PREM_TOTAL[8]=0,
                                    L_PROD_TOTAL[8]=0,
                                    l_artisan_prem_total[8]=0,
                                    l_artisan_prod_total[8]=0,
                                    l_farm_prem_total[8]=0,
                                    l_farm_prod_total[8]=0,
                                    l_min_total[8]=0,
                                    L_LIABILITY_TOTAL[8]=0,
                                    l_artisan_liability_total[8]=0,
                                    l_farm_liability_total[8]=0,
                                    L_PROPERTY_TOTAL[8]=0,
                                    L_PROPERTY_TOTAL_1[8]=0,
                                    l_property_total_2[8]=0,
                                    l_property_final_total[8]=0,
                                    l_business_income_final_total[8]=0,
                                    l_crime_final_total[8],
                                    l_inland_marine_final_total[8],
                                    l_liability_final_total[8]=0,
                                    l_artisan_final_total[8]=0,
                                    L_BI_TOTAL[8]=0,
                                    L_BI_TOTAL_1[8]=0,
                                    L_FIRE_TOTAL[8]=0,
                                    l_reins_fire_total[8]=0,
                                    l_reins_ecvmm_total[8]=0,
                                    l_reins_other_total[8]=0,
                                    L_EC_VMM_TOTAL[8]=0,
                                    L_OTHER_TOTAL[8]=0,
                                    L_BOILER_TOTAL[8]=0,
                                    L_FARM_FIRE_TOTAL[8]=0,
                                    L_FARM_ALLIED_TOTAL[8]=0,
                                    L_FARM_INLAND_TOTAL[8]=0,
                                    L_FARM_TOTAL[8]=0,
                                    L_OPTION_1[1]=0,
                                    L_OPTION_2[1]=0,
                                    L_OPTION_3[1]=0,
                                    L_OPTION_4[1]=0,
                                    L_OPTION_5[1]=0,
                                    L_OPTION_6[1]=0,
                                    L_OPTION_7[1]=0,
                                    L_OPTION_8[1]=0,
                                    L_OPTION_9[1]=0,
                                    l_option_10[1]=0,
                                    L_TOTAL[8]=0,
                                    L_MINIMUM[4]=0,
                                    L_STATE[2]=0,
                                    L_BOILER_PREM_TOTAL[8]=0,
                                    L_SURCHARGE_FACTOR[8]=0/decimals=6,
                                    L_SURCHARGE_MINIMUM[2]=0,
                                    L_FINAL_TOTAL[8]=0,
                                    L_LOC_TOTAL[8]=0,
                                    L_SURCHARGE[6]=0 ,
                                    L_LIMIT[8]=0,
                                    l_crime_limit[8]=0,
                                    l_inland_limit[8]=0,
                                    l_glass_limit[8]=0,
                                    L_CSEXEC_NUMBER[12] ,
                                    I_CSEXEC_NUMBER[12],
                                    L_INSTALLMENT[4]=0,
                                    L_DAYS_RATE[5]=0/decimals=4,
                                    L_PRO_RATA_PREMIUM[8]=0/decimals=4 ,
                                    l_abort_program[1],
                                    l_line_of_business[4]=08 ,
                                    l_line_of_business_1[4]=0;

        Local Signed Ascii Number L_DAYS ,
                                  l_location_new_total[8]=0,
                                  l_crime_premium[9]=0/dec=2,
                                  L_FINAL_TOTAL_1[8]=0,
                                  L_FINAL_TOTAL_2[8]=0,
                                  L_FINAL_TOTAL_3[8]=0,
                                  l_subline_percent[10]=0/dec=4 ,
                                  l_final_total_4[8]=0,
                                  L_IRPM_TOTAL[8]=0,
                                  l_reins_irpm_total[8]=0,
                                  l_irpm_property[8]=0,
                                  l_irpm_liability[8]=0,
                                  l_irpm_inland[8]=0,
                                  l_irpm_crime[8]=0,
                                  l_irpm_glass[8]=0,
                                  l_location_irpm_prop[8]=0,
                                  l_location_irpm_liab[8]=0,
                                  l_location_irpm_crime[8]=0,
                                  l_location_irpm_diff[8]=0,
                                  l_total_all_irpm[8]=0,
                                  l_irpm_difference[8]=0,
                                  l_package[4]=0/dec=2,
                                  l_deviation[4]=0/dec=2,
                                  l_optional_coverages[8]=0,
                                  l_end_premium[6]=0,
                                  l_misc_premium[6]=0,
                                  l_irpm[8]=0/dec=4 ,
                                  l_irpm_1[8]=0/dec=4 ;

        local wdate l_eff_date ;

        Local String L_TYPE[1] ,
                     L_CSEXEC_APPLICATION[25]="" ,
                     l_fob[1],
                     l_fob_desc[50],
                     l_server_name[100],
                     l_current_web_page[50],
                     l_web_site_address[150] ,
                     l_continue_2[3],
                     l_user_id[15],
                     l_fob_description[50],
                     l_fob_description1[75],
                     l_lob_end_code[1]="",
                     l_name[50],
                     l_agqgeneral[1]="N",
                     l_form_business[50],
                     l_agqliability[1]="N",
                     l_agqartisan[1]="N",
                     l_agqfarm[1]="N",
                     l_agqinland[1]="N",
                     l_key_risk[1]="N",
                     L_COMMANDLINE[8],
                     l_commandline_1[15],
                     l_str_state[2],
                     l_zip_code_5[5],
                     L_APP[3]="agq",
                     L_DEC[15],
                     l_company_id[10],
                     l_minimum_applies[1]="N",
                     L_FORM_EDITION[25],
                     l_system_id[15],
                     l_First[1]="Y",
                     l_first_1[1]="Y",
                     L_DESCRIPTION[75],
                     l_mp_1="N",
                     l_mp_2="N",
                     l_mp_3="N",
                     l_mp_4="N",
                     l_mp_5="N",
                     l_mp_6="N",
                     l_mp_7="N",
                     L_SCREEN[11] ,
                     l_screen_1[8],
                     l_joinit_dec[15],
                     L_CODE[7],
                     L_PRO_RATE="PRO RATA" ,
                     l_private_passenger[1]="N";

        Local Date L_EFF_DATE_1[8] ,
                   l_surcharge_date[8] ;

        Local Mmddyyyy Date L_CORRECT_DATE[8] ;
        Local String L_FIRST_TIME[1]="Y";
        Unsigned Ascii Number L_HOLD_PAYMENT_PLAN[4]=0;
        Signed Ascii Number L_SUB_TOTAL[9]=0/decimals=2;
        Local Unsigned Ascii Number L_OPT[1]=0 ;

        Local Signed Ascii Number  l_reins_premium[9]=0 ,
                                   l_reins_total[9]=0,
                                   l_premium[9]=0 ,
                                   l_premium_1[9]=0 ,
                                   l_irpm_reins_total[9]=0 ;

        Local Unsigned Ascii Number l_reins_factor[5]=0/dec=4,
                                    l_reins_limit[8]=0,
                                    l_reins_limit1[8]=0 ,
                                    l_property_limit[8]=0,
                                    l_key_risk_limit[8]=0,
                                    l_key_risk_prem_no[4]=0,
                                    l_key_risk_build_no[4]=0,
                                    l_business_income_limit[8]=0;

        Unsigned Ascii Number L_TERRORISM_PREMIUM[8]/decimals =0,
                              l_loop[4];
        Unsigned Ascii Number L_general_TERRORISM_PREMIUM[8]/decimals =0;
        Unsigned Ascii Number L_TERROR_PERCENTAGE[5]/decimals=4;
        Unsigned Ascii Number L_TERROR_MINIMUM[3];
        Unsigned Ascii Number L_FOUND[1];
        Unsigned Ascii Number L_SUB_CODE[4];

        Wdate L_TERROR_EFF_DATE;

        Include "print.var"

        Include "virtualdecs.var"

        Access agqamt, Set agqamt:app_NO = G_app_NO, generic ;

        scrollmessage = "" ;

        Include "stdkeys7.inc"

Style definition

                include "styles.inc"
                Displayonly Field Style {
                                  backgroundcolor="#CCCCCC"
                                }
                repeated displayonly field style {backgroundcolor="#CCCCCC"
                                }


Functions

        "redisplay" display/noreturn "agtmt9999" ;

        "func1" display/noreturn "agtmt100"  tagged bop_fn ;
        "func2" display/noreturn "agtmt8000" tagged cpp_fn ;
        "func3" sequence "auto" tagged auto_fn ;
        "auto" continue begin
                        access agqvehicle, set agqvehicle:app_no = g_app_no, generic

                        g_vehicle_no = 0
                        if agqvehicle:app_no = g_app_no then
                            l_screen_1 = "agtmt401"
                        else
                            l_screen_1 = "agtmt400"
                        function = "popup"
                        end ;
        "popup" display/noreturn l_screen_1 ;
        "func4" display/noreturn "agtmt4000" tagged work_fn ;
        "func5" sequence "cumb" tagged umbrella_fn ;
        "cumb" continue begin
                        Error "All Commercial Umbrella quotes must be referred to your underwriter"
                        end ;
        "func6" display/noreturn "agtmt9999a" tagged submit_fn ;

        "func7" sequence "worksheet"  tagged worksheet_fn ;
        "worksheet" continue begin
                             do create_macro
                             end  ;

        "func8" sequence "quoteletter"  tagged quote_letter_fn ;
        "quoteletter" continue
                          begin
                             do print_quote_letter
                             do print_portfolio_decs
                               end ;

        add/autoupdate tagged add_fn ;
        "back" display/noreturn "agtmt001"  tagged back_fn;

        Include "stdfunc7.inc"

        reaccess ;

EVENT DEFINITION
        default eventhandler {
                                "REMOVE_SCREEN"  { function = "exit" abort () }
--                                "set_info_box" { setproperty(display_information_box, text, event.value) }
                             }

        eventHandler {
                  mousedoubleclicked {
                                       function = "select" abort()}
                                     } tagged t_listbox_field_event


Toolbar Definition
-- needs to be blank

Screen Entry
access agqname, set agqname:app_no = g_app_no, generic

access agqmaster, set agqmaster:app_no = g_app_no, generic

access sfsdefault, set sfsdefault:sfs_code = "SFS", generic

l_user_id = username
access sfsemail, set sfsemail:company_id = sfsdefault:company_id,
                     sfsemail:user_id    = l_user_id, generic

if agqname:quote_no <> 0 and
   agqname:company_id <> "FARMERS" then
    disable(submit_fn)

if agqname:quote_no <> 0 and
   sfsemail:agent_no <> 0 and
   sfsdefault:company_id = "FARMERS" then
    disable(submit_fn)

access agqgeneral1,
   set agqgeneral1:app_no = g_app_no, generic

if agqgeneral1:app_no <> 0 then
begin
while agqgeneral1:app_no = g_app_no
    begin
    access cpsgroupi, set cpsgroupi:company_id       = agqgeneral1:company_id,
                          cpsgroupi:state            = agqgeneral1:state,
                          cpsgroupi:line_of_business = agqgeneral1:rating_line_of_business,
                          cpsgroupi:class_code       = agqgeneral1:class_code, generic

    if cpsgroupi:class_code <> agqgeneral1:class_code and
       agqgeneral1:app_no = g_app_no and
       agqgeneral1:new_rate[1] = 0 then
        begin
        disable(worksheet_fn)
        disable(submit_fn)
        disable(quote_letter_fn)
        end

    next agqgeneral1
    end
end

Access SFSLINE, Set SFSLINE:COMPANY_ID = agqname:company_id,
                    SFSLINE:LINE_OF_BUSINESS = agqname:line_of_business,
                    SFSLINE:LOB_SUBLINE = "00",Generic

setproperty(t_line_of_business,iconname,"")

if sfsdefault:company_id one of "FLEMINGTON" then
    hide(farmers_fn)
else
if sfsdefault:company_id one of "FARMERS" then
    hide(ficof_fn)
else
if sfsdefault:company_id one of "LEBINS" then
    begin
    hide(farmers_fn)
    hide(ficof_fn)
    end

l_username = username
l_company_id = sfsdefault:company_id

access sfsprofile,
   set sfsprofile:user_id  = l_username, exact

If SFSPROFILE:USER_ID <> L_USERNAME Then
  Begin
    L_USERNAME = "default"
    Access SFSPROFILE, Set SFSPROFILE:USER_ID = L_USERNAME, Exact
  End

if l_company_id = "FLEMINGTON" then
    begin
    l_server_name = sfsprofile:UNIX_SERVER
    l_current_web_page = "020webhelp_agtmt9999_scr_proposal_summary.htm"
    do change_current_browser(l_server_name,l_current_web_page)
    end

if agqamt:lob_totals[1] = 0 and
   agqamt:lob_totals[2] = 0 and
   agqamt:lob_totals[3] = 0 and
   agqamt:lob_totals[4] = 0 and
   agqamt:lob_totals[5] = 0 then
    begin
    disable(worksheet_fn)
    disable(quote_letter_fn)
    disable(submit_info)
    hide(totals)
    hide(location_info)
    end
else
    hide(first_time_info)

l_line_of_business = agqname:line_of_business
access sfsline, set sfsline:company_id = sfsdefault:company_id,
                    sfsline:line_of_business = l_line_of_business,
                    sfsline:lob_subline = "00", generic

if agqamt:app_no = 0 then
    function = "ADD"

Access Validation
If agqamt:app_NO <> G_app_NO Then
    Error 1000 ;

screen at 1,1 to 30,100
Properties
        {
        Layouttype = screen
        transparent = False
        backgroundcolor = "#ADD8E6"
        scrollbarpolicy = always
        }
{

    Panel at 1,1 to 2,100
        Properties
            {
            layouttype = screen
            }
        {
        components
            guidetext at 1,1 to 2,40
                properties
                    {
                    iconname = "qp_logo.gif"
                    }
            guidetext at 1,83 to 2,100 tagged ficof_fn
                properties
                    {
                    iconname = "ficof_logo.gif"
                    }
            guidetext at 1,83 to 2,100 tagged farmers_fn
                properties
                    {
                    iconname = "salem_logo.gif"
                    }
            guidetext at 1,35 to 2,100 tagged t_line_of_business
                Properties
                   {
                   iconname = ""
                   }

        }

panel at 3,1 to 4,100
Properties
        {
        LayoutType = screen
        backgroundcolor = "Grey"
        transparent = False
        }
{
components
          guidetext at 1.45,1 to 1.45,40     tagged display_information_box
                properties
                  {
                    text = "Portfolio..."
                    fontsize = 18
                    fontstyle = BOLD
                    transparent = False
                    fontname = "arial"
                    backgroundcolor = "Grey"
                  }
        event
                {
                mouseclicked = ""
                }

}

Panel at 3.45,75 to 4.45, 100 Tagged quote_no
Properties
        {
          LayoutType = screen
        }
{
%%
App No: ___________

%%
fields
101     begin
        if function one of "ADD" and
           agqamt:app_no = 0 and
           g_app_no = 0 then
            begin
            do access_sfscsexec
            agqamt:app_no = i_csexec_number
            g_app_no         = i_csexec_number
            l_app_no         = i_csexec_number
            access agqmaster, set agqmaster:app_no = g_app_no, generic

            if agqmaster:app_no <> g_app_no then
                begin
                add agqmaster
                    begin
                    agqmaster:app_no = g_app_no
                    agqmaster:state  = sfsdefault:state
                    end
                end

            l_user_id = username
            access sfsemail, set sfsemail:company_id = sfsdefault:company_id,
                                 sfsemail:user_id    = l_user_id, generic

            access agqname, set agqname:app_no = g_app_no, generic

            if agqname:app_no <> g_app_no then
                begin
                add agqname
                    begin
                    agqname:app_no           = g_app_no
                    agqname:company_id       = sfsdefault:company_id
                    agqname:agent_no         = sfsemail:agent_no
                    agqname:line_of_business = g_line_of_business
                    if agqname:agent_no = 0 then
                        agqname:agent_No = 9999
                    end
                end
            end
        end
        agqamt:APP_NO/displayonly ;

}

Panel at 7,1 to 7,100 Tagged icon_line2_tg
Properties
        {
          LayoutType = screen
--          Transparent = False
--          backgroundcolor = "#ADD8E6"
        }
{
Components


/*        Button at 1.5,5   tagged worksheet_fn
        Properties {
                Iconname = "btn_view_print_worksheet.bmp"
                }
        Events  {
                Action = worksheet_fn
                }                    */

        Button at 1,35 tagged accept_fn
            properties {
                       Iconname = "btn_accept_edits.bmp"
                       }
            Events     {
                       mouseclicked = accept
                       }


        Button at 1,5   tagged change_fn
        Properties {
                Iconname = "btn_edit.bmp"
                }
        Events  {
                Action = change_fn
                }

        Button at 1,60 tagged quote_letter_fn
        Properties {
                Iconname = "btn_view_print_proposal.bmp"
                }
        Events  {
                Action = quote_letter_fn
                }
    }

/*Panel at 7,35 to 7,65
    Properties {
               layouttype = row
               }
    {
    Components
        Button at 1,55 tagged accept_fn
            properties {
                       Iconname = "btn_accept_edits.bmp"
                       }
            Events     {
                       mouseclicked = accept
                       }

    } */

    Panel at 5,94 to 6,96 tagged button_panel
        Properties
            {
            layouttype = column
            }
        {
        Components
            Button to 1,1
                properties
                    {
                    Iconname = "btn_print_screen.bmp"
                    }
                events
                    {
                    action
                        {
                        function = "print"
                        abort()
                        }
                    }

        }


   Panel at 6.45,92
        Properties
            {
            layouttype = column
            }
      {
        Components
            guidetext to 1,1
                properties
                    {
                      text = "agtmt9999.sd"
                      fontsize = 9
                    }

      }

-- draw a line
panel at 8,1 to 8,100 tagged line_panel_1
    {
    Components
        line at 1,1 to 1,100
            Properties
                {
                Linestyle = embossed
                Linewidth = 5
                Backgroundcolor = "black"
                }
    }


Panel at 9,2 to 9,100
Properties
        {
          LayoutType = screen
        }
{
%%
  Effective Date: __________  Entity: _ ____________________________________________

%%

fields
101     begin
        if function one of "ADD", "CHANGE" then
            begin
            enable(accept_fn)
            disable(back_fn)
            end
        else
            begin
            disable(accept_fn)
            enable(back_fn)
            end

        if function one of "ADD", "NEW", "CHANGE", "CHG" then
            {
            if l_company_id = "FLEMINGTON" then
                begin
                l_current_web_page = "004webhelp_agtmt401_scr_rating_info_tbx_eff_date.htm"
                do change_current_browser(l_server_name,l_current_web_page)
                end
            }
        if function one of "ADD", "NEW" then
            begin
            if agqamt:eff_date = 0 then
                agqamt:eff_date = todaysdate
            end
        end
        agqamt:eff_date/tabstop/default mandatory
        if agqamt:eff_date < todaysdate - 30 then
            error "The effective date can not be more than 30 days from todaysdate" ;
102     begin
        if function one of "ADD", "NEW", "CHANGE", "CHG" then
            {
            if l_company_id = "FLEMINGTON" then
                begin
                l_current_web_page = "005webhelp_agtmt401_scr_rating_info_dbx_fob.htm"
                do change_current_browser(l_server_name,l_current_web_page)
                end
            }
        l_fob = agqamt:form_of_business
        l_company_id = sfsdefault:company_id
        access sfsfob, set sfsfob:company_id       = l_company_id,
                           sfsfob:form_of_business = agqamt:form_of_business, generic

        access sfsfob, set sfsfob:company_id = l_company_id, approximate

        access agqmaster, set agqmaster:app_no = g_app_no, generic

        if agqamt:form_of_business <> "" then
            begin
            access sfsfob, set sfsfob:company_id       = l_company_id,
                               sfsfob:form_of_business = agqamt:form_of_business, generic

            l_form_business    = agqamt:form_of_business
            l_fob_description  = sfsfob:description
            l_fob_description1 = agqamt:fob_description
            end

        access sfsfob_alias, set sfsfob_alias:company_id = l_company_id, generic

        l_fob_desc = sfsfob:description

        if agqamt:form_of_business = "" then
            activehelp()
        end
        agqamt:form_of_business/default/tabstop/uppercase mandatory
        access sfsfob, set sfsfob:company_id       = l_company_id,
                           sfsfob:form_of_business = agqamt:form_of_business, generic

        if agqamt:form_of_business <> sfsfob:form_of_business then
            error "Invalid Entity Entered"
--        if l_fob <> agqamt:form_of_business or
--           l_fob_desc <> l_fob_description then
--            begin
--            l_form_business = sfsfob:form_of_business
--            if l_form_business <> "T" then
--                l_fob_description1 = ""
--            end

        activehelp sfsfob_alias:form_of_business,
                   sfsfob_alias:description;
103     begin
        if function one of "ADD", "NEW", "CHANGE", "CHG" then
            {
            if l_company_id = "FLEMINGTON" then
                begin
                l_current_web_page = "006webhelp_agtmt401_scr_rating_info_tbx_fob_other.htm"
                do change_current_browser(l_server_name,l_current_web_page)
                end
            }
        end
        sfsfob:description/default/tabstop/uppercase
        hide if agqamt:form_of_business one of "T" ;
103     agqamt:fob_description
        hide if agqamt:form_of_business not one of "T" ;

}

Panel at 10,2 to 11,100
Properties
        {
          LayoutType = screen
        }
{
%%
    Insured Name: __________________________________________________

%%

fields
101     begin
            do update_agqmaster
        end
        agqamt:name/default/uppercase/tabstop mandatory;

}

-- draw a line
panel at 12,1 to 12,100 tagged line_panel_1
    {
    Components
        line at 1,1 to 1,100
            Properties
                {
                Linestyle = embossed
                Linewidth = 5
                Backgroundcolor = "black"
                }
    }


Panel at 13,3 to 14,95   tagged location_info
        Properties {
                LayoutType = screen
        }
        {
         Components
           guidetext at 2,2 to 2,15
             properties
               {
                 fontstyle = bold
                 text = "Businessowners"
                 fontsize = 12
                 fontname = "arial"
               }
           guidetext at 1,18 to 1,36
             properties
               {
                 text = "Commercial Monoline"
                 fontstyle = bold
                 fontsize = 12
                 fontname = "arial"
               }
           guidetext at 2,38 to 2,52
             properties
               {
                 text = "Commercial Auto"
                 fontstyle = bold
                 fontsize = 12
                 fontname = "arial"
               }
           guidetext at 2,54 to 2,73
             properties
               {
                 text = "Workers Compensation"
                 fontstyle = bold
                 fontsize = 12
                 fontname = "arial"
               }
           guidetext at 2,75 to 2,93
             properties
               {
                 text = "Commercial Umbrella"
                 fontstyle = bold
                 fontsize = 12
                 fontname = "arial"
               }
           guidetext at 2,18 to 2,36
             properties
               {
                 text = "       or Multi Peril"
                 fontstyle = bold
                 fontsize = 12
                 fontname = "arial"
               }

        }

scrollpanel at 15,3 to 15,100 tagged location_info
properties
        {
--        scrollbarpolicy = asneeded
        }
{

Panel
properties
        {
--        scrollbarpolicy = asneeded
        }
{
%%
  __________       __________         __________        __________           _________

%%

components

fields
0101    agqamt:lob_totals[5] + agqamt:lob_terrorism[5]/displayonly       tagged LINE_ITEMS ;
0102    agqamt:lob_totals[2] + agqamt:lob_terrorism[2]/displayonly       tagged LINE_ITEMS ;
0103    agqamt:lob_totals[1] + agqamt:lob_terrorism[1]/displayonly       tagged LINE_ITEMS ;
0104    agqamt:lob_totals[3] + agqamt:lob_terrorism[3]/displayonly       tagged LINE_ITEMS ;
0105    agqamt:lob_totals[4] + agqamt:lob_terrorism[4]/displayonly       tagged LINE_ITEMS ;

}

}

panel at 18,1 to 18,100 tagged totals
    {
    Components
        line at 1,1 to 1,100
            Properties
                {
                Linestyle = embossed
                Linewidth = 5
                Backgroundcolor = "black"
                }
    }


Panel at 19,1 to 19,100 Tagged totals
Properties
        {
        Scrollbarpolicy    = asneeded
        foregroundcolor    = "blue"
        }
event
        {
        mouseclicked = ""
        }
{
%%
                              Policy Premium:  ___________
%%

components

fields
101     begin
        access agqamt, set agqamt:app_no = g_app_no, generic

        l_total = 0
        if agqamt:app_no = g_app_no then
            begin
            l_total = agqamt:lob_totals[1] +
                      agqamt:lob_totals[2] +
                      agqamt:lob_totals[3] +
                      agqamt:lob_totals[4] +
                      agqamt:lob_totals[5] +
                      agqamt:lob_terrorism[1] +
                      agqamt:lob_terrorism[2] +
                      agqamt:lob_terrorism[3] +
                      agqamt:lob_terrorism[4] +
                      agqamt:lob_terrorism[5] +
                      l_total
            end
        do update_agqmastsupp
        l_tag = tag("totals_fn")
        setproperty(l_tag,foregroundcolor,"blue")
        end
        l_total/displayonly/mask="ZZZ,ZZZ,ZZZ.99" tagged totals_fn;

}

panel at 14,15 to 16,85 tagged first_time_info
Properties
        {
        LayoutType = screen
        backgroundcolor = "Grey"
        transparent = False
        }
{
components
          guidetext at 2,1
                properties
                  {
                    text = "     To start a quote select one of the coverage buttons below"
                    fontsize = 18
                    fontstyle = BOLD
                    transparent = False
                    fontname = "arial"
                    backgroundcolor = "Grey"
                  }
        event
                {
                mouseclicked = ""
                }

}

panel at 20,1 to 31,100
Properties
        {
--        LayoutType = screen
--        transparent = False
        scrollbarpolicy = asneeded
--        backgroundcolor = "#ADD8E6"
        }
{

panel at 1,1 to 1,100--20,1 to 20,100 tagged line_panel_1
    {
    Components
        line at 1,1 to 1,100
            Properties
                {
                Linestyle = embossed
                Linewidth = 5
                Backgroundcolor = "black"
                }
    }


Panel at 2,2 to 4,27 tagged bop_fn   --21,2 to 23,27 Tagged bop_fn
Properties
        {
        LayoutType = column
        }
{
Components
        Button at 1,1   tagged bop_fn
            Properties
                {
                Iconname = "lebins_bop.bmp"
                }
            Events
                {
                Action = bop_fn
                }
        }

Panel at 2,36 to 4,60 tagged cpp_fn-- 21,36 to 23,60 Tagged cpp_fn
Properties
        {
        LayoutType = column
        }
{
Components
        Button at 1,1    tagged cpp_fn
        Properties {
                Iconname = "lebins_cpp.bmp"
                }
        Events  {
                Action = cpp_fn
                }

}

Panel at 2,70 to 4,95 tagged auto_fn--21,70 to 23,95 Tagged auto_fn
Properties
        {
        LayoutType = column
        }
{
Components
        Button at 1,1    tagged auto_fn
        Properties {
                Iconname = "lebins_auto.bmp"
                }
        Events  {
                Action = auto_fn
                }

}

Panel at 6,15 to 8,35 tagged work_fn--25,15 to 27,35 Tagged work_fn
Properties
        {
        LayoutType = column
        }
{
Components
        Button at 1,1    tagged work_fn
        Properties {
                Iconname = "lebins_wc.bmp"
                }
        Events  {
                Action = work_fn
                }

}

Panel at 6,55 to 8,80 tagged umbrella_fn--25,55 to 27,80 Tagged umbrella_fn
Properties
        {
        LayoutType = column
        }
{
Components
        Button at 1,1     tagged umbrella_fn
        Properties {
                Iconname = "lebins_comm_umbrella.bmp"
                }
        Events  {
                Action = umbrella_fn
                }

}


panel at 9,1 to 9,100--28,1 to 28,100 tagged line_panel_1
    {
    Components
        line at 1,1 to 1,100
            Properties
                {
                Linestyle = embossed
                Linewidth = 5
                Backgroundcolor = "black"
                }
    }


Panel at 10,5 to 10,100--29,5 to 29,100 Tagged icon_line2_tg
Properties
        {
        LayoutType = screen
        }
{
Components
        Button at 1,1   tagged back_fn
        Properties {
                Iconname = "btn_back_to_main_screen.bmp"
                }
        Events  {
                Action {
                          l_continue_2 = dialog("EXITING","warning.bmp","You are about to leave the application, Do you wish to continue","Yes","No")
                          if l_continue_2 = "Yes" then
                              begin
                              function = "back"
                              abort()
                              end
                       }
                }

}

Panel at 10,70 to 10,100 tagged ficof_fn
Properties
        {
        LayoutType = screen
        }
{
Components
        Button at 1,1   tagged submit_info
        Properties {
  --              Text = "Submit to Underwriting"
                Iconname = "btn_app_entry.bmp"
                }
        Events  {
                Action = submit_fn
                }

}

Panel at 10,70 to 10,100 tagged farmers_fn
Properties
        {
        LayoutType = screen
        }
{
Components
        Button at 1,1   tagged submit_info
        Properties {
  --              Text = "Submit to Underwriting"
                Iconname = "btn_app_entry.bmp"
                }
        Events  {
                Action = submit_fn
                }

}

Panel at 10,60 to 13,90 tagged lebins_fn
Properties
        {
        LayoutType = column
        }
{
Components
        Button at 1,1   tagged submit_info
        Properties {
  --              Text = "Submit to Underwriting"
                Iconname = "btn_app_entry_lebins.bmp"
                }
        Events  {
                Action = submit_fn
                }

}

}

panel at 30,1 to 34,100 tagged ficof_fn

Properties
        {
          LayoutType = screen
--          Transparent = False
          backgroundcolor = "white"
        }
{
      Components
         browser at 1,1 to 7,100  tagged helper_tg
             properties {
                          url = ""
                        }
}

}

update
if abort = "YES" then
    begin
    function = "back"
    end

if updateok = "YES" and
   abort = "NO" then
    begin
    enable(back_fn)
    enable(submit_fn)
    function = "redisplay"
    end

procedure definition

Procedure print_quote_letter
Begin
L_CSEXEC_APPLICATION = "PRINT"/raw

Access SFSCSEXEC,
   Set SFSCSEXEC:APPLICATION = L_CSEXEC_APPLICATION , Exact

If SFSCSEXEC:APPLICATION_NUMBER = 0 Then
    Begin
    L_CSEXEC_NUMBER = 99999
    End
Else
    Begin
    L_CSEXEC_NUMBER = SFSCSEXEC:APPLICATION_NUMBER + 1

    Change SFSCSEXEC
        Begin
        SFSCSEXEC:APPLICATION_NUMBER = L_CSEXEC_NUMBER
        End
    End

l_app           = "agq"
I_CSEXEC_NUMBER = L_CSEXEC_NUMBER
L_DEC           = L_APP+Str(I_CSEXEC_NUMBER)+".cq"
L_DEC_PDF       = L_APP+Str(I_CSEXEC_NUMBER)+".pdf"

access agqamt,
   set agqamt:app_no = g_app_no, generic

if agqamt:app_no = g_app_no then
    begin
    proc("cli csbatch agqmso9999 %s",str(g_app_no,11))/noconsole
    Proc("cli joinit agqmso9999.cq %s<nl>",l_dec)/noconsole
    end

----bop dec
l_current_dec_page_premium[5] = agqamt:lob_totals[5] + agqamt:lob_terrorism[5]
If l_current_dec_page_premium[5] <> 0 then
  Begin
    proc("cli csbatch agqmso001 %s",str(g_app_no,11))/noconsole
    Proc("cli joinit agqmso001.cq %s<nl>",l_dec)/noconsole
   end

----cpp decs
l_current_dec_page_premium[2] = agqamt:lob_totals[2] + agqamt:lob_terrorism[2]
If l_current_dec_page_premium[2] <> 0 then
  Begin
    proc("cli csbatch agqmso8000 %s",str(g_app_no,11))/noconsole
    Proc("cli joinit agqmso8000.cq %s<nl>",l_dec)/noconsole

    proc("cli csbatch agqmso8000a %s",str(g_app_no,11))/noconsole
    Proc("cli joinit agqmso8000a.cq %s<nl>",l_dec)/noconsole

    proc("cli csbatch agqmso8000b %s",str(g_app_no,11))/noconsole
    Proc("cli joinit agqmso8000b.cq %s<nl>",l_dec)/noconsole

    proc("cli csbatch agqmso8000c %s",str(g_app_no,11))/noconsole
    Proc("cli joinit agqmso8000c.cq %s<nl>",l_dec)/noconsole

    proc("cli csbatch agqmso8000d %s",str(g_app_no,11))/noconsole
    Proc("cli joinit agqmso8000d.cq %s<nl>",l_dec)/noconsole
  end

---auto dec
l_current_dec_page_premium[1] = agqamt:lob_totals[1] + agqamt:lob_terrorism[1]
If l_current_dec_page_premium[1] <> 0 then
  Begin
    proc("cli csbatch agqmso006 %s",str(g_app_no,11))/noconsole
    Proc("cli joinit agqmso006.cq %s<nl>",l_dec)/noconsole
  end

--workers comp dec
l_current_dec_page_premium[4] = agqamt:lob_totals[4] + agqamt:lob_terrorism[4]
If l_current_dec_page_premium[4] <> 0 then
  Begin
    proc("cli csbatch agqmso4000 %s",str(g_app_no,11))/noconsole
    Proc("cli joinit agqmso4000.cq %s<nl>",l_dec)/noconsole
  end


L_USERNAME = Trun(USERNAME)

Access SFSPROFILE, Set SFSPROFILE:USER_ID = L_USERNAME, Exact

If SFSPROFILE:USER_ID <> L_USERNAME Then
    Begin
    L_USERNAME = "default"
    Access SFSPROFILE, Set SFSPROFILE:USER_ID = L_USERNAME, Exact
    End

L_UNIX_PATH   = SFSPROFILE:UNIX_PATH/raw
L_UNIX_SERVER = SFSPROFILE:UNIX_SERVER/raw
L_CLIENT_PATH = SFSPROFILE:CLIENT_PATH/raw

access sfscompany, set sfscompany:company_id = sfsdefault:company_id, generic

If SFSCOMPANY:DEBUG_MODE = 0 Then
    Begin
    Proc("pcl2pdf -letter -csize -ra %s %s ",L_DEC, L_DEC_PDF)/noconsole
    Proc("chmod 777 %s ",L_DEC_PDF)/noconsole
    Proc("mv %s %s %s", L_DEC_PDF," ",Trun(L_UNIX_PATH))/noconsole
    End
Else
    Begin
    Proc("pcl2pdf -letter -csize -ra %s %s ",L_DEC, L_DEC_PDF)
    Proc("chmod 777 %s ",L_DEC_PDF)
    Proc("mv %s %s %s", L_DEC_PDF," ",Trun(L_UNIX_PATH))
    End

Proc("%s %s%s",L_CLIENT_PATH,Trun(L_UNIX_SERVER),Trun(L_DEC_PDF))/client

do print_portfolio_decs

End

Procedure print_portfolio_decs
Begin
--  local unsigned ascii l_current_dec_page_premium[5] = 0;
  For l_loop = 1 to 5
    {
      l_current_dec_page_premium[l_loop] = agqamt:lob_totals[l_loop] + agqamt:lob_terrorism[l_loop]
      Switch (l_loop)
        case 1 : Begin --auto
                   If l_current_dec_page_premium[l_loop] <> 0 then
                     Begin
                       do print_auto_dec
                     End
                 end
        case 2 : Begin --cpp
      l_current_dec_page_premium[l_loop] = agqamt:lob_totals[l_loop] + agqamt:lob_terrorism[l_loop]
                   If l_current_dec_page_premium[l_loop] <> 0 then
                     Begin
                       do print_cpp_dec
                     End
                 end
        case 3 : Begin --workers comp
      l_current_dec_page_premium[l_loop] = agqamt:lob_totals[l_loop] + agqamt:lob_terrorism[l_loop]
                   If l_current_dec_page_premium[l_loop] <> 0 then
                     Begin
                       do print_workers_comp_dec
                     End
                 end
        case 4 : Begin --umbrella
      l_current_dec_page_premium[l_loop] = agqamt:lob_totals[l_loop] + agqamt:lob_terrorism[l_loop]
                   If l_current_dec_page_premium[l_loop] <> 0 then
                     Begin
--                       do print_umbrella_dec
                     End
                 end
        case 5 : Begin --bop
      l_current_dec_page_premium[l_loop] = agqamt:lob_totals[l_loop] + agqamt:lob_terrorism[l_loop]
                   If l_current_dec_page_premium[5] <> 0 then
                     Begin
                       do print_bop_dec
                     End
                 end
      end
    }


end

procedure update_agqmastsupp
begin
access agqmastsupp, set agqmastsupp:app_no = g_app_no, generic

access agqamt, set agqamt:app_no = g_app_no, generic

while agqmastsupp:app_no = g_app_no
    begin
    if agqmastsupp:line_of_business one of 2, 6, 8, 11, 13 and
       agqmastsupp:line_of_business <> agqamt:line_of_business[2] then
        delete agqmastsupp

    if agqmastsupp:line_of_business one of 9 and
       agqmastsupp:line_of_business <> agqamt:line_of_business[3] then
        delete agqmastsupp

    if agqmastsupp:line_of_business one of 5 and
       agqmastsupp:line_of_business <> agqamt:line_of_business[5] then
        delete agqmastsupp

    if agqmastsupp:line_of_business one of 15 and
       agqmastsupp:line_of_business <> agqamt:line_of_business[1] then
        delete agqmastsupp

    if agqmastsupp:line_of_business one of 7 and
       agqmastsupp:line_of_business <> agqamt:line_of_business[4] then
        delete agqmastsupp

    next agqmastsupp
    end

end

procedure update_agqmaster
BEGIN
access agqmaster, set agqmaster:app_no = g_app_no, exact

if agqmaster:app_no = g_app_no then
    begin
    change agqmaster
        {
        agqmaster:form_of_business  = agqamt:form_of_business
        agqmaster:FOB_DESCRIPTION   = agqamt:fob_description
        }
    end
else
    begin
    add agqmaster
        begin
        agqmaster:app_no            = g_app_no
        agqmaster:form_of_business  = agqamt:form_of_business
        agqmaster:fob_description   = agqamt:fob_description
        end
    end

access agqname, set agqname:app_no = g_app_no, generic

if agqname:app_no = g_app_no then
    begin
    change agqname
        begin
        agqname:name[1]          = agqamt:name
        agqname:eff_date         = agqamt:eff_date
        agqname:exp_date         = dateadd(agqamt:eff_date,0,1)
        agqname:line_of_business = 99
        if agqname:line_of_business = 8 then
            agqname:package      = 1
        else
            agqname:package      = 0
        end
    end
else
    begin
    add agqname
        begin
        agqname:app_no           = g_app_no
        agqname:name[1]          = agqamt:name
        agqname:eff_date         = agqamt:eff_date
        agqname:exp_date         = dateadd(agqamt:eff_date,0,1)
        agqname:line_of_business = 99
        if agqname:line_of_business = 8 then
            agqname:package      = 1
        else
            agqname:package      = 0
        end
    end

END

procedure access_sfscsexec
begin
l_csexec_application = "APQQUOTE                 "

access sfscsexec, set sfscsexec:application = l_csexec_application, generic

change sfscsexec
    begin
    i_csexec_number = sfscsexec:application_number + 1
    sfscsexec:application_number = i_csexec_number
    end

end

procedure change_current_browser (string p_server_name, string p_current_web_page)
BEGIN
l_web_site_address = trun(p_server_name) + trun(p_current_web_page)
setproperty(helper_tg,url,trun(l_web_site_address))

END

procedure print_auto_dec
begin
L_CSEXEC_APPLICATION = "PRINT"/raw

Access SFSCSEXEC, Set SFSCSEXEC:APPLICATION = L_CSEXEC_APPLICATION , Exact

If SFSCSEXEC:APPLICATION_NUMBER = 0 Then
    Begin
    L_CSEXEC_NUMBER = 99999
    End
Else
    Begin
    L_CSEXEC_NUMBER = SFSCSEXEC:APPLICATION_NUMBER + 1

    Change SFSCSEXEC
        Begin
        SFSCSEXEC:APPLICATION_NUMBER = L_CSEXEC_NUMBER
        End
    End

l_app           = "agq"
I_CSEXEC_NUMBER = L_CSEXEC_NUMBER
L_DEC           = L_APP+Str(I_CSEXEC_NUMBER)+".cq"
L_DEC_PDF       = L_APP+Str(I_CSEXEC_NUMBER)+".pdf"

if sfscompany:debug_mode = 1 then
    begin
    proc("cli csbatch agqmso006 %s",str(g_app_no,11))
    Proc("cli joinit agqmso006.cq %s<nl>",l_dec)
    end
else
    begin
    proc("cli csbatch agqmso006 %s",str(g_app_no,11))/noconsole
    Proc("cli joinit agqmso006.cq %s<nl>",l_dec)/noconsole
    end

access agqvehicle_alias,
   set agqvehicle_alias:app_no = g_app_no, generic

l_private_passenger = "N"
while agqvehicle_alias:app_no = g_app_no
    begin
    if agqvehicle_alias:type = 2 then
        l_private_passenger = "Y"

    next agqvehicle_alias
    end
/*
if l_private_passenger = "Y" and
   agqvehicle:company_id = "FARMERS" and
   agqvehicle:state = 29 then
    begin
    proc("cli csbatch njfcsf_092009 %s",str(g_app_no,11))/noconsole
    Proc("cli joinit njfcsf_092009.cq %s<nl>",l_dec)/noconsole
    end

L_USERNAME = Trun(USERNAME)

Access SFSPROFILE, Set SFSPROFILE:USER_ID = L_USERNAME, Exact

If SFSPROFILE:USER_ID <> L_USERNAME Then
    Begin
    L_USERNAME = "default"
    Access SFSPROFILE, Set SFSPROFILE:USER_ID = L_USERNAME, Exact
    End

L_UNIX_PATH   = SFSPROFILE:UNIX_PATH/raw
L_UNIX_SERVER = SFSPROFILE:UNIX_SERVER/raw
L_CLIENT_PATH = SFSPROFILE:CLIENT_PATH/raw

access sfscompany, set sfscompany:company_id = sfsdefault:company_id, generic

If SFSCOMPANY:DEBUG_MODE = 0 Then
    Begin
    Proc("pcl2pdf -letter -csize -ra %s %s ",L_DEC, L_DEC_PDF)/noconsole
    Proc("chmod 777 %s ",L_DEC_PDF)/noconsole
    Proc("mv %s %s %s", L_DEC_PDF," ",Trun(L_UNIX_PATH))/noconsole
    End
Else
    Begin
    Proc("pcl2pdf -letter -csize -ra %s %s ",L_DEC, L_DEC_PDF)
    Proc("chmod 777 %s ",L_DEC_PDF)
    Proc("mv %s %s %s", L_DEC_PDF," ",Trun(L_UNIX_PATH))
    End

Proc("%s %s%s",L_CLIENT_PATH,Trun(L_UNIX_SERVER),Trun(L_DEC_PDF))/client
*/
end


procedure print_cpp_dec
Begin
/*L_CSEXEC_APPLICATION = "PRINT"/raw

Access SFSCSEXEC, Set SFSCSEXEC:APPLICATION = L_CSEXEC_APPLICATION , Exact

If SFSCSEXEC:APPLICATION_NUMBER = 0 Then
    Begin
    L_CSEXEC_NUMBER = 99999
    End
Else
    Begin
    L_CSEXEC_NUMBER = SFSCSEXEC:APPLICATION_NUMBER + 1

    Change SFSCSEXEC
        Begin
        SFSCSEXEC:APPLICATION_NUMBER = L_CSEXEC_NUMBER
        End
    End

l_app           = "agq"
I_CSEXEC_NUMBER = L_CSEXEC_NUMBER
L_DEC           = L_APP+Str(I_CSEXEC_NUMBER)+".cq"
L_DEC_PDF       = L_APP+Str(I_CSEXEC_NUMBER)+".pdf"

*/
proc("cli csbatch agqmso8000 %s",str(g_app_no,11))/noconsole
Proc("cli joinit agqmso8000.cq %s<nl>",l_dec)/noconsole

proc("cli csbatch agqmso8000a %s",str(g_app_no,11))/noconsole
Proc("cli joinit agqmso8000a.cq %s<nl>",l_dec)/noconsole

proc("cli csbatch agqmso8000b %s",str(g_app_no,11))/noconsole
Proc("cli joinit agqmso8000b.cq %s<nl>",l_dec)/noconsole

proc("cli csbatch agqmso8000c %s",str(g_app_no,11))/noconsole
Proc("cli joinit agqmso8000c.cq %s<nl>",l_dec)/noconsole

proc("cli csbatch agqmso8000d %s",str(g_app_no,11))/noconsole
Proc("cli joinit agqmso8000d.cq %s<nl>",l_dec)/noconsole

/*access agqapplication,
   set agqapplication:app_no = g_app_no, generic

if agqapplication:app_no = g_app_no then
  begin
    proc("cli csbatch agqmso8000a %s",str(g_app_no,11))/noconsole
    Proc("cli joinit agqmso8000a.cq %s<nl>",l_dec)/noconsole
  end


L_USERNAME = Trun(USERNAME)

Access SFSPROFILE, Set SFSPROFILE:USER_ID = L_USERNAME, Exact

If SFSPROFILE:USER_ID <> L_USERNAME Then
    Begin
    L_USERNAME = "default"
    Access SFSPROFILE, Set SFSPROFILE:USER_ID = L_USERNAME, Exact
    End

L_UNIX_PATH   = SFSPROFILE:UNIX_PATH/raw
L_UNIX_SERVER = SFSPROFILE:UNIX_SERVER/raw
L_CLIENT_PATH = SFSPROFILE:CLIENT_PATH/raw

access sfscompany, set sfscompany:company_id = sfsdefault:company_id, generic

If SFSCOMPANY:DEBUG_MODE = 0 Then
    Begin
    Proc("pcl2pdf -letter -csize -ra %s %s ",L_DEC, L_DEC_PDF)/noconsole
    Proc("chmod 777 %s ",L_DEC_PDF)/noconsole
    Proc("mv %s %s %s", L_DEC_PDF," ",Trun(L_UNIX_PATH))/noconsole
    End
Else
    Begin
    Proc("pcl2pdf -letter -csize -ra %s %s ",L_DEC, L_DEC_PDF)
    Proc("chmod 777 %s ",L_DEC_PDF)
    Proc("mv %s %s %s", L_DEC_PDF," ",Trun(L_UNIX_PATH))
    End

Proc("%s %s%s",L_CLIENT_PATH,Trun(L_UNIX_SERVER),Trun(L_DEC_PDF))/client
*/
end

procedure print_workers_comp_dec
begin
/*L_CSEXEC_APPLICATION = "PRINT"/raw

Access SFSCSEXEC, Set SFSCSEXEC:APPLICATION = L_CSEXEC_APPLICATION , Exact

If SFSCSEXEC:APPLICATION_NUMBER = 0 Then
    Begin
    L_CSEXEC_NUMBER = 99999
    End
Else
    Begin
    L_CSEXEC_NUMBER = SFSCSEXEC:APPLICATION_NUMBER + 1

    Change SFSCSEXEC
        Begin
        SFSCSEXEC:APPLICATION_NUMBER = L_CSEXEC_NUMBER
        End
    End

l_app           = "agq"
I_CSEXEC_NUMBER = L_CSEXEC_NUMBER
L_DEC           = L_APP+Str(I_CSEXEC_NUMBER)+".cq"
L_DEC_PDF       = L_APP+Str(I_CSEXEC_NUMBER)+".pdf"
*/
proc("cli csbatch agqmso4000 %s",str(g_app_no,11))/noconsole
Proc("cli joinit agqmso4000.cq %s<nl>",l_dec)/noconsole

/*L_USERNAME = Trun(USERNAME)

Access SFSPROFILE, Set SFSPROFILE:USER_ID = L_USERNAME, Exact

If SFSPROFILE:USER_ID <> L_USERNAME Then
    Begin
    L_USERNAME = "default"
    Access SFSPROFILE, Set SFSPROFILE:USER_ID = L_USERNAME, Exact
    End

L_UNIX_PATH   = SFSPROFILE:UNIX_PATH/raw
L_UNIX_SERVER = SFSPROFILE:UNIX_SERVER/raw
L_CLIENT_PATH = SFSPROFILE:CLIENT_PATH/raw

access sfscompany, set sfscompany:company_id = sfsdefault:company_id, generic

If SFSCOMPANY:DEBUG_MODE = 0 Then
    Begin
    Proc("pcl2pdf -letter -csize -ra %s %s ",L_DEC, L_DEC_PDF)/noconsole
    Proc("chmod 777 %s ",L_DEC_PDF)/noconsole
    Proc("mv %s %s %s", L_DEC_PDF," ",Trun(L_UNIX_PATH))/noconsole
    End
Else
    Begin
    Proc("pcl2pdf -letter -csize -ra %s %s ",L_DEC, L_DEC_PDF)
    Proc("chmod 777 %s ",L_DEC_PDF)
    Proc("mv %s %s %s", L_DEC_PDF," ",Trun(L_UNIX_PATH))
    End

Proc("%s %s%s",L_CLIENT_PATH,Trun(L_UNIX_SERVER),Trun(L_DEC_PDF))/client
*/
end

procedure print_bop_dec
begin
/*L_CSEXEC_APPLICATION = "PRINT"/raw

Access SFSCSEXEC, Set SFSCSEXEC:APPLICATION = L_CSEXEC_APPLICATION , Exact

If SFSCSEXEC:APPLICATION_NUMBER = 0 Then
    Begin
    L_CSEXEC_NUMBER = 99999
    End
Else
    Begin
    L_CSEXEC_NUMBER = SFSCSEXEC:APPLICATION_NUMBER + 1

    Change SFSCSEXEC
        Begin
        SFSCSEXEC:APPLICATION_NUMBER = L_CSEXEC_NUMBER
        End
    End

l_app           = "agq"
I_CSEXEC_NUMBER = L_CSEXEC_NUMBER
L_DEC           = L_APP+Str(I_CSEXEC_NUMBER)+".cq"
L_DEC_PDF       = L_APP+Str(I_CSEXEC_NUMBER)+".pdf"

if agqgeneral:company_id one of "FLEMINGTON" then
    begin
    proc("cli csbatch agqmso001 %s",str(g_app_no,11))/noconsole
    Proc("cli joinit agqmso001.cq %s<nl>",l_dec)/noconsole
    end
else
if agqgeneral:company_id one of "FARMERS", "LEBINS" then
    begin*/
    proc("cli csbatch agqmso001a %s",str(g_app_no,11))/noconsole
    Proc("cli joinit agqmso001a.cq %s<nl>",l_dec)/noconsole
--    end
/*
access agqapplication, set agqapplication:app_no = g_app_no, generic

if agqapplication:app_no = g_app_no then
    begin
    proc("cli csbatch agqmso002 %s",str(g_app_no,11))/noconsole
    Proc("cli joinit agqmso002.cq %s<nl>",l_dec)/noconsole
    end


L_USERNAME = Trun(USERNAME)

Access SFSPROFILE, Set SFSPROFILE:USER_ID = L_USERNAME, Exact

If SFSPROFILE:USER_ID <> L_USERNAME Then
    Begin
    L_USERNAME = "default"
    Access SFSPROFILE, Set SFSPROFILE:USER_ID = L_USERNAME, Exact
    End

L_UNIX_PATH   = SFSPROFILE:UNIX_PATH/raw
L_UNIX_SERVER = SFSPROFILE:UNIX_SERVER/raw
L_CLIENT_PATH = SFSPROFILE:CLIENT_PATH/raw

access sfscompany, set sfscompany:company_id = sfsdefault:company_id, generic

If SFSCOMPANY:DEBUG_MODE = 0 Then
    Begin
    Proc("pcl2pdf -letter -csize -ra %s %s ",L_DEC, L_DEC_PDF)/noconsole
    Proc("chmod 777 %s ",L_DEC_PDF)/noconsole
    Proc("mv %s %s %s", L_DEC_PDF," ",Trun(L_UNIX_PATH))/noconsole
    End
Else
    Begin
    Proc("pcl2pdf -letter -csize -ra %s %s ",L_DEC, L_DEC_PDF)
    Proc("chmod 777 %s ",L_DEC_PDF)
    Proc("mv %s %s %s", L_DEC_PDF," ",Trun(L_UNIX_PATH))
    End

Proc("%s %s%s",L_CLIENT_PATH,Trun(L_UNIX_SERVER),Trun(L_DEC_PDF))/client
*/
end

procedure print_umbrella_dec
begin
L_CSEXEC_APPLICATION = "PRINT"/raw

Access SFSCSEXEC, Set SFSCSEXEC:APPLICATION = L_CSEXEC_APPLICATION , Exact

If SFSCSEXEC:APPLICATION_NUMBER = 0 Then
    Begin
    L_CSEXEC_NUMBER = 99999
    End
Else
    Begin
    L_CSEXEC_NUMBER = SFSCSEXEC:APPLICATION_NUMBER + 1

    Change SFSCSEXEC
        Begin
        SFSCSEXEC:APPLICATION_NUMBER = L_CSEXEC_NUMBER
        End
    End

l_app           = "agq"
I_CSEXEC_NUMBER = L_CSEXEC_NUMBER
L_DEC           = L_APP+Str(I_CSEXEC_NUMBER)+".cq"
L_DEC_PDF       = L_APP+Str(I_CSEXEC_NUMBER)+".pdf"

proc("cli csbatch agqmso4000 %s",str(g_app_no,11))/noconsole
Proc("cli joinit agqmso4000.cq %s<nl>",l_dec)/noconsole

access agqapplication, set agqapplication:app_no = g_app_no, generic

if agqapplication:app_no = g_app_no then
  begin
    proc("cli csbatch agqmso4000a %s",str(g_app_no,11))/noconsole
    Proc("cli joinit agqmso4000a.cq %s<nl>",l_dec)/noconsole
  end

L_USERNAME = Trun(USERNAME)

Access SFSPROFILE, Set SFSPROFILE:USER_ID = L_USERNAME, Exact

If SFSPROFILE:USER_ID <> L_USERNAME Then
    Begin
    L_USERNAME = "default"
    Access SFSPROFILE, Set SFSPROFILE:USER_ID = L_USERNAME, Exact
    End

L_UNIX_PATH   = SFSPROFILE:UNIX_PATH/raw
L_UNIX_SERVER = SFSPROFILE:UNIX_SERVER/raw
L_CLIENT_PATH = SFSPROFILE:CLIENT_PATH/raw

access sfscompany, set sfscompany:company_id = sfsdefault:company_id, generic

If SFSCOMPANY:DEBUG_MODE = 0 Then
    Begin
    Proc("pcl2pdf -letter -csize -ra %s %s ",L_DEC, L_DEC_PDF)/noconsole
    Proc("chmod 777 %s ",L_DEC_PDF)/noconsole
    Proc("mv %s %s %s", L_DEC_PDF," ",Trun(L_UNIX_PATH))/noconsole
    End
Else
    Begin
    Proc("pcl2pdf -letter -csize -ra %s %s ",L_DEC, L_DEC_PDF)
    Proc("chmod 777 %s ",L_DEC_PDF)
    Proc("mv %s %s %s", L_DEC_PDF," ",Trun(L_UNIX_PATH))
    End

Proc("%s %s%s",L_CLIENT_PATH,Trun(L_UNIX_SERVER),Trun(L_DEC_PDF))/client
end

Procedure CREATE_MACRO
Begin
Do REFRESH_WORK_FILES
L_CSEXEC_APPLICATION = "PRINT"/raw

Access SFSCSEXEC, Set SFSCSEXEC:APPLICATION = L_CSEXEC_APPLICATION , Exact

If SFSCSEXEC:APPLICATION_NUMBER = 0 Then
    Begin
    L_CSEXEC_NUMBER = 99999
    End
Else
    Begin
    L_CSEXEC_NUMBER = SFSCSEXEC:APPLICATION_NUMBER + 1

    Change SFSCSEXEC
        Begin
        SFSCSEXEC:APPLICATION_NUMBER = L_CSEXEC_NUMBER
        End
    End

I_APP = "agq"
I_CSEXEC_NUMBER = L_CSEXEC_NUMBER
L_DEC = L_APP+Str(I_CSEXEC_NUMBER)+".cq"
L_JOINIT_DEC = L_APP+Str(I_CSEXEC_NUMBER)+".cq"
L_DEC_PDF = L_APP+Str(I_CSEXEC_NUMBER)+".txt"
I_PARAMETER = I_APP+Str(I_CSEXEC_NUMBER)+".par"
I_MACROA = I_APP+Str(I_CSEXEC_NUMBER)
I_MACRO = I_APP+Str(I_CSEXEC_NUMBER)+".mf"

access agqprint1, set agqprint1:app_no = g_app_no, generic

if agqprint1:app_no <> g_app_no then
    begin
    Add agqprint1
        Begin
        agqprint1:app_no = G_app_no
        end
    End
else
    begin
    delete agqprint1
    Add agqprint1
        Begin
        agqprint1:app_no = G_app_no
        end
    End

access agqgeneral, set agqgeneral:app_no = g_app_no, generic

if agqgeneral:app_no = g_app_no then
    begin
    I_REPORTA = "agqpr100"
    I_REPORT = "agqpr100.cq"
    I_REPORT_CQE = "agqpr100.cqe"
    do print_worksheet
    end

access agqvehicle, set agqvehicle:app_no = g_app_no, generic

if agqvehicle:app_no = g_app_no then
    begin
    I_REPORTA = "agqpr400"
    I_REPORT = "agqpr400.cq"
    I_REPORT_CQE = "agqpr400.cqe"
    do print_worksheet
    end

access agqworkerscomp1, set agqworkerscomp1:app_no = g_app_no, generic

if agqworkerscomp1:app_no = g_app_no then
    begin
    I_REPORTA = "agqmso4001"
    I_REPORT = "agqmso4001.cq"
    I_REPORT_PDF = "agqmso4001.pdf"
    do print_batch
    end

L_USERNAME = Trun(USERNAME)

Access SFSPROFILE, Set SFSPROFILE:USER_ID = L_USERNAME, Exact

If SFSPROFILE:USER_ID <> L_USERNAME Then
    Begin
    L_USERNAME = "default"
    Access SFSPROFILE, Set SFSPROFILE:USER_ID = L_USERNAME, Exact
    End

L_UNIX_PATH   = SFSPROFILE:UNIX_PATH/raw
L_UNIX_SERVER = SFSPROFILE:UNIX_SERVER/raw
L_CLIENT_PATH = SFSPROFILE:CLIENT_PATH/raw

If SFSCOMPANY:DEBUG_MODE = 0 Then
    Begin
    Proc("cli mv %s %s",L_DEC,L_DEC_PDF)/noconsole
    Proc("cli chmod 777 %s ",L_DEC_PDF)/noconsole
    Proc("cli rm %s",L_DEC)/noconsole
    Proc("cli mv %s %s %s", L_DEC_PDF," ",Trun(L_UNIX_PATH))/noconsole
    End
Else
    Begin
    Proc("cli mv %s %s",L_DEC,L_DEC_PDF)
    Proc("cli chmod 777 %s ",L_DEC_PDF)
    Proc("cli rm %s",L_DEC)
    Proc("cli mv %s %s %s", L_DEC_PDF," ",Trun(L_UNIX_PATH))
    End

Proc("%s %s%s",L_CLIENT_PATH,Trun(L_UNIX_SERVER),Trun(L_DEC_PDF))/client/noconsole

access agqprint1, set agqprint1:app_no = g_app_no, generic

delete agqprint1
Do REFRESH_WORK_FILES
End

procedure print_worksheet
begin
Deletefile(I_MACRO)
Writefile(I_MACRO,"clear list<nl>")
Writefile(I_MACRO,"clear find<nl>")
Writefile(I_MACRO,"clear sum<nl>")
Writefile(I_MACRO,"run %s<nl>",trun(i_reporta))
Writefile(I_MACRO,"cli rm %s<nl>",trun(i_report))
Writefile(I_MACRO,"rsave %s<nl>",trun(i_reporta))
Writefile(I_MACRO,"cli joinit %s %s<nl>",trun(i_report),trun(L_DEC))
Closefile(I_MACRO)

access sfscompany, set sfscompany:company_id = agqname:company_id, generic

If SFSCOMPANY:DEBUG_MODE = 0 Then
    Proc("cli cq %s",I_MACRO)/noconsole
Else
    Proc("cli cq %s",I_MACRO)
end

procedure print_batch
begin
Deletefile(I_MACRO)
Writefile(I_MACRO,"cli rm %s<nl>",trun(i_report))

Writefile(I_MACRO,"cli csbatch %s<nl>",trun(i_reporta))
Writefile(I_MACRO,"cli pcl2pdf %s %s<nl>",trun(i_report),trun(i_report_pdf))
writefile(i_macro,"cli joinit %s %s<nl>",trun(i_report_pdf),trun(l_joinit_dec))
Closefile(I_MACRO)

If SFSCOMPANY:DEBUG_MODE = 0 Then
    Proc("cli cq %s",I_MACRO)/noconsole
Else
    Proc("cli cq %s",I_MACRO)

end

Procedure REFRESH_WORK_FILES
Begin
Proc ("cli agqprint1.mk")/noconsole
End

end

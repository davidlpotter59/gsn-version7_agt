%%                      
Screen
        Name = "agtmt8004";
        Type = "Detail" ;
        Highlight=Underscore ;
        highlightfield="Yes";
        Padcharacter=Space ;
        Screensize="dynamic";
        Windowtitle="%a     %s Rating Information - Ver. 7.00     %m";
        Domain="agqinland" ;
        resizeable = yes ;
        iconline = 0 ;

        Global Unsigned Ascii Number G_APP_NO[11] ;
        Global Unsigned Ascii Number G_LINE_OF_BUSINESS[4] ;
        Global Unsigned Ascii Number G_OPT[2] ;
        global unsigned ascii number g_add_prem_no[1] ;
        global unsigned ascii number g_add_build_no[1] ;
        global unsigned ascii number g_add_new_quote[1] ;
        global unsigned ascii number g_prem_no[4] ;
        global unsigned ascii number g_build_no[4];
        global unsigned ascii number g_from_search_screen[1] ;
        global unsigned ascii number g_enhancement[1] ;
        global unsigned ascii number g_state[2] ;
        global unsigned ascii number g_sub_code[4] ;

        global string g_company_id[10] ,
                      g_initial_screen[50] ,
                      g_code[7],
                      g_zipcode_change[1] ;

        array[12] of string l_literal[40] ;
        array[12] of tag l_the_tag[15] ;

        Local Unsigned Ascii Number L_SUB_CODE[4] ,
                                    L_STATE[2],
                                    l_prem_no[4],
                                    l_build_no[4],
                                    L_LINE_OF_BUSINESS[4]=0008,
                                    l_csexec_number[12] ,
                                    l_rate[6]=0/dec=3,
                                    l_per[4]=0 ,
                                    l_loop[2],
                                    l_tag_position[2],
                                    l_last_prem_no[4],
                                    l_last_build_no[4],
                                    l_first_prem_no[4],
                                    l_first_build_no[4],
                                    l_no_locations[2]=0 ,
                                    l_option_1[1]=0,
                                    l_option_2[1]=0,
                                    l_option_3[1]=0,
                                    l_option_4[1]=0,
                                    l_option_5[1]=0,
                                    l_option_6[1]=0,
                                    l_option_7[1]=0,
                                    l_option_8[1]=0,
                                    l_option_9[1]=0,
                                    l_option_10[1]=0,
                                    l_option_11[1]=0,
                                    l_option_12[1]=0;

        Local Signed Ascii Number L_PACKAGE_MOD[4]=0/decimals=2,
                                  L_DEVIATION[4]=0/decimals=2,
                                  L_PACKAGE[4]=0/decimals=2 ,
                                  L_PREMIUM[9]=0 ,
                                  l_total_premium[9]=0;

        Local String L_SCREEN[8] ,
                     L_CODE[7] ,
                     l_dec[15],
                     l_screen_1[10],
                     l_username[15],
                     L_CODE_1[7],
                     L_CODE_2[7],
                     l_type[2],
                     l_code_3[7],
                     l_code_4[7],
                     l_code_5[7],
                     l_code_6[7],
                     l_code_7[7],
                     l_code_8[7],
                     l_code_9[7],
                     l_code_10[7],
                     l_code_11[7],
                     l_code_12[7],
                     l_code_13[7],
                     l_code_14[7],
                     l_enter[1],
                     l_add[1]="Y",
                     l_app[3]="",
                     l_first_location[1]="Y",
                     l_first_str_location[8],
                     l_last_str_location[8],
                     l_str_location[12],
                     l_csexec_application[25]="",
                     L_FORM_EDITION[18],
                     L_DESCRIPTION[55],
                     L_ADD_ENDORSEMENT[1],
                     l_first[1]="Y",
                     L_DELETE_ENDORSEMENT[1],
                     L_COMPANY_ID[10] ;

        Local Date L_EFF_DATE[8] ;

        Access agqinland,
           Set agqinland:app_no   = G_app_no, generic

        Include "stdkeys7.inc"

Style Definition
        Include "styles.inc"
        Displayonly Field Style {
                                  backgroundcolor="#CCCCCC"
                                }


Functions

        "redisplay" display/noreturn "agtmt8004" ;

        "back" display/noreturn "agtmt8000" tagged back_fn;

        "func2" display "agtmt8004x" tagged optional_info_fn ;

        reaccess ;

        include "stdfunc7.inc"

EVENT DEFINITION
        default eventhandler {
                             "REMOVE_SCREEN" { function = "exit" abort () }
                             "reload" { function = "reaccess" abort () }
                             "display_message" { warning "" + event.value }
                             "current_line_of_business" {
                                                          g_line_of_business = val(event.value)
                                                        }
                             }
Menu Definition

Toolbar Definition

Screen Entry
do set_display

disable(accept_fn)
access sfsdefault, set sfsdefault:sfs_code = "SFS", generic

g_initial_screen = ""
l_username = username
l_company_id = sfsdefault:company_id

l_username = username
access sfsemail, set sfsemail:company_id = l_company_id,
                     sfsemail:user_id    = l_username, generic

access sfsagent, set sfsagent:company_id = l_company_id,
                     sfsagent:agent_no   = sfsemail:agent_no, generic

access sfsdefault, set sfsdefault:sfs_code = "SFS", generic

access sfsdefault, set sfsdefault:sfs_code = "SFS", generic

if sfsdefault:company_id one of "FLEMINGTON" then
    begin
    hide(lebins_fn)
    hide(farmers_fn)
    end
else
if sfsdefault:company_id one of "FARMERS" then
    begin
    hide(ficof_fn)
    hide(lebins_fn)
    end
else
if sfsdefault:company_id one of "LEBINS" then
    begin
    hide(ficof_fn)
    hide(farmers_fn)
    end

l_state = sfsagent:state
if l_state = 0 then
    l_state = sfsdefault:state
Access SFSLINE_ALIAS, Set SFSLINE_alias:COMPANY_ID       = l_company_id,
                          SFSLINE_alias:LINE_OF_BUSINESS = g_line_of_business,
                          SFSLINE_alias:LOB_SUBLINE      = "00", Generic

Access SFSLINE, Set SFSLINE:COMPANY_ID       = l_company_id,
                    SFSLINE:LINE_OF_BUSINESS = g_line_of_business,
                    SFSLINE:LOB_SUBLINE      = "00", Generic

access agqname, set agqname:app_no = g_app_no,generic

if agqname:quote_no <> 0 then
    begin
    disable(add_fn)
    disable(change_fn)
    disable(delete_fn)
    disable(accept_fn)
    end

if agqinland:app_no = 0 then
    begin
    disable(previous_fn)
    disable(next_fn)
    end

if agqinland:county = 0 and
   agqinland:business_description[1] = "" then
    begin
    disable(change_fn)
    disable(delete_fn)
    end

access validation
if agqinland:app_no <> g_app_no then
    error ""

access agqinland_alias, set agqinland_alias:app_no = agqinland:app_no, generic

l_no_locations   = 0
l_first_location = "Y"
l_first_prem_no  = 0
l_first_build_no = 0
l_last_prem_no   = 0
l_last_build_no  = 0
while agqinland_alias:app_no = agqinland:app_no
    begin
    if l_first_location = "Y" then
        begin
        l_first_str_location  = str(agqinland_alias:prem_no) +
                               str(agqinland_alias:build_no)
        l_first_location = "N"
        end
    l_last_str_location  = str(agqinland_alias:prem_no) +
                           str(agqinland_alias:build_no)
    l_no_locations  = l_no_locations + 1

    next agqinland_alias
    end

l_str_location = str(agqinland:prem_no) +
                 str(agqinland:build_no)

if l_no_locations one of 0, 1 then
    begin
    disable(next_fn)
    disable(previous_fn)
    end
else
if l_str_location = l_first_str_location and
   l_no_locations > 1 then
    begin
    disable(previous_fn)
    enable(next_fn)
    end
else
if l_str_location <> l_first_str_location and
   l_str_location <> l_last_str_location and
   l_no_locations > 1 then
    begin
    enable(next_fn)
    enable(previous_fn)
    end
else
if l_str_location = l_last_str_location and
   l_no_locations > 1 then
    begin
    disable(next_fn)
    enable(previous_fn)
    end

screen at 1,1 to 30,100
Properties
        {
          Layouttype = screen
          transparent = False
          fontstyle = BOLD
          backgroundcolor = "#ADD8E6"
          scrollbarpolicy = always
        }
{

    Panel at 1,1 to 2,100
        Properties
            {
            layouttype = screen
            }
        {
        components
            guidetext at 1,1 to 2,40
                properties
                    {
                    iconname = "qp_logo.gif"
                    }
            guidetext at 1,83 to 2,100 tagged ficof_fn
                properties
                    {
                    iconname = "ficof_logo.gif"
                    }
            guidetext at 1,83 to 2,100 tagged farmers_fn
                properties
                    {
                    iconname = "salem_logo.gif"
                    }
            guidetext at 1,83 to 2,100 tagged lebins_fn
                properties
                    {
                    iconname = ""
                    }
            guidetext at 1,35 to 2,100 tagged t_line_of_business
                Properties
                   {
                   iconname = ""
                   }

        }


panel at 3,1 to 4,100
Properties
        {
        LayoutType = screen
        backgroundcolor = "Grey"
        transparent = False
        }
{
components
          guidetext at 1.45,1 to 1.45,40     tagged display_information_box
                properties
                  {
                    text = "Inland Marine Information..."
                    fontsize = 18
                    fontstyle = BOLD
                    fontname = "arial"
                    transparent = False
                    backgroundcolor = "Grey"
                  }

}

Panel at 3.45,75 to 4.45, 100
Properties {
           LayoutType = screen
           }
{
%%
App No: ___________

%%

fields
101     begin
        g_add_prem_no   = 0
        g_add_build_no  = 0
        g_prem_no       = 0
        g_build_no      = 0
        if function one of "ADD", "NEW" then
            begin
            access agqinland_alias, set agqinland_alias:app_no = g_app_no, generic

            if agqinland_alias:app_no = g_app_no then
                begin
                g_prem_no = agqinland_alias:prem_no
                g_build_no = agqinland_alias:build_no
                l_screen_1 = "agtmt8004a"
                display modal screen l_screen_1
                with initial function "CHANGE|BACK"

                if g_add_prem_no   = 0 and
                   g_add_build_no  = 0 then
                    begin
                    function = "redisplay"
                    abort()
                    end

                if g_add_prem_no = 1 then
                    begin
                    l_prem_no = 0
                    access agqinland_alias, set agqinland_alias:app_no = g_app_no, generic

                    while agqinland_alias:app_no = g_app_no
                        begin
                        l_prem_no  = agqinland_alias:prem_no

                        next agqinland_alias
                        end

                    access agqmaster, set agqmaster:app_no = g_app_no, generic

                    access agqinland_alias, set agqinland_alias:app_no = g_app_no, generic

                    agqinland:app_no            = g_app_no
                    agqinland:prem_no           = l_prem_no + 1
                    agqinland:build_no          = 1
                    end
                else
                if g_add_build_no = 1 then
                    begin
                    access agqinland_alias, set agqinland_alias:app_no = g_app_no, generic

                    l_build_no = 0
                    while agqinland_alias:app_no = g_app_no
                        begin
                        if agqinland_alias:prem_no = g_prem_no then
                            l_build_no  = agqinland_alias:build_no

                        next agqinland_alias
                        end

                    access agqmaster, set agqmaster:app_no = g_app_no, generic

                    access agqinland_alias, set agqinland_alias:app_no = g_app_no, generic

                    agqinland:app_no           = g_app_no
                    agqinland:prem_no          = g_prem_no
                    agqinland:build_no         = l_build_no + 1
                    end
                end
            else
                begin
                agqinland:app_no           = g_app_no
                agqinland:prem_no          = 1
                agqinland:build_no         = 1
                end
            end

        g_prem_no                   = agqinland:prem_no
        g_build_no                  = agqinland:build_no
        end
        agqinland:APP_NO/displayonly ;

}

Panel at 5,1 to 6,100 Tagged icon_line2_tg
    Properties {
               LayoutType = screen
               }
    {
    Components
        Button at 1.5,1   tagged add_fn
            Properties {
                       Iconname = "btn_add_location.bmp"
                       tooltip = "Add Location or Building"
                       }
            Events     {
                       Action = add_fn
                       }

        Button at 1.5,38    tagged change_fn
            Properties {
                       Iconname = "btn_edit_location.bmp"
                       }
            Events     {
                       Action = change_fn
                       }

        Button at 1.5, 70 tagged delete_fn
            Properties {
                       Iconname = "btn_delete_location.bmp"
                       }
            Events     {
                       Action = delete_fn
                       }
    }

Panel at 5,94 to 6,96 tagged button_panel
    Properties {
               layouttype = column
               }
    {
    Components
        Button to 1,1
            properties {
                       Iconname = "btn_print_screen.bmp"
                       }
            events     {
                       action {
                              function = "print"
                              abort()
                              }
                       }
    }

Panel at 6.45,92
    Properties {
               layouttype = column
               }
    {
    Components
        guidetext to 1,1
            properties {
                       text = "agtmt8004.sd"
                       fontsize = 9
                       }
    }

Panel at 7,1 to 9,100 Tagged location
    Properties {
               LayoutType = screen
               }
    {
    Components
        guidetext at 1.5,24 to 2.5,36
            properties {
                       text = "Location No:"
                       fontsize = 12
                       fontname = "arial"
                       }

        guidetext at 1.5,44 to 2.5,56
            properties {
                       text = "Building No:"
                       fontsize = 12
                       fontname = "arial"
                       }
    }

Panel at 7.5,33 to 9,60 Tagged rating_pl
{
%%
____                ____

%%

components

fields
101   agqinland:prem_no/displayonly ;
102   agqinland:build_no/displayonly ;

}

Panel at 8,70 to 8,100
    Properties {
               layouttype = row
               }
    {
    Components
        Button at 1,55 tagged accept_fn
            properties {
                       Iconname = "btn_accept_edits.bmp"
                       }
            Events     {
                       mouseclicked = accept
                       }

    }

Panel at 10,1 to 11,100
    Properties {
               LayoutType = screen
               }
    {
    Components
        guidetext at 1,1 to 1,22
            properties {
                       text = "County:"
                       fontsize = 12
                       contentalignment = right
                       fontname = "arial"
                       }

        guidetext at 2,1 to 2,22
            properties {
                       text = "Business Description:"
                       fontsize = 12
                       contentalignment = right
                       fontname = "arial"
                       }

    }

Panel at 10,25 to 12, 100
{
%%
___  __________________________________________________
__________________________________________________
__________________________________________________

%%

components

fields
101     begin
        if function one of "ADD","NEW","CHG","CHANGE" then
            {
            enable(accept_fn)
            disable(back_fn)
            disable(optional_info_fn)
            }
        else
            {
            disable(accept_fn)
            enable(back_fn)
            enable(optional_info_fn)
            }

        access agqtotals1, set agqtotals1:app_no = g_app_no, generic

        Access agqinland_ALIAS, Set agqinland_ALIAS:app_no = agqinland:app_no, Generic

        Access agqinland_ALT, Set agqinland_ALT:app_no   = agqinland:app_no,
                                  agqinland_alt:prem_no  = agqinland:prem_no,
                                  agqinland_alt:build_no = agqinland:build_no, Generic

        access sfsdefault, set sfsdefault:sfs_code = "SFS", generic

        access agqname, set agqname:app_no = g_app_no, generic

        If FUNCTION one of "ADD", "NEW" Then
            Begin
            agqinland:COMPANY_ID              = sfsdefault:COMPANY_ID
            agqinland:rating_line_of_business = 0008
            agqinland:line_of_business        = agqtotals1:line_of_business
            agqinland:state                   = sfsdefault:state
            agqinland:company_deviation       = 1.00
            if agqname:package = 1 then
                do get_package_mod
            if l_package_mod <> 0 then
                agqinland:package_mod         = l_package_mod
            else
                agqinland:package_Mod         = 1.00
            End
        else
        if function one of "CHANGE", "CHG" then
            begin
            if agqname:package = 1 then
                do get_package_mod
            if l_package_mod <> 0 then
                agqinland:package_mod         = l_package_mod
            else
                agqinland:package_Mod         = 1.00
            end
        End
        agqinland:COUNTY/default/tabstop mandatory
        if agqinland:county = 0 then
            error "Must enter a valid county code"
        Include "countyhlp.inc"
102     SFSSTATE_ALIAS:DESCRIPTION;
201     agqinland:business_description[1]/tabstop/uppercase mandatory;
301     agqinland:business_description[2]/tabstop/uppercase ;

}

Panel at 13,10 to 24, 100
           Properties {
                        LayoutType = screen
                        backgroundcolor = "Grey"
                      }
                   {
                     Components
                        guidetext at 2,1 to 2,40 tagged tview1
                             properties
                               {
                                 text = ""
                                 fontsize = 12
                                 fontstyle = BOLD
                                 fontname = "arial"
                                 contentalignment = left
                               }
                             events
                                {
                                mouseclicked {
                                             do show_form_1
                                             }
                                }
                        guidetext at 3,1 to 3,40 tagged tview2
                             properties
                               {
                                 text = ""
                                 fontsize = 12
                                 fontstyle = BOLD
                                 fontname = "arial"
                                 contentalignment = left
                               }
                             events
                                {
                                mouseclicked {
                                             do show_form_2
                                             }
                                }
                        guidetext at 4,1 to 4,40 tagged tview3
                             properties
                               {
                                 text = ""
                                 fontsize = 12
                                 fontstyle = BOLD
                                 fontname = "arial"
                                 contentalignment = left
                               }
                             events
                                {
                                mouseclicked {
                                             do show_form_3
                                             }
                                }
                        guidetext at 5,1 to 5,40 tagged tview4
                             properties
                               {
                                 text = ""
                                 fontsize = 12
                                 fontstyle = BOLD
                                 fontname = "arial"
                                 contentalignment = left
                               }
                             events
                                {
                                mouseclicked {
                                             do show_form_4
                                             }
                                }
                        guidetext at 6,1 to 6,40 tagged tview5
                             properties
                               {
                                 text = ""
                                 fontsize = 12
                                 fontstyle = BOLD
                                 fontname = "arial"
                                 contentalignment = left
                               }
                             events
                                {
                                mouseclicked {
                                             do show_form_5
                                             }
                                }
                        guidetext at 7,1 to 7,40 tagged tview6
                             properties
                               {
                                 text = ""
                                 fontsize = 12
                                 fontstyle = BOLD
                                 fontname = "arial"
                                 contentalignment = left
                               }
                             events
                                {
                                mouseclicked {
                                             do show_form_6
                                             }
                                }
    }

Panel at 13,35 to 24,49
{
%%

~~~_
~~~_
~~~_
~~~_
~~~_
~~~_

%%

components

fields
201     begin
            g_state     = agqinland:state
            l_option_1  = agqinland:option[1]
            l_option_2  = agqinland:option[2]
            l_option_3  = agqinland:option[3]
            l_option_4  = agqinland:option[4]
            l_option_5  = agqinland:option[5]
            l_option_6  = agqinland:option[6]
            l_option_7  = agqinland:option[7]
            l_option_8  = agqinland:option[8]
            l_option_9  = agqinland:option[9]
            l_option_10 = agqinland:option[10]
            l_option_11 = agqinland:option[11]
            l_option_12 = agqinland:option[12]
        if agqinland:option[1] = 1 then
                do display_blue(l_the_tag[1],"blue")
            else
                do remove_blue(l_the_tag[1],"black")
        end
        agqinland:option[1]/checkbox/values="0,1"/tabstop ;
301     begin
        if agqinland:option[2] = 1 then
            do display_blue(l_the_tag[2],"blue")
        else
            do remove_blue(l_the_tag[2],"black")
        end
        agqinland:option[2]/checkbox/values="0,1"/tabstop ;
401     begin
        if agqinland:option[3] = 1 then
            do display_blue(l_the_tag[3],"blue")
        else
            do remove_blue(l_the_tag[3],"black")
        end
        agqinland:option[3]/checkbox/values="0,1"/tabstop ;
501     begin
        if agqinland:option[4] = 1 then
            do display_blue(l_the_tag[4],"blue")
        else
            do remove_blue(l_the_tag[4],"black")
        end
        agqinland:option[4]/checkbox/values="0,1"/tabstop ;
601     begin
        if agqinland:option[5] = 1 then
            do display_blue(l_the_tag[5],"blue")
        else
            do remove_blue(l_the_tag[5],"black")
        end
        agqinland:option[5]/checkbox/values="0,1"/tabstop ;
701     begin
        if agqinland:option[6] = 1 then
            do display_blue(l_the_tag[6],"blue")
        else
            do remove_blue(l_the_tag[6],"black")
        end
        agqinland:option[6]/checkbox/values="0,1"/tabstop ;

}

Panel at 13,50 to 24, 90
           Properties {
                        LayoutType = screen
                        backgroundcolor = "Grey"
                      }
                   {
                     Components
                        guidetext at 2,1 to 2,40 tagged tview7
                             properties
                               {
                                 text = ""
                                 fontsize = 12
                                 fontstyle = BOLD
                                 fontname = "arial"
                                 contentalignment = left
                               }
                             events
                                {
                                mouseclicked {
                                             do show_form_7
                                             }
                                }
                        guidetext at 3,1 to 3,40 tagged tview8
                             properties
                               {
                                 text = ""
                                 fontsize = 12
                                 fontstyle = BOLD
                                 fontname = "arial"
                                 contentalignment = left
                               }
                             events
                                {
                                mouseclicked {
                                             do show_form_8
                                             }
                                }
                        guidetext at 4,1 to 4,40 tagged tview9
                             properties
                               {
                                 text = ""
                                 fontsize = 12
                                 fontstyle = BOLD
                                 fontname = "arial"
                                 contentalignment = left
                               }
                             events
                                {
                                mouseclicked {
                                             do show_form_9
                                             }
                                }
                        guidetext at 5,1 to 5,40 tagged tview10
                             properties
                               {
                                 text = ""
                                 fontsize = 12
                                 fontstyle = BOLD
                                 fontname = "arial"
                                 contentalignment = left
                               }
                             events
                                {
                                mouseclicked {
                                             do show_form_10
                                             }
                                }
                        guidetext at 6,1 to 6,40 tagged tview11
                             properties
                               {
                                 text = ""
                                 fontsize = 12
                                 fontstyle = BOLD
                                 fontname = "arial"
                                 contentalignment = left
                               }
                             events
                                {
                                mouseclicked {
                                             do show_form_11
                                             }
                                }
                        guidetext at 7,1 to 7,40 tagged tview12
                             properties
                               {
                                 text = ""
                                 fontsize = 12
                                 fontstyle = BOLD
                                 fontname = "arial"
                                 contentalignment = left
                               }
                             events
                                {
                                mouseclicked {
                                             do show_form_12
                                             }
                                }
    }

Panel at 13,66 to 24,100
{
%%

~~~_
~~~_
~~~_
~~~_
~~~_
~~~_

%%

components

fields
201     begin
        if agqinland:option[7] = 1 then
                do display_blue(l_the_tag[7],"blue")
            else
                do remove_blue(l_the_tag[7],"black")
        end
        agqinland:option[7]/checkbox/values="0,1"/tabstop ;
301     begin
        if agqinland:option[8] = 1 then
            do display_blue(l_the_tag[8],"blue")
        else
            do remove_blue(l_the_tag[8],"black")
        end
        agqinland:option[8]/checkbox/values="0,1"/tabstop ;
401     begin
        if agqinland:option[9] = 1 then
            do display_blue(l_the_tag[9],"blue")
        else
            do remove_blue(l_the_tag[9],"black")
        end
        agqinland:option[9]/checkbox/values="0,1"/tabstop ;
501     begin
        if agqinland:option[10] = 1 then
            do display_blue(l_the_tag[10],"blue")
        else
            do remove_blue(l_the_tag[10],"black")
        end
        agqinland:option[10]/checkbox/values="0,1"/tabstop ;
601     begin
        if agqinland:option[11] = 1 then
            do display_blue(l_the_tag[11],"blue")
        else
            do remove_blue(l_the_tag[11],"black")
        end
        agqinland:option[11]/checkbox/values="0,1"/tabstop ;
701     begin
        if agqinland:option[12] = 1 then
            do display_blue(l_the_tag[12],"blue")
        else
            do remove_blue(l_the_tag[12],"black")
        end
        agqinland:option[12]/checkbox/values="0,1"/tabstop ;

}

-- draw a line
panel at 25,1 to 25,100 tagged line_panel_1
    {
    Components
        line at 1,1 to 1,120
            Properties {
                       Linestyle = embossed
                       Linewidth = 5
                       foregroundcolor = "black"
                       }
    }

Panel at 26,5 to 26,100 Tagged optional_info_fn
Properties
        {
        LayoutType = screen
        }
{
Components

        Button at 1,30    tagged optional_info_fn
        Properties {
                Iconname = "btn_opt_endt.bmp"
                }
        Events  {
                Action {
                       if agqinland:county = 0 then
                           begin
                           warning "You must enter the county and business description, then click accept edits"
                           access agqinland_alias, set agqinland_alias:app_no = g_app_no, generic

                           if agqinland_alias:app_no <> g_app_no then
                               begin
                               function = "ADD"
                               abort()
                               end
                            else
                                begin
                                function = "CHANGE"
                                abort()
                                end
                            end
                       else
                           begin
                           function = "func2"
                           abort()
                           end
                       }
                }

        }

}

-- draw a line
panel at 27,1 to 27,100 tagged line_panel_1
    {
    Components
        line at 1,1 to 1,120
            Properties {
                       Linestyle = embossed
                       Linewidth = 5
                       foregroundcolor = "black"
                       }
    }

Panel at 28,1 to 28,100 Tagged icon_line2_tg
Properties {
           LayoutType = screen
           }
{
Components
    Button at 1,5   tagged back_fn
        Properties {
                   Iconname = "btn_premium_summary.bmp"
                   }
        Events     {
                   Action {
                          function = "back"
                          abort()
                          }
                    }

    Button at 1,36    tagged previous_fn
        Properties {
                   Iconname = "btn_prev_loc.bmp"
                   }
        Events     {
                   Action = previous_fn
                   }

    Button at 1, 51 tagged next_fn
        Properties {
                   Iconname = "btn_next_loc.bmp"
                   }
        Events     {
                   Action = next_fn
                   }


}

Update
if UPDATEOK = "NO" then
    begin
    disable(accept_fn)
    enable(back_fn)
    end

If UPDATEOK = "YES" And
   Abort = "NO" Then
    Begin
    disable(accept_fn)
    enable(back_fn)
    if function one of "DELETE" then
        begin
        access agqinland_alias, set agqinland_alias:app_no = g_app_no, generic

        access agqend, set agqend:app_no = g_app_no, generic

        while agqend:app_no = g_app_no
            begin
            if agqend:lob_end_code = "I" then
                begin
                if agqinland_alias:app_no <> g_app_no then
                    delete agqend
                else
                if agqend:prem_no = agqinland:prem_no and
                   agqend:build_no = agqinland:build_no then
                    delete agqend
                end

            next agqend
            end

        end

    if function one of "CHANGE", "CHG" then
        begin
        access agqname, set agqname:app_no = g_app_no, generic

        Access cpsimtrigger, Set cpsimtrigger:COMPANY_ID       = agqinland:company_id,
                                 cpsimtrigger:STATE            = agqinland:STATE,
                                 cpsimtrigger:LINE_OF_BUSINESS = L_LINE_OF_BUSINESS, Generic

        While cpsimtrigger:COMPANY_ID       = agqinland:company_id And
              cpsimtrigger:STATE            = agqinland:STATE And
              cpsimtrigger:LINE_OF_BUSINESS = L_LINE_OF_BUSINESS
                Begin
                If (agqNAME:EFF_DATE >= cpsimtrigger:EFF_DATE and
                   (agqname:eff_date <= cpsimtrigger:exp_date or
                   cpsimtrigger:exp_date = 0)) Then
                    Begin
                    l_code_1  = cpsimtrigger:code[1]    -- A/R
                    l_code_2  = cpsimtrigger:code[5]    -- Cameras
                    l_code_3  = cpsimtrigger:code[9]    -- Comm articles
                    l_code_4  = cpsimtrigger:code[11]   -- Equipment Dealers
                    l_code_5  = cpsimtrigger:code[16]   -- Film
                    l_code_6  = cpsimtrigger:code[18]   -- Floor Plan
                    l_code_7  = cpsimtrigger:code[19]   -- Jewelers Block
                    l_code_8  = cpsimtrigger:code[25]   -- Mail
                    l_code_9  = cpsimtrigger:code[30]   -- Physicians
                    l_code_10 = cpsimtrigger:code[34]   -- Signs
                    l_code_11 = cpsimtrigger:code[35]   -- Theatrical
                    l_code_12 = cpsimtrigger:code[36]   -- Valuable Papers
                    End

                Next cpsimtrigger
                End

        If L_CODE_1 <> "" Then
            Begin
            L_CODE = L_CODE_1
            if agqinland:option[1] = 0 then
                begin
                do delete_agqendorse6
                do delete_agqdesc4
                end
            Do ACCESS_agqEND
            If L_ADD_ENDORSEMENT = "N" and
               agqinland:option[1] = 0 then
                Do DELETE_agqEND
            End

        If L_CODE_2 <> "" Then
            Begin
            L_CODE = L_CODE_2
            if agqinland:option[2] = 0 then
                begin
                do delete_agqendorse6
                do delete_agqdesc4
                end
            Do ACCESS_agqEND
            If L_ADD_ENDORSEMENT = "N" and
               agqinland:option[2] = 0 then
                Do DELETE_agqEND
            End

        If L_CODE_3 <> "" Then
            Begin
            L_CODE = L_CODE_3
            if agqinland:option[3] = 0 then
                begin
                do delete_agqendorse6
                do delete_agqdesc4
                end
            Do ACCESS_agqEND
            If L_ADD_ENDORSEMENT = "N" and
               agqinland:option[3] = 0 then
                Do DELETE_agqEND
            End

        If L_CODE_4 <> "" Then
            Begin
            L_CODE = L_CODE_4
            if agqinland:option[4] = 0 then
                begin
                do delete_agqendorse6
                do delete_agqdesc4
                end
            Do ACCESS_agqEND
            If L_ADD_ENDORSEMENT = "N" and
               agqinland:option[4] = 0 then
                Do DELETE_agqEND
            End

        If L_CODE_5 <> "" Then
            Begin
            L_CODE = L_CODE_5
            if agqinland:option[5] = 0 then
                begin
                do delete_agqendorse6
                do delete_agqdesc4
                end
            Do ACCESS_agqEND
            If L_ADD_ENDORSEMENT = "N" and
               agqinland:option[5] = 0 then
                Do DELETE_agqEND
            End

        If L_CODE_6 <> "" Then
            Begin
            L_CODE = L_CODE_6
            if agqinland:option[6] = 0 then
                begin
                do delete_agqendorse6
                do delete_agqdesc4
                end
            Do ACCESS_agqEND
            If L_ADD_ENDORSEMENT = "N" and
               agqinland:option[6] = 0 then
                Do DELETE_agqEND
            End

        If L_CODE_7 <> "" Then
            Begin
            L_CODE = L_CODE_7
            if agqinland:option[7] = 0 then
                begin
                do delete_agqendorse6
                do delete_agqdesc4
                end
            Do ACCESS_agqEND
            If L_ADD_ENDORSEMENT = "N" and
               agqinland:option[7] = 0 then
                Do DELETE_agqEND
            End

        If L_CODE_8 <> "" Then
            Begin
            L_CODE = L_CODE_8
            if agqinland:option[8] = 0 then
                begin
                do delete_agqendorse6
                do delete_agqdesc4
                end
            Do ACCESS_agqEND
            If L_ADD_ENDORSEMENT = "N" and
               agqinland:option[8] = 0 then
                Do DELETE_agqEND
            End

        If L_CODE_9 <> "" Then
            Begin
            L_CODE = L_CODE_9
            if agqinland:option[9] = 0 then
                begin
                do delete_agqendorse6
                do delete_agqdesc4
                end
            Do ACCESS_agqEND
            If L_ADD_ENDORSEMENT = "N" and
               agqinland:option[9] = 0 then
                Do DELETE_agqEND
            End

        If L_CODE_10 <> "" Then
            Begin
            L_CODE = L_CODE_10
            if agqinland:option[10] = 0 then
                begin
                do delete_agqendorse6
                do delete_agqdesc4
                end
            Do ACCESS_agqEND
            If L_ADD_ENDORSEMENT = "N" and
               agqinland:option[10] = 0 then
                Do DELETE_agqEND
            End

        If L_CODE_11 <> "" Then
            Begin
            L_CODE = L_CODE_11
            if agqinland:option[11] = 0 then
                begin
                do delete_agqendorse6
                do delete_agqdesc4
                end
            Do ACCESS_agqEND
            If L_ADD_ENDORSEMENT = "N" and
               agqinland:option[11] = 0 then
                Do DELETE_agqEND
            End

        If L_CODE_12 <> "" Then
            Begin
            L_CODE = L_CODE_12
            if agqinland:option[12] = 0 then
                begin
                do delete_agqendorse6
                do delete_agqdesc4
                end
            Do ACCESS_agqEND
            If L_ADD_ENDORSEMENT = "N" and
               agqinland:option[12] = 0 then
                Do DELETE_agqEND
            End

      end

    if function one of "DELETE" then
      begin
        access agqendorse6, set agqendorse6:app_no   = agqinland:app_no,
                                agqendorse6:prem_no  = agqinland:prem_no,
                                agqendorse6:build_no = agqinland:build_no, generic

        while agqendorse6:app_no   = agqinland:app_no and
              agqendorse6:prem_no  = agqinland:prem_no and
              agqendorse6:build_no = agqinland:build_no
                begin
                Access cpsimtrigger, Set cpsimtrigger:COMPANY_ID       = agqinland:company_id,
                                         cpsimtrigger:STATE            = agqinland:STATE,
                                         cpsimtrigger:LINE_OF_BUSINESS = L_LINE_OF_BUSINESS, Generic

                While cpsimtrigger:COMPANY_ID       = agqinland:company_id And
                      cpsimtrigger:STATE            = agqinland:STATE And
                      cpsimtrigger:LINE_OF_BUSINESS = L_LINE_OF_BUSINESS
                    Begin
                    If (agqNAME:EFF_DATE >= cpsimtrigger:EFF_DATE and
                       (agqname:eff_date <= cpsimtrigger:exp_date or
                       cpsimtrigger:exp_date = 0)) Then
                        Begin
                        l_code_1  = cpsimtrigger:code[1]    -- A/R
                        l_code_2  = cpsimtrigger:code[5]    -- Cameras
                        l_code_3  = cpsimtrigger:code[9]    -- Comm articles
                        l_code_4  = cpsimtrigger:code[11]   -- Equipment Dealers
                        l_code_5  = cpsimtrigger:code[16]   -- Film
                        l_code_6  = cpsimtrigger:code[18]   -- Floor Plan
                        l_code_7  = cpsimtrigger:code[19]   -- Jewelers Block
                        l_code_8  = cpsimtrigger:code[25]   -- Mail
                        l_code_9  = cpsimtrigger:code[30]   -- Physicians
                        l_code_10 = cpsimtrigger:code[34]   -- Signs
                        l_code_11 = cpsimtrigger:code[35]   -- Theatrical
                        l_code_12 = cpsimtrigger:code[36]   -- Valuable Papers
                        End

                   Next cpsimtrigger
                   End

                if agqendorse6:code = l_code_1 or
                   agqendorse6:code = l_code_2 or
                   agqendorse6:code = l_code_3 or
                   agqendorse6:code = l_code_4 or
                   agqendorse6:code = l_code_5 or
                   agqendorse6:code = l_code_6 or
                   agqendorse6:code = l_code_7 or
                   agqendorse6:code = l_code_8 or
                   agqendorse6:code = l_code_9 or
                   agqendorse6:code = l_code_10 or
                   agqendorse6:code = l_code_11 or
                   agqendorse6:code = l_code_12 then
                    begin
                    access agqdesc4, set agqdesc4:app_no   = agqendorse6:app_no,
                                         agqdesc4:prem_no  = agqendorse6:prem_no,
                                         agqdesc4:build_no = agqendorse6:build_no,
                                         agqdesc4:code     = agqendorse6:code, generic

                    while agqdesc4:app_no   = agqendorse6:app_no and
                          agqdesc4:prem_no  = agqendorse6:prem_no and
                          agqdesc4:build_no = agqendorse6:build_no and
                          agqdesc4:code     = agqendorse6:code
                            begin
                            delete agqdesc4

                            next agqdesc4
                            end

                    delete agqendorse6
                    end

                next agqendorse6
                end

        access agqend, set agqend:app_no = agqinland:app_no, generic

        while agqend:app_no = agqinland:app_no
          begin
            if agqend:lob_end_code = "I" then
              {
                delete agqend
              }
            next agqend
          end

      end

    if function one of "ADD", "NEW", "CHG", "CHANGE" then
      begin
      access agqname, set agqname:app_no = g_app_no, generic

        Access cpsimtrigger, Set cpsimtrigger:COMPANY_ID       = agqinland:company_id,
                                 cpsimtrigger:STATE            = agqinland:STATE,
                                 cpsimtrigger:LINE_OF_BUSINESS = L_LINE_OF_BUSINESS, Generic

        While cpsimtrigger:COMPANY_ID       = agqinland:company_id And
              cpsimtrigger:STATE            = agqinland:STATE And
              cpsimtrigger:LINE_OF_BUSINESS = L_LINE_OF_BUSINESS
                Begin
                If (agqNAME:EFF_DATE >= cpsimtrigger:EFF_DATE and
                   (agqname:eff_date <= cpsimtrigger:exp_date or
                   cpsimtrigger:exp_date = 0)) Then
                    Begin
                    l_code_1  = cpsimtrigger:code[1]    -- A/R
                    l_code_2  = cpsimtrigger:code[5]    -- Cameras
                    l_code_3  = cpsimtrigger:code[9]    -- Comm articles
                    l_code_4  = cpsimtrigger:code[11]   -- Equipment Dealers
                    l_code_5  = cpsimtrigger:code[16]   -- Film
                    l_code_6  = cpsimtrigger:code[18]   -- Floor Plan
                    l_code_7  = cpsimtrigger:code[19]   -- Jewelers Block
                    l_code_8  = cpsimtrigger:code[25]   -- Mail
                    l_code_9  = cpsimtrigger:code[30]   -- Physicians
                    l_code_10 = cpsimtrigger:code[34]   -- Signs
                    l_code_11 = cpsimtrigger:code[35]   -- Theatrical
                    l_code_12 = cpsimtrigger:code[36]   -- Valuable Papers
                    End

                Next cpsimtrigger
                End

        g_prem_no = agqinland:prem_no
        g_build_no = agqinland:build_no
        if ((agqinland:option[1] = 1 and
           function one of "ADD", "NEW") or
           (agqinland:option[1] = 1 and
           l_option_1 = 0 and
           function one of "CHG", "CHANGE")) then
            begin
            g_code  = l_code_1
            g_state = agqinland:state
            display modal screen "agtmt8004c"
            with initial function "ADD"
            end
        if ((agqinland:option[2] = 1 and
           function one of "ADD", "NEW") or
           (agqinland:option[2] = 1 and
           l_option_2 = 0 and
           function one of "CHG", "CHANGE")) then
            begin
            g_code  = l_code_2
            g_state = agqinland:state
            display modal screen "agtmt8004d"
            with initial function "ADD"
            end
        if ((agqinland:option[3] = 1 and
           function one of "ADD", "NEW") or
           (agqinland:option[3] = 1 and
           l_option_3 = 0 and
           function one of "CHG", "CHANGE")) then
            begin
            g_code  = l_code_3
            g_state = agqinland:state
            display modal screen "agtmt8004e"
            with initial function "ADD"
            end
        if ((agqinland:option[4] = 1 and
           function one of "ADD", "NEW") or
           (agqinland:option[4] = 1 and
           l_option_4 = 0 and
           function one of "CHG", "CHANGE")) then
            begin
            g_code  = l_code_4
            g_state = agqinland:state
            display modal screen "agtmt8004f"
            with initial function "ADD"
            end
        if ((agqinland:option[5] = 1 and
           function one of "ADD", "NEW") or
           (agqinland:option[5] = 1 and
           l_option_5 = 0 and
           function one of "CHG", "CHANGE")) then
            begin
            g_code  = l_code_5
            g_state = agqinland:state
            display modal screen "agtmt8004g"
            with initial function "ADD"
            end
        if ((agqinland:option[6] = 1 and
           function one of "ADD", "NEW") or
           (agqinland:option[6] = 1 and
           l_option_6 = 0 and
           function one of "CHG", "CHANGE")) then
            begin
            g_code  = l_code_6
            g_state = agqinland:state
            display modal screen "agtmt8004h"
            with initial function "ADD"
            end
        if ((agqinland:option[7] = 1 and
           function one of "ADD", "NEW") or
           (agqinland:option[7] = 1 and
           l_option_7 = 0 and
           function one of "CHG", "CHANGE")) then
            begin
            g_code  = l_code_7
            g_state = agqinland:state
            display modal screen "agtmt8004i"
            with initial function "ADD"
            end
        if ((agqinland:option[8] = 1 and
           function one of "ADD", "NEW") or
           (agqinland:option[8] = 1 and
           l_option_8 = 0 and
           function one of "CHG", "CHANGE")) then
            begin
            g_code  = l_code_8
            g_state = agqinland:state
            display modal screen "agtmt8004j"
            with initial function "ADD"
            end
        if ((agqinland:option[9] = 1 and
           function one of "ADD", "NEW") or
           (agqinland:option[9] = 1 and
           l_option_9 = 0 and
           function one of "CHG", "CHANGE")) then
            begin
            g_code  = l_code_9
            g_state = agqinland:state
            display modal screen "agtmt8004k"
            with initial function "ADD"
            end
        if ((agqinland:option[10] = 1 and
           function one of "ADD", "NEW") or
           (agqinland:option[10] = 1 and
           l_option_10 = 0 and
           function one of "CHG", "CHANGE")) then
            begin
            g_code  = l_code_10
            g_state = agqinland:state
            display modal screen "agtmt8004l"
            with initial function "ADD"
            end
        if ((agqinland:option[11] = 1 and
           function one of "ADD", "NEW") or
           (agqinland:option[11] = 1 and
           l_option_11 = 0 and
           function one of "CHG", "CHANGE")) then
            begin
            g_code  = l_code_11
            g_state = agqinland:state
            display modal screen "agtmt8004m"
            with initial function "ADD"
            end
        if ((agqinland:option[12] = 1 and
           function one of "ADD", "NEW") or
           (agqinland:option[12] = 1 and
           l_option_12 = 0 and
           function one of "CHG", "CHANGE")) then
            begin
            g_code  = l_code_12
            agqinland:state = agqinland:state
            display modal screen "agtmt8004n"
            with initial function "ADD"
            end

        end

    function = "redisplay"
    End

screen exit
g_prem_no   = agqinland:prem_no
g_build_no  = agqinland:build_no

Procedure Definition

procedure delete_agqendorse6
begin
access agqendorse6, set agqendorse6:app_no   = g_app_no,
                        agqendorse6:prem_no  = agqinland:prem_no,
                        agqendorse6:build_no = agqinland:build_no,
                        agqendorse6:code     = l_code, generic

while agqendorse6:app_no   = g_app_no and
      agqendorse6:prem_no  = agqinland:prem_no and
      agqendorse6:build_no = agqinland:build_no and
      agqendorse6:code     = l_code
       begin
       delete agqendorse6

       next agqendorse6
       end

end

procedure delete_agqdesc4
begin
access agqdesc4, set agqdesc4:app_no   = g_app_no,
                     agqdesc4:prem_no  = agqinland:prem_no,
                     agqdesc4:build_no = agqinland:build_no,
                     agqdesc4:code     = l_code, generic

while agqdesc4:app_no   = g_app_no and
      agqdesc4:prem_no  = agqinland:prem_no and
      agqdesc4:build_no = agqinland:build_no and
      agqdesc4:code     = l_code
       begin
       delete agqdesc4

       next agqdesc4
       end

end

procedure access_cpsimtrigger

begin
agqinland:state = agqinland:state
Access cpsimtrigger, Set cpsimtrigger:COMPANY_ID       = agqinland:company_id,
                         cpsimtrigger:STATE            = agqinland:STATE,
                         cpsimtrigger:LINE_OF_BUSINESS = agqinland:rating_line_of_business, Generic

While cpsimtrigger:COMPANY_ID       = agqinland:company_id And
      cpsimtrigger:STATE            = agqinland:STATE And
      cpsimtrigger:LINE_OF_BUSINESS = agqinland:rating_line_of_business
        Begin
        If (agqNAME:EFF_DATE >= cpsimtrigger:EFF_DATE and
           (agqname:eff_date <= cpsimtrigger:exp_date or
           cpsimtrigger:exp_date = 0)) Then
            Begin
            l_code_1  = cpsimtrigger:code[1]    -- A/R
            l_code_2  = cpsimtrigger:code[5]    -- Cameras
            l_code_3  = cpsimtrigger:code[9]    -- Comm articles
            l_code_4  = cpsimtrigger:code[11]   -- Equipment Dealers
            l_code_5  = cpsimtrigger:code[16]   -- Film
            l_code_6  = cpsimtrigger:code[18]   -- Floor Plan
            l_code_7  = cpsimtrigger:code[19]   -- Jewelers Block
            l_code_8  = cpsimtrigger:code[25]   -- Mail
            l_code_9  = cpsimtrigger:code[30]   -- Physicians
            l_code_10 = cpsimtrigger:code[34]   -- Signs
            l_code_11 = cpsimtrigger:code[35]   -- Theatrical
            l_code_12 = cpsimtrigger:code[36]   -- Valuable Papers
            l_code_14 = cpsimtrigger:code[38]   -- LMIC8002
            End

        Next cpsimtrigger
        End

end

Procedure ACCESS_agqEND
Begin
Access agqEND, Set agqEND:app_no   = g_app_no ,
                   agqEND:PREM_NO  = g_prem_no,
                   agqEND:BUILD_NO = g_build_no, Generic

L_ADD_ENDORSEMENT = "Y"
l_add = "Y"
while agqEND:app_no   = g_app_no and
      agqEND:PREM_NO  = g_prem_no and
      agqEND:BUILD_NO = g_build_no
    begin
    l_add = "N"
    If agqEND:CODE = L_CODE Then
        L_ADD_ENDORSEMENT = "N"

    Next agqEND
    End

End

Procedure ADD_agqEND
Begin
Access agqEND, Set agqEND:app_no   = g_app_no ,
                   agqEND:PREM_NO  = g_prem_no,
                   agqEND:BUILD_NO = g_build_no, Generic

L_SUB_CODE = 0
while agqEND:app_no   = g_app_no and
      agqEND:PREM_NO  = g_prem_no and
      agqEND:BUILD_NO = g_build_no
    begin
    L_SUB_CODE = agqEND:SUB_CODE

    Next agqEND
    End

L_SUB_CODE = L_SUB_CODE + 10
Access SFSOPTEND, Set SFSOPTEND:COMPANY_ID       = agqinland:company_id,
                      SFSOPTEND:STATE            = agqinland:state,
                      SFSOPTEND:LINE_OF_BUSINESS = agqinland:rating_line_of_business,
                      SFSOPTEND:CODE             = L_CODE, Generic

while SFSOPTEND:COMPANY_ID       = agqinland:company_id and
      SFSOPTEND:STATE            = agqinland:state and
      SFSOPTEND:LINE_OF_BUSINESS = agqinland:rating_line_of_business and
      SFSOPTEND:CODE             = L_CODE
    begin
    If (agqNAME:EFF_DATE >= SFSOPTEND:EFF_DATE and
       (agqname:eff_date <= sfsoptend:exp_date or
       sfsoptend:exp_date = 0)) Then
        Begin
        L_FORM_EDITION = SFSOPTEND:FORM_EDITION
        L_DESCRIPTION  = SFSOPTEND:DESCRIPTION
        End

    Next SFSOPTEND
    End

Add agqEND
    Begin
    agqEND:app_no               =       g_app_no
    agqEND:PREM_NO              =       g_prem_no
    agqEND:BUILD_NO             =       g_build_no
    agqEND:SUB_CODE             =       L_SUB_CODE
    agqEND:CODE                 =       L_CODE
    agqEND:FORM_EDITION         =       L_FORM_EDITION
    agqEND:LOB_END_CODE         =       "I"
    agqEND:DESCRIPTION          =       L_DESCRIPTION
    agqEND:PREMIUM              =       0
    End

End

Procedure DELETE_agqEND
Begin
Access agqEND, Set agqEND:app_no   = g_app_no ,
                   agqEND:PREM_NO  = g_prem_no,
                   agqEND:BUILD_NO = g_build_no, Generic

while agqEND:app_no   = g_app_no and
      agqEND:PREM_NO  = g_prem_no and
      agqEND:BUILD_NO = g_build_no
    begin
    If agqEND:CODE = L_CODE Then
        Delete agqEND

    Next agqEND
    End

end

procedure display_blue(tag l_tag, string l_color)
begin
    setproperty(l_tag,foregroundcolor,l_color)
end

procedure remove_blue(tag l_tag, string l_color)
begin
    setproperty(l_tag,foregroundcolor,l_color)
end

procedure set_display
begin
l_loop = 1
while l_loop <= 12
    begin
    l_literal[1]  = "Accounts Receivable:"
    l_literal[2]  = "Camera/Musical Instrument Dealers:"
    l_literal[3]  = "Commercial Articles:"
    l_literal[4]  = "Equipment Dealers:"
    l_literal[5]  = "Film:"
    l_literal[6]  = "Floor Plan:"
    l_literal[7]  = "Jewelers Block"
    l_literal[8]  = "Mail:"
    l_literal[9]  = "Physicians & Surgeons:"
    l_literal[10] = "Signs:"
    l_literal[11] = "Theatrical Property:"
    l_literal[12] = "Valuable Papers:"
    l_tag_position = l_loop
    l_the_tag[l_loop] = tag("tview" + trun(str(l_loop)))
    do printguidetext(l_the_tag[l_tag_position],trun(l_literal[l_tag_position]))

    l_loop = l_loop + 1
    end

end

procedure printguidetext(tag current_tag, string display_string)
BEGIN
    Setproperty(current_tag, text, display_string)
END

Procedure show_form_1
begin
do access_cpsimtrigger
if agqinland:option[1] = 1 then
    begin
    g_app_no     = agqinland:app_no
    g_prem_no    = agqinland:prem_no
    g_build_no   = agqinland:build_no
    g_code       = l_code_1
    display modal screen "agtmt8004c"
    end

end

Procedure show_form_2
begin
do access_cpsimtrigger
if agqinland:option[2] = 1 then
    begin
    g_app_no     = agqinland:app_no
    g_prem_no    = agqinland:prem_no
    g_build_no   = agqinland:build_no
    g_code       = l_code_2
    display modal screen "agtmt8004d"
    end

end

Procedure show_form_3
begin
do access_cpsimtrigger
if agqinland:option[3] = 1 then
    begin
    g_app_no     = agqinland:app_no
    g_prem_no    = agqinland:prem_no
    g_build_no   = agqinland:build_no
    g_code       = l_code_3
    display modal screen "agtmt8004e"
    end

end

Procedure show_form_4
begin
do access_cpsimtrigger
if agqinland:option[4] = 1 then
    begin
    g_app_no     = agqinland:app_no
    g_prem_no    = agqinland:prem_no
    g_build_no   = agqinland:build_no
    g_code       = l_code_4
    display modal screen "agtmt8004f"
    end

end

Procedure show_form_5
begin
do access_cpsimtrigger
if agqinland:option[5] = 1 then
    begin
    g_app_no     = agqinland:app_no
    g_prem_no    = agqinland:prem_no
    g_build_no   = agqinland:build_no
    g_code       = l_code_5
    display modal screen "agtmt8004g"
    end

end

Procedure show_form_6
begin
do access_cpsimtrigger
if agqinland:option[6] = 1 then
    begin
    g_app_no     = agqinland:app_no
    g_prem_no    = agqinland:prem_no
    g_build_no   = agqinland:build_no
    g_code       = l_code_6
    display modal screen "agtmt8004h"
    end

end

Procedure show_form_7
begin
do access_cpsimtrigger
if agqinland:option[7] = 1 then
    begin
    g_app_no     = agqinland:app_no
    g_prem_no    = agqinland:prem_no
    g_build_no   = agqinland:build_no
    g_code       = l_code_7
    display modal screen "agtmt8004i"
    end

end

Procedure show_form_8
begin
do access_cpsimtrigger
if agqinland:option[8] = 1 then
    begin
    g_app_no     = agqinland:app_no
    g_prem_no    = agqinland:prem_no
    g_build_no   = agqinland:build_no
    g_code       = l_code_8
    display modal screen "agtmt8004j"
    end

end

Procedure show_form_9
begin
do access_cpsimtrigger
if agqinland:option[9] = 1 then
    begin
    g_app_no     = agqinland:app_no
    g_prem_no    = agqinland:prem_no
    g_build_no   = agqinland:build_no
    g_code       = l_code_9
    display modal screen "agtmt8004k"
    end

end

Procedure show_form_10
begin
do access_cpsimtrigger
if agqinland:option[10] = 1 then
    begin
    g_app_no     = agqinland:app_no
    g_prem_no    = agqinland:prem_no
    g_build_no   = agqinland:build_no
    g_code       = l_code_10
    display modal screen "agtmt8004l"
    end

end

Procedure show_form_11
begin
do access_cpsimtrigger
if agqinland:option[11] = 1 then
    begin
    g_app_no     = agqinland:app_no
    g_prem_no    = agqinland:prem_no
    g_build_no   = agqinland:build_no
    g_code       = l_code_11
    display modal screen "agtmt8004m"
    end

end

Procedure show_form_12
begin
do access_cpsimtrigger
if agqinland:option[12] = 1 then
    begin
    g_app_no     = agqinland:app_no
    g_prem_no    = agqinland:prem_no
    g_build_no   = agqinland:build_no
    g_code       = l_code_12
    display modal screen "agtmt8004n"
    end

end

procedure get_package_mod
begin
access agqname, set agqname:app_no = agqinland:app_no, generic

access agqliability, set agqliability:app_no   = agqinland:app_no,
                         agqliability:prem_no  = agqinland:prem_no,
                         agqliability:build_no = agqinland:build_no, generic

access agqartisan, set agqartisan:app_no   = agqinland:app_no,
                       agqartisan:prem_no  = agqinland:prem_no,
                       agqartisan:build_no = agqinland:build_no, generic

access agqgeneral1, set agqgeneral1:app_no   = agqinland:app_no,
                        agqgeneral1:prem_no  = agqinland:prem_no,
                        agqgeneral1:build_no = agqinland:build_no, generic

if agqgeneral1:app_no = agqinland:app_no then
    l_type = agqgeneral1:type
if agqliability:app_no = agqinland:app_no then
    l_type = agqliability:type
if agqartisan:app_no = agqinland:app_no then
    l_type = agqartisan:type

access cpsisopackage, set cpsisopackage:company_id       = agqinland:company_id,
                          cpsisopackage:state            = agqinland:state,
                          cpsisopackage:line_of_business = agqinland:rating_line_of_business,
                          cpsisopackage:type             = l_type, generic

l_package_mod = 0
while cpsisopackage:company_id       = agqinland:company_id and
      cpsisopackage:state            = agqinland:state and
      cpsisopackage:line_of_business = agqinland:rating_line_of_business and
      cpsisopackage:type             = l_type
        begin
        if (agqname:eff_date >= cpsisopackage:eff_date and
           (agqname:eff_date <= cpsisopackage:exp_date or
           cpsisopackage:exp_date = 0)) then
            begin
            l_package_mod = cpsisopackage:package_mod[2]

            end

        next cpsisopackage
        end

if l_package_mod = 0 then
    l_package_mod = 1.00
end

End
